var Ja=Object.defineProperty;var Zs=r=>{throw TypeError(r)};var Qa=(r,t,e)=>t in r?Ja(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var ge=(r,t,e)=>Qa(r,typeof t!="symbol"?t+"":t,e),eo=(r,t,e)=>t.has(r)||Zs("Cannot "+e);var T=(r,t,e)=>(eo(r,t,"read from private field"),e?e.call(r):t.get(r)),ee=(r,t,e)=>t.has(r)?Zs("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();const to=!1;var ms=Array.isArray,gs=Array.from,ro=Object.defineProperty,Wt=Object.getOwnPropertyDescriptor,fa=Object.getOwnPropertyDescriptors,no=Object.prototype,io=Array.prototype,ki=Object.getPrototypeOf;const Be=()=>{};function so(r){return r()}function os(r){for(var t=0;t<r.length;t++)r[t]()}const vt=2,va=4,di=8,_s=16,lt=32,hi=64,Bt=128,Si=256,tt=512,At=1024,fi=2048,ht=4096,vi=8192,ao=16384,$i=32768,pa=65536,oo=1<<18,ma=1<<19,$t=Symbol("$state"),lo=Symbol("legacy props"),uo=Symbol("");function ga(r){return r===this.v}function _a(r,t){return r!=r?t==t:r!==t||r!==null&&typeof r=="object"||typeof r=="function"}function co(r,t){return r!==t}function bs(r){return!_a(r,this.v)}function ho(r){throw new Error("effect_in_teardown")}function fo(){throw new Error("effect_in_unowned_derived")}function vo(r){throw new Error("effect_orphan")}function po(){throw new Error("effect_update_depth_exceeded")}function mo(r){throw new Error("props_invalid_value")}function go(){throw new Error("state_descriptors_fixed")}function _o(){throw new Error("state_prototype_fixed")}function bo(){throw new Error("state_unsafe_local_read")}function yo(){throw new Error("state_unsafe_mutation")}let Kt=!1;function wo(){Kt=!0}function it(r){return{f:0,v:r,reactions:null,equals:ga,version:0}}function Q(r){return ba(it(r))}function ys(r,t=!1){var n;const e=it(r);return t||(e.equals=bs),Kt&&ze!==null&&ze.l!==null&&((n=ze.l).s??(n.s=[])).push(e),e}function Je(r,t=!1){return ba(ys(r,t))}function ba(r){return Ie!==null&&Ie.f&vt&&(ft===null?zo([r]):ft.push(r)),r}function z(r,t){return V(r,Gt(()=>a(r))),t}function V(r,t){return Ie!==null&&mi()&&Ie.f&(vt|_s)&&(ft===null||!ft.includes(r))&&yo(),ls(r,t)}function ls(r,t){return r.equals(t)||(r.v=t,r.version=Oa(),ya(r,At),mi()&&Ce!==null&&Ce.f&tt&&!(Ce.f&lt)&&(Ye!==null&&Ye.includes(r)?(_t(Ce,At),zi(Ce)):Et===null?Bo([r]):Et.push(r))),t}function ya(r,t){var e=r.reactions;if(e!==null)for(var n=mi(),i=e.length,s=0;s<i;s++){var o=e[s],d=o.f;d&At||!n&&o===Ce||(_t(o,t),d&(tt|Bt)&&(d&vt?ya(o,fi):zi(o)))}}const ws=1,xs=2,wa=4,xo=8,ko=16,So=1,Co=2,Eo=4,Fo=8,Ao=16,To=1,Ro=2,Qe=Symbol();let xa=!1;function H(r,t=null,e){if(typeof r!="object"||r===null||$t in r)return r;const n=ki(r);if(n!==no&&n!==io)return r;var i=new Map,s=ms(r),o=it(0);s&&i.set("length",it(r.length));var d;return new Proxy(r,{defineProperty(c,h,g){(!("value"in g)||g.configurable===!1||g.enumerable===!1||g.writable===!1)&&go();var p=i.get(h);return p===void 0?(p=it(g.value),i.set(h,p)):V(p,H(g.value,d)),!0},deleteProperty(c,h){var g=i.get(h);if(g===void 0)h in c&&i.set(h,it(Qe));else{if(s&&typeof h=="string"){var p=i.get("length"),u=Number(h);Number.isInteger(u)&&u<p.v&&V(p,u)}V(g,Qe),Ys(o)}return!0},get(c,h,g){var _;if(h===$t)return r;var p=i.get(h),u=h in c;if(p===void 0&&(!u||(_=Wt(c,h))!=null&&_.writable)&&(p=it(H(u?c[h]:Qe,d)),i.set(h,p)),p!==void 0){var l=a(p);return l===Qe?void 0:l}return Reflect.get(c,h,g)},getOwnPropertyDescriptor(c,h){var g=Reflect.getOwnPropertyDescriptor(c,h);if(g&&"value"in g){var p=i.get(h);p&&(g.value=a(p))}else if(g===void 0){var u=i.get(h),l=u==null?void 0:u.v;if(u!==void 0&&l!==Qe)return{enumerable:!0,configurable:!0,value:l,writable:!0}}return g},has(c,h){var l;if(h===$t)return!0;var g=i.get(h),p=g!==void 0&&g.v!==Qe||Reflect.has(c,h);if(g!==void 0||Ce!==null&&(!p||(l=Wt(c,h))!=null&&l.writable)){g===void 0&&(g=it(p?H(c[h],d):Qe),i.set(h,g));var u=a(g);if(u===Qe)return!1}return p},set(c,h,g,p){var x;var u=i.get(h),l=h in c;if(s&&h==="length")for(var _=g;_<u.v;_+=1){var v=i.get(_+"");v!==void 0?V(v,Qe):_ in c&&(v=it(Qe),i.set(_+"",v))}u===void 0?(!l||(x=Wt(c,h))!=null&&x.writable)&&(u=it(void 0),V(u,H(g,d)),i.set(h,u)):(l=u.v!==Qe,V(u,H(g,d)));var f=Reflect.getOwnPropertyDescriptor(c,h);if(f!=null&&f.set&&f.set.call(p,g),!l){if(s&&typeof h=="string"){var b=i.get("length"),w=Number(h);Number.isInteger(w)&&w>=b.v&&V(b,w+1)}Ys(o)}return!0},ownKeys(c){a(o);var h=Reflect.ownKeys(c).filter(u=>{var l=i.get(u);return l===void 0||l.v!==Qe});for(var[g,p]of i)p.v!==Qe&&!(g in c)&&h.push(g);return h},setPrototypeOf(){_o()}})}function Ys(r,t=1){V(r,r.v+t)}var Ks,ka,Sa;function Io(){if(Ks===void 0){Ks=window;var r=Element.prototype,t=Node.prototype;ka=Wt(t,"firstChild").get,Sa=Wt(t,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__styles=null,r.__e=void 0,Text.prototype.__t=void 0}}function Oi(r=""){return document.createTextNode(r)}function Ci(r){return ka.call(r)}function Gi(r){return Sa.call(r)}function re(r,t){return Ci(r)}function ce(r,t){{var e=Ci(r);return e instanceof Comment&&e.data===""?Gi(e):e}}function G(r,t=1,e=!1){let n=r;for(;t--;)n=Gi(n);return n}function Do(r){r.textContent=""}function ye(r){var t=vt|At;Ce===null?t|=Bt:Ce.f|=ma;const e={children:null,ctx:ze,deps:null,equals:ga,f:t,fn:r,reactions:null,v:null,version:0,parent:Ce};if(Ie!==null&&Ie.f&vt){var n=Ie;(n.children??(n.children=[])).push(e)}return e}function he(r){const t=ye(r);return t.equals=bs,t}function Ca(r){var t=r.children;if(t!==null){r.children=null;for(var e=0;e<t.length;e+=1){var n=t[e];n.f&vt?ks(n):Dt(n)}}}function Ea(r){var t,e=Ce;mt(r.parent);try{Ca(r),t=Ga(r)}finally{mt(e)}return t}function Fa(r){var t=Ea(r),e=(Xt||r.f&Bt)&&r.deps!==null?fi:tt;_t(r,e),r.equals(t)||(r.v=t,r.version=Oa())}function ks(r){Ca(r),ar(r,0),_t(r,vi),r.v=r.children=r.deps=r.ctx=r.reactions=null}function Aa(r){Ce===null&&Ie===null&&vo(),Ie!==null&&Ie.f&Bt&&fo(),Fs&&ho()}function Po(r,t){var e=t.last;e===null?t.last=t.first=r:(e.next=r,r.prev=e,t.last=r)}function Jt(r,t,e,n=!0){var i=(r&hi)!==0,s=Ce,o={ctx:ze,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:r|At,first:null,fn:t,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,version:0};if(e){var d=Vt;try{Js(!0),Ui(o),o.f|=ao}catch(g){throw Dt(o),g}finally{Js(d)}}else t!==null&&zi(o);var c=e&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&ma)===0;if(!c&&!i&&n&&(s!==null&&Po(o,s),Ie!==null&&Ie.f&vt)){var h=Ie;(h.children??(h.children=[])).push(o)}return o}function Lo(r){const t=Jt(di,null,!1);return _t(t,tt),t.teardown=r,t}function pt(r){Aa();var t=Ce!==null&&(Ce.f&lt)!==0&&ze!==null&&!ze.m;if(t){var e=ze;(e.e??(e.e=[])).push({fn:r,effect:Ce,reaction:Ie})}else{var n=Ss(r);return n}}function $o(r){return Aa(),Cs(r)}function Oo(r){const t=Jt(hi,r,!0);return()=>{Dt(t)}}function Ss(r){return Jt(va,r,!1)}function Cs(r){return Jt(di,r,!0)}function be(r){return pi(r)}function pi(r,t=0){return Jt(di|_s|t,r,!0)}function Ot(r,t=!0){return Jt(di|lt,r,!0,t)}function Ta(r){var t=r.teardown;if(t!==null){const e=Fs,n=Ie;Qs(!0),Tt(null);try{t.call(null)}finally{Qs(e),Tt(n)}}}function Ra(r){var t=r.deriveds;if(t!==null){r.deriveds=null;for(var e=0;e<t.length;e+=1)ks(t[e])}}function Ia(r,t=!1){var e=r.first;for(r.first=r.last=null;e!==null;){var n=e.next;Dt(e,t),e=n}}function Go(r){for(var t=r.first;t!==null;){var e=t.next;t.f&lt||Dt(t),t=e}}function Dt(r,t=!0){var e=!1;if((t||r.f&oo)&&r.nodes_start!==null){for(var n=r.nodes_start,i=r.nodes_end;n!==null;){var s=n===i?null:Gi(n);n.remove(),n=s}e=!0}Ia(r,t&&!e),Ra(r),ar(r,0),_t(r,vi);var o=r.transitions;if(o!==null)for(const c of o)c.stop();Ta(r);var d=r.parent;d!==null&&d.first!==null&&Da(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.parent=r.fn=r.nodes_start=r.nodes_end=null}function Da(r){var t=r.parent,e=r.prev,n=r.next;e!==null&&(e.next=n),n!==null&&(n.prev=e),t!==null&&(t.first===r&&(t.first=n),t.last===r&&(t.last=e))}function Ei(r,t){var e=[];Es(r,e,!0),Pa(e,()=>{Dt(r),t&&t()})}function Pa(r,t){var e=r.length;if(e>0){var n=()=>--e||t();for(var i of r)i.out(n)}else t()}function Es(r,t,e){if(!(r.f&ht)){if(r.f^=ht,r.transitions!==null)for(const o of r.transitions)(o.is_global||e)&&t.push(o);for(var n=r.first;n!==null;){var i=n.next,s=(n.f&$i)!==0||(n.f&lt)!==0;Es(n,t,s?e:!1),n=i}}}function Fi(r){La(r,!0)}function La(r,t){if(r.f&ht){gi(r)&&Ui(r),r.f^=ht;for(var e=r.first;e!==null;){var n=e.next,i=(e.f&$i)!==0||(e.f&lt)!==0;La(e,i?t:!1),e=n}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||t)&&s.in()}}let us=!1,cs=[];function Mo(){us=!1;const r=cs.slice();cs=[],os(r)}function Mi(r){us||(us=!0,queueMicrotask(Mo)),cs.push(r)}function Uo(r){throw new Error("lifecycle_outside_component")}let Ai=!1,Vt=!1,Fs=!1;function Js(r){Vt=r}function Qs(r){Fs=r}let ds=[],sr=0;let Ie=null;function Tt(r){Ie=r}let Ce=null;function mt(r){Ce=r}let ft=null;function zo(r){ft=r}let Ye=null,rt=0,Et=null;function Bo(r){Et=r}let $a=0,Xt=!1,Ct=null,ze=null;function Oa(){return++$a}function mi(){return!Kt||ze!==null&&ze.l===null}function gi(r){var o,d;var t=r.f;if(t&At)return!0;if(t&fi){var e=r.deps,n=(t&Bt)!==0;if(e!==null){var i;if(t&Si){for(i=0;i<e.length;i++)((o=e[i]).reactions??(o.reactions=[])).push(r);r.f^=Si}for(i=0;i<e.length;i++){var s=e[i];if(gi(s)&&Fa(s),n&&Ce!==null&&!Xt&&!((d=s==null?void 0:s.reactions)!=null&&d.includes(r))&&(s.reactions??(s.reactions=[])).push(r),s.version>r.version)return!0}}n||_t(r,tt)}return!1}function No(r,t,e){throw r}function Ga(r){var u;var t=Ye,e=rt,n=Et,i=Ie,s=Xt,o=ft,d=ze,c=r.f;Ye=null,rt=0,Et=null,Ie=c&(lt|hi)?null:r,Xt=!Vt&&(c&Bt)!==0,ft=null,ze=r.ctx;try{var h=(0,r.fn)(),g=r.deps;if(Ye!==null){var p;if(ar(r,rt),g!==null&&rt>0)for(g.length=rt+Ye.length,p=0;p<Ye.length;p++)g[rt+p]=Ye[p];else r.deps=g=Ye;if(!Xt)for(p=rt;p<g.length;p++)((u=g[p]).reactions??(u.reactions=[])).push(r)}else g!==null&&rt<g.length&&(ar(r,rt),g.length=rt);return h}finally{Ye=t,rt=e,Et=n,Ie=i,Xt=s,ft=o,ze=d}}function jo(r,t){let e=t.reactions;if(e!==null){var n=e.indexOf(r);if(n!==-1){var i=e.length-1;i===0?e=t.reactions=null:(e[n]=e[i],e.pop())}}e===null&&t.f&vt&&(Ye===null||!Ye.includes(t))&&(_t(t,fi),t.f&(Bt|Si)||(t.f^=Si),ar(t,0))}function ar(r,t){var e=r.deps;if(e!==null)for(var n=t;n<e.length;n++)jo(r,e[n])}function Ui(r){var t=r.f;if(!(t&vi)){_t(r,tt);var e=Ce;Ce=r;try{t&_s?Go(r):Ia(r),Ra(r),Ta(r);var n=Ga(r);r.teardown=typeof n=="function"?n:null,r.version=$a}catch(i){No(i)}finally{Ce=e}}}function Ho(){sr>1e3&&(sr=0,po()),sr++}function Xo(r){var t=r.length;if(t!==0){Ho();var e=Vt;Vt=!0;try{for(var n=0;n<t;n++){var i=r[n];i.f&tt||(i.f^=tt);var s=[];Ma(i,s),Wo(s)}}finally{Vt=e}}}function Wo(r){var t=r.length;if(t!==0)for(var e=0;e<t;e++){var n=r[e];!(n.f&(vi|ht))&&gi(n)&&(Ui(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?Da(n):n.fn=null))}}function Vo(){if(Ai=!1,sr>1001)return;const r=ds;ds=[],Xo(r),Ai||(sr=0)}function zi(r){Ai||(Ai=!0,queueMicrotask(Vo));for(var t=r;t.parent!==null;){t=t.parent;var e=t.f;if(e&(hi|lt)){if(!(e&tt))return;t.f^=tt}}ds.push(t)}function Ma(r,t){var e=r.first,n=[];e:for(;e!==null;){var i=e.f,s=(i&lt)!==0,o=s&&(i&tt)!==0;if(!o&&!(i&ht))if(i&di){s?e.f^=tt:gi(e)&&Ui(e);var d=e.first;if(d!==null){e=d;continue}}else i&va&&n.push(e);var c=e.next;if(c===null){let p=e.parent;for(;p!==null;){if(r===p)break e;var h=p.next;if(h!==null){e=h;continue e}p=p.parent}}e=c}for(var g=0;g<n.length;g++)d=n[g],t.push(d),Ma(d,t)}function a(r){var d;var t=r.f,e=(t&vt)!==0;if(e&&t&vi){var n=Ea(r);return ks(r),n}if(Ct!==null&&Ct.add(r),Ie!==null){ft!==null&&ft.includes(r)&&bo();var i=Ie.deps;Ye===null&&i!==null&&i[rt]===r?rt++:Ye===null?Ye=[r]:Ye.push(r),Et!==null&&Ce!==null&&Ce.f&tt&&!(Ce.f&lt)&&Et.includes(r)&&(_t(Ce,At),zi(Ce))}else if(e&&r.deps===null){var s=r,o=s.parent;o!==null&&!((d=o.deriveds)!=null&&d.includes(s))&&(o.deriveds??(o.deriveds=[])).push(s)}return e&&(s=r,gi(s)&&Fa(s)),r.v}function Ua(r){var t=Ct;Ct=new Set;var e=Ct,n;try{if(Gt(r),t!==null)for(n of Ct)t.add(n)}finally{Ct=t}for(n of e)if(n.f&pa)for(const i of n.deps||[])i.f&vt||z(i,null);else z(n,null)}function Gt(r){const t=Ie;try{return Ie=null,r()}finally{Ie=t}}const qo=~(At|fi|tt);function _t(r,t){r.f=r.f&qo|t}function Ae(r,t=!1,e){ze={p:ze,c:null,e:null,m:!1,s:r,x:null,l:null},Kt&&!t&&(ze.l={s:null,u:null,r1:[],r2:it(!1)})}function Te(r){const t=ze;if(t!==null){r!==void 0&&(t.x=r);const o=t.e;if(o!==null){var e=Ce,n=Ie;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];mt(s.effect),Tt(s.reaction),Ss(s.fn)}}finally{mt(e),Tt(n)}}ze=t.p,t.m=!0}return r||{}}function Zo(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if($t in r)hs(r);else if(!Array.isArray(r))for(let t in r){const e=r[t];typeof e=="object"&&e&&$t in e&&hs(e)}}}function hs(r,t=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!t.has(r)){t.add(r),r instanceof Date&&r.getTime();for(let n in r)try{hs(r[n],t)}catch{}const e=ki(r);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const n=fa(e);for(let i in n){const s=n[i].get;if(s)try{s.call(r)}catch{}}}}}function Yo(r,t){{const e=document.body;r.autofocus=!0,Mi(()=>{document.activeElement===e&&r.focus()})}}let ea=!1;function Ko(){ea||(ea=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function za(r){var t=Ie,e=Ce;Tt(null),mt(null);try{return r()}finally{Tt(t),mt(e)}}function Jo(r,t,e,n=e){r.addEventListener(t,()=>za(e));const i=r.__on_r;i?r.__on_r=()=>{i(),n()}:r.__on_r=n,Ko()}const Ba=new Set,fs=new Set;function Qo(r,t,e,n){function i(s){if(n.capture||ir.call(t,s),!s.cancelBubble)return za(()=>e.call(this,s))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Mi(()=>{t.addEventListener(r,i,n)}):t.addEventListener(r,i,n),i}function qe(r,t,e,n,i){var s={capture:n,passive:i},o=Qo(r,t,e,s);(t===document.body||t===window||t===document)&&Lo(()=>{t.removeEventListener(r,o,s)})}function He(r){for(var t=0;t<r.length;t++)Ba.add(r[t]);for(var e of fs)e(r)}function ir(r){var w;var t=this,e=t.ownerDocument,n=r.type,i=((w=r.composedPath)==null?void 0:w.call(r))||[],s=i[0]||r.target,o=0,d=r.__root;if(d){var c=i.indexOf(d);if(c!==-1&&(t===document||t===window)){r.__root=t;return}var h=i.indexOf(t);if(h===-1)return;c<=h&&(o=c)}if(s=i[o]||r.target,s!==t){ro(r,"currentTarget",{configurable:!0,get(){return s||e}});var g=Ie,p=Ce;Tt(null),mt(null);try{for(var u,l=[];s!==null;){var _=s.assignedSlot||s.parentNode||s.host||null;try{var v=s["__"+n];if(v!==void 0&&!s.disabled)if(ms(v)){var[f,...b]=v;f.apply(s,[r,...b])}else v.call(s,r)}catch(x){u?l.push(x):u=x}if(r.cancelBubble||_===t||_===null)break;s=_}if(u){for(let x of l)queueMicrotask(()=>{throw x});throw u}}finally{r.__root=t,delete r.currentTarget,Tt(g),mt(p)}}}function el(r){var t=document.createElement("template");return t.innerHTML=r,t.content}function Ti(r,t){var e=Ce;e.nodes_start===null&&(e.nodes_start=r,e.nodes_end=t)}function ie(r,t){var e=(t&To)!==0,n=(t&Ro)!==0,i,s=!r.startsWith("<!>");return()=>{i===void 0&&(i=el(s?r:"<!>"+r),e||(i=Ci(i)));var o=n?document.importNode(i,!0):i.cloneNode(!0);if(e){var d=Ci(o),c=o.lastChild;Ti(d,c)}else Ti(o,o);return o}}function ke(r=""){{var t=Oi(r+"");return Ti(t,t),t}}function Se(){var r=document.createDocumentFragment(),t=document.createComment(""),e=Oi();return r.append(t,e),Ti(t,e),r}function $(r,t){r!==null&&r.before(t)}const tl=["touchstart","touchmove"];function rl(r){return tl.includes(r)}function Ge(r,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=e,r.nodeValue=e==null?"":e+"")}function nl(r,t){return il(r,t)}const Nt=new Map;function il(r,{target:t,anchor:e,props:n={},events:i,context:s,intro:o=!0}){Io();var d=new Set,c=p=>{for(var u=0;u<p.length;u++){var l=p[u];if(!d.has(l)){d.add(l);var _=rl(l);t.addEventListener(l,ir,{passive:_});var v=Nt.get(l);v===void 0?(document.addEventListener(l,ir,{passive:_}),Nt.set(l,1)):Nt.set(l,v+1)}}};c(gs(Ba)),fs.add(c);var h=void 0,g=Oo(()=>{var p=e??t.appendChild(Oi());return Ot(()=>{if(s){Ae({});var u=ze;u.c=s}i&&(n.$$events=i),h=r(p,n)||{},s&&Te()}),()=>{var _;for(var u of d){t.removeEventListener(u,ir);var l=Nt.get(u);--l===0?(document.removeEventListener(u,ir),Nt.delete(u)):Nt.set(u,l)}fs.delete(c),ta.delete(h),p!==e&&((_=p.parentNode)==null||_.removeChild(p))}});return ta.set(h,g),h}let ta=new WeakMap;function _e(r,t,e,n=null,i=!1){var s=r,o=null,d=null,c=null,h=i?$i:0;pi(()=>{c!==(c=!!t())&&(c?(o?Fi(o):o=Ot(()=>e(s)),d&&Ei(d,()=>{d=null})):(d?Fi(d):n&&(d=Ot(()=>n(s))),o&&Ei(o,()=>{o=null})))},h)}function Ke(r,t,e){var n=r,i=Qe,s,o=mi()?co:_a;pi(()=>{o(i,i=t())&&(s&&Ei(s),s=Ot(()=>e(n)))})}function vs(r,t){return t}function sl(r,t,e,n){for(var i=[],s=t.length,o=0;o<s;o++)Es(t[o].e,i,!0);var d=s>0&&i.length===0&&e!==null;if(d){var c=e.parentNode;Do(c),c.append(e),n.clear(),St(r,t[0].prev,t[s-1].next)}Pa(i,()=>{for(var h=0;h<s;h++){var g=t[h];d||(n.delete(g.k),St(r,g.prev,g.next)),Dt(g.e,!d)}})}function gt(r,t,e,n,i,s=null){var o=r,d={flags:t,items:new Map,first:null},c=(t&wa)!==0;if(c){var h=r;o=h.appendChild(Oi())}var g=null,p=!1;pi(()=>{var u=e(),l=ms(u)?u:u==null?[]:gs(u),_=l.length;if(!(p&&_===0)){p=_===0;{var v=Ie;al(l,d,o,i,t,(v.f&ht)!==0,n)}s!==null&&(_===0?g?Fi(g):g=Ot(()=>s(o)):g!==null&&Ei(g,()=>{g=null})),e()}})}function al(r,t,e,n,i,s,o){var y,B,ae,W;var d=(i&xo)!==0,c=(i&(ws|xs))!==0,h=r.length,g=t.items,p=t.first,u=p,l,_=null,v,f=[],b=[],w,x,k,E;if(d)for(E=0;E<h;E+=1)w=r[E],x=o(w,E),k=g.get(x),k!==void 0&&((y=k.a)==null||y.measure(),(v??(v=new Set)).add(k));for(E=0;E<h;E+=1){if(w=r[E],x=o(w,E),k=g.get(x),k===void 0){var M=u?u.e.nodes_start:e;_=ll(M,t,_,_===null?t.first:_.next,w,x,E,n,i),g.set(x,_),f=[],b=[],u=_.next;continue}if(c&&ol(k,w,E,i),k.e.f&ht&&(Fi(k.e),d&&((B=k.a)==null||B.unfix(),(v??(v=new Set)).delete(k))),k!==u){if(l!==void 0&&l.has(k)){if(f.length<b.length){var L=b[0],I;_=L.prev;var R=f[0],N=f[f.length-1];for(I=0;I<f.length;I+=1)ra(f[I],L,e);for(I=0;I<b.length;I+=1)l.delete(b[I]);St(t,R.prev,N.next),St(t,_,R),St(t,N,L),u=L,_=N,E-=1,f=[],b=[]}else l.delete(k),ra(k,u,e),St(t,k.prev,k.next),St(t,k,_===null?t.first:_.next),St(t,_,k),_=k;continue}for(f=[],b=[];u!==null&&u.k!==x;)(s||!(u.e.f&ht))&&(l??(l=new Set)).add(u),b.push(u),u=u.next;if(u===null)continue;k=u}f.push(k),_=k,u=k.next}if(u!==null||l!==void 0){for(var X=l===void 0?[]:gs(l);u!==null;)(s||!(u.e.f&ht))&&X.push(u),u=u.next;var S=X.length;if(S>0){var P=i&wa&&h===0?e:null;if(d){for(E=0;E<S;E+=1)(ae=X[E].a)==null||ae.measure();for(E=0;E<S;E+=1)(W=X[E].a)==null||W.fix()}sl(t,X,P,g)}}d&&Mi(()=>{var ue;if(v!==void 0)for(k of v)(ue=k.a)==null||ue.apply()}),Ce.first=t.first&&t.first.e,Ce.last=_&&_.e}function ol(r,t,e,n){n&ws&&ls(r.v,t),n&xs?ls(r.i,e):r.i=e}function ll(r,t,e,n,i,s,o,d,c){var h=(c&ws)!==0,g=(c&ko)===0,p=h?g?ys(i):it(i):i,u=c&xs?it(o):o,l={i:u,v:p,k:s,a:null,e:null,prev:e,next:n};try{return l.e=Ot(()=>d(r,p,u),xa),l.e.prev=e&&e.e,l.e.next=n&&n.e,e===null?t.first=l:(e.next=l,e.e.next=l.e),n!==null&&(n.prev=l,n.e.prev=l.e),l}finally{}}function ra(r,t,e){for(var n=r.next?r.next.e.nodes_start:e,i=t?t.e.nodes_start:e,s=r.e.nodes_start;s!==n;){var o=Gi(s);i.before(s),s=o}}function St(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function xt(r,t,...e){var n=r,i=Be,s;pi(()=>{i!==(i=t())&&(s&&(Dt(s),s=null),s=Ot(()=>i(n,...e)))},$i)}function $e(r,t,e,n){var i=r.__attributes??(r.__attributes={});i[t]!==(i[t]=e)&&(t==="style"&&"__styles"in r&&(r.__styles={}),t==="loading"&&(r[uo]=e),e==null?r.removeAttribute(t):typeof e!="string"&&ul(r).includes(t)?r[t]=e:r.setAttribute(t,e))}var na=new Map;function ul(r){var t=na.get(r.nodeName);if(t)return t;na.set(r.nodeName,t=[]);for(var e,n=ki(r),i=Element.prototype;i!==n;){e=fa(n);for(var s in e)e[s].set&&t.push(s);n=ki(n)}return t}function We(r,t){var e=r.__className,n=cl(t);(e!==n||xa)&&(t==null?r.removeAttribute("class"):r.className=n,r.__className=n)}function cl(r){return r??""}function at(r,t,e=t){var n=mi();Jo(r,"input",()=>{var i=ia(r)?sa(r.value):r.value;e(i),n&&i!==(i=t())&&(r.value=i??"")}),Cs(()=>{var i=t();ia(r)&&i===sa(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function ia(r){var t=r.type;return t==="number"||t==="range"}function sa(r){return r===""?null:+r}function aa(r,t){return r===t||(r==null?void 0:r[$t])===t}function et(r={},t,e,n){return Ss(()=>{var i,s;return Cs(()=>{i=s,s=(n==null?void 0:n())||[],Gt(()=>{r!==e(...s)&&(t(r,...s),i&&aa(e(...i),r)&&t(null,...i))})}),()=>{Mi(()=>{s&&aa(e(...s),r)&&t(null,...s)})}}),r}function Ze(r=!1){const t=ze,e=t.l.u;if(!e)return;let n=()=>Zo(t.s);if(r){let i=0,s={};const o=ye(()=>{let d=!1;const c=t.s;for(const h in c)c[h]!==s[h]&&(s[h]=c[h],d=!0);return d&&i++,i});n=()=>a(o)}e.b.length&&$o(()=>{oa(t,n),os(e.b)}),pt(()=>{const i=Gt(()=>e.m.map(so));return()=>{for(const s of i)typeof s=="function"&&s()}}),e.a.length&&pt(()=>{oa(t,n),os(e.a)})}function oa(r,t){if(r.l.s)for(const e of r.l.s)a(e);t()}let yi=!1;function dl(r){var t=yi;try{return yi=!1,[r(),yi]}finally{yi=t}}function la(r){for(var t=Ce,e=Ce;t!==null&&!(t.f&(lt|hi));)t=t.parent;try{return mt(t),r()}finally{mt(e)}}function Ee(r,t,e,n){var L;var i=(e&So)!==0,s=!Kt||(e&Co)!==0,o=(e&Fo)!==0,d=(e&Ao)!==0,c=!1,h;o?[h,c]=dl(()=>r[t]):h=r[t];var g=$t in r||lo in r,p=((L=Wt(r,t))==null?void 0:L.set)??(g&&o&&t in r?I=>r[t]=I:void 0),u=n,l=!0,_=!1,v=()=>(_=!0,l&&(l=!1,d?u=Gt(n):u=n),u);h===void 0&&n!==void 0&&(p&&s&&mo(),h=v(),p&&p(h));var f;if(s)f=()=>{var I=r[t];return I===void 0?v():(l=!0,_=!1,I)};else{var b=la(()=>(i?ye:he)(()=>r[t]));b.f|=pa,f=()=>{var I=a(b);return I!==void 0&&(u=void 0),I===void 0?u:I}}if(!(e&Eo))return f;if(p){var w=r.$$legacy;return function(I,R){return arguments.length>0?((!s||!R||w||c)&&p(R?f():I),I):f()}}var x=!1,k=!1,E=ys(h),M=la(()=>ye(()=>{var I=f(),R=a(E);return x?(x=!1,k=!0,R):(k=!1,E.v=I)}));return i||(M.equals=bs),function(I,R){if(Ct!==null&&(x=k,f(),a(E)),arguments.length>0){const N=R?a(M):s&&o?H(I):I;return M.equals(N)||(x=!0,V(E,N),_&&u!==void 0&&(u=N),Gt(()=>a(M))),I}return a(M)}}function Bi(r){ze===null&&Uo(),Kt&&ze.l!==null?hl(ze).m.push(r):pt(()=>{const t=Gt(r);if(typeof t=="function")return t})}function hl(r){var t=r.l;return t.u??(t.u={a:[],b:[],m:[]})}const fl="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(fl);wo();function vl(r){if(!r)return;r.style.gridTemplateRows=null,r.style.gridTemplateColumns=null;const t=window.getComputedStyle(r),e=t.getPropertyValue("grid-template-rows").trim(),n=t.getPropertyValue("grid-template-columns").trim(),i=e.split(" "),s=n.split(" ");function o(h,g){const p=h.filter(_=>_.endsWith("fr")).reduce((_,v)=>_+parseFloat(v),0),l=(g==="rows"?r.clientHeight:r.clientWidth)/p;return h.map(_=>_.endsWith("fr")?`${parseFloat(_)*l}px`:_).join(" ")}const d=o(i,"rows"),c=o(s,"columns");r.style.gridTemplateRows=d,r.style.gridTemplateColumns=c}function pl(r){const t=document.createElement("canvas"),e=t.getContext("2d");t.width=r.width,t.height=r.height,e.drawImage(r,0,0);const i=e.getImageData(0,0,t.width,t.height).data,s=[],o=(c,h)=>{const g=c.r-h.r,p=c.g-h.g,u=c.b-h.b;return Math.sqrt(g*g+p*p+u*u)},d=(c,h,g)=>{const p=[];for(let u=-g;u<=g;u++)for(let l=-g;l<=g;l++)if(Math.sqrt(u*u+l*l)<=g){const v=c+u,f=h+l;v>=0&&v<t.width&&f>=0&&f<t.height&&p.push({x:v,y:f})}return p};for(let c=0;c<t.height;c++)for(let h=0;h<t.width;h++){const g=(c*t.width+h)*4,p=i[g],u=i[g+1],l=i[g+2];i[g+3];const _={r:p,g:u,b:l};let v=!0;if(v){for(const f of s)if(o(_,f)==0){v=!1;break}}if(v)for(const{x:f,y:b}of d(h,c,5)){const w=(b*t.width+f)*4,x=i[w],k=i[w+1],E=i[w+2];if(o(_,{r:x,g:k,b:E})!=0){v=!1;break}}v&&s.push(_)}return s.map(({r:c,g:h,b:g})=>[c,h,g])}function ml(r,t,e,n){const i=document.createElement("canvas");i.width=e,i.height=n;const s=i.getContext("2d"),o=r.x1-r.radios*Math.cos(r.angle*(Math.PI/180))/2,d=r.y1-r.radios*Math.sin(r.angle*(Math.PI/180))/2,c=r.x1+r.radios*Math.cos(r.angle*(Math.PI/180))/2,h=r.y1+r.radios*Math.sin(r.angle*(Math.PI/180))/2,g=s.createLinearGradient(o*e,d*n,c*e,h*n);return t.forEach(p=>{const u=`rgba(${p.color[0]}, ${p.color[1]}, ${p.color[2]}, ${p.color[3]/255})`;g.addColorStop(p.position/100,u)}),s.fillStyle=g,s.fillRect(0,0,e,n),i}function gl(r,t,e,n){const i=document.createElement("canvas");i.width=e,i.height=n;const s=i.getContext("2d"),o=s.createRadialGradient(r.x1*e,r.y1*n,0,r.x1*e,r.y1*n,r.radios*Math.max(n,e));return t.forEach(d=>{const c=`rgba(${d.color[0]}, ${d.color[1]}, ${d.color[2]}, ${d.color[3]/255})`;o.addColorStop(d.position/100,c)}),s.fillStyle=o,s.fillRect(0,0,e,n),i}function qt(r,t){const e=document.createElement("canvas"),n=e.getContext("2d");let i=t.width,s=t.height;const o=r.width/r.height;return r.width>r.height?s=Math.round(i/o):i=Math.round(s*o),e.width=i,e.height=s,n.drawImage(r,0,0,i,s),e.toDataURL("image/png")}function _l(r,t,e){t=Number(t),e=Number(e);const n=document.createElement("canvas");n.width=t,n.height=e;const i=n.getContext("2d");return i.fillStyle=`rgba(${r[0]},${r[1]},${r[2]},${r[3]/255})`,i.fillRect(0,0,t,e),document.body.appendChild(n),n}function Ni(r,t){const e=Math.max(r.width,1),n=Math.max(r.height,1),i=t.getContext("2d");t.width=e,t.height=n,i.drawImage(r,0,0)}var dr,hr;class Qt{constructor(){ee(this,dr,Q(!1));ee(this,hr,Q(null))}get editName(){return a(T(this,dr))}set editName(t){V(T(this,dr),H(t))}get group(){return a(T(this,hr))}set group(t){V(T(this,hr),H(t))}}dr=new WeakMap,hr=new WeakMap;let Yi=null;class Pt{static GetFileListSingleton(){return Yi==null&&(Yi=new Pt),Yi}constructor(){this.parseSource=()=>{},this.selectEvent=()=>{},this.allowDropEvent=()=>{},this.dropEvent=()=>{},this.reorderEvent=t=>{},this.removeLayer=t=>{},this.uploadMedias=t=>{}}}class ji{constructor(t,e,n=null){this.renderFunction=t,this.optionsRenderFunction=e,this.doRenderFunction=n??(()=>!0)}}class Hi{constructor(t,e,n,i,s="vertical-list",o=!0,d=!1){this.menuKind=i,this.listType=s,this.allowRenaming=o,this.doubleClickSelection=d,this.itemsName=e,this.selectedItemName=n,this.obj=t}set items(t){this.obj[this.itemsName]=t}set selectedItem(t){this.obj[this.selectedItemName]=t}get items(){return this.obj[this.itemsName]}get selectedItem(){return this.obj[this.selectedItemName]}isOrientationVertical(){return new Set(["vertical-list"]).has(this.listType)}}function Mt(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+r/4).toString(16))}function bl(r){return/[.]/.exec(r)?"."+/[^.]+$/.exec(r):void 0}var fr;const Ls=class Ls extends Qt{constructor(e,n){super();ee(this,fr,Q(""));ge(this,"version",1);!(!n||!e)&&(this.id=Mt(),this.name=e,this.extension=bl(e),this.image=n,this.thumbnail=qt(n,{width:40,height:40}))}get name(){return a(T(this,fr))}set name(e){V(T(this,fr),H(e))}Contains(e){return!1}Copy(){const e=new Ls;return e.id=Mt(),e.name=this.name,e.extension=this.extension,e.image=this.image,e.thumbnail=qt(this.image,{width:40,height:40}),e}};fr=new WeakMap;let Ut=Ls;function ua(r,t,e){const n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS)?n:(console.error("Error compiling shader:",r.getShaderInfoLog(n)),r.deleteShader(n),null)}function yl(r,t,e){const n=r.createProgram();return r.attachShader(n,t),r.attachShader(n,e),r.linkProgram(n),r.getProgramParameter(n,r.LINK_STATUS)?n:(console.error("Error linking program:",r.getProgramInfoLog(n)),r.deleteProgram(n),null)}function wl(r){return new Promise(t=>fetch(r).then(e=>e.text()).then(t))}async function xl(r){if(!r)return["",""];let e=(await wl(r)).split(/#Fragment Shader/gi).filter(n=>n.trim()!="");return e.length==1?["",e[0]]:e}class kl{constructor(t){this.gl=t,this.program=null}async SetDataFromFileAsync(...t){let e="",n="";for(let o=t.length-1;o>=0;o--){const[d,c]=await xl(t[o]);d&&(e+=d),c&&(n+=c)}const i=ua(this.gl,this.gl.VERTEX_SHADER,`# version 300 es
`+e),s=ua(this.gl,this.gl.FRAGMENT_SHADER,`# version 300 es
`+n);this.program=yl(this.gl,i,s),this.gl.useProgram(this.program)}GetAttributeLocation(t){return this.gl.getAttribLocation(this.program,t)}GetUniformLocation(t){return this.gl.getUniformLocation(this.program,t)}}let Sl=class{constructor(t,e){this.attribute=e,this.shader=t,this.gl=t.gl,this.buffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer)}SetDataStatic(t){this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW)}Bind(){const t=this.shader.GetAttributeLocation(this.attribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,0,0)}};function ps(r,t){const e=t,n=t,i=r.width,s=r.height,o=i/s,d=e/n;let c,h;return o>d?(c=e,h=e/o):(c=n*o,h=n),[c,h]}function Cl(r){return new Promise(t=>{const e=new Image;e.src=r,e.onload=()=>{t(e)}})}function El(r,t){var e=r.getExtension("WEBGL_compressed_texture_s3tc");switch(t){case"dxt1":return e.COMPRESSED_RGB_S3TC_DXT1_EXT;case"dxt3":return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;case"dxt5":return e.COMPRESSED_RGBA_S3TC_DXT5_EXT;default:throw new Error("unsupported format "+t)}}class Fl{constructor(t,e,n){this.gl=t.gl,this.shader=t,this.attribute=e,this.aspectRatioAttribute=n,this.texture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.slot=0,this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.slots=[this.gl.TEXTURE0,this.gl.TEXTURE1,this.gl.TEXTURE2,this.gl.TEXTURE3,this.gl.TEXTURE4,this.gl.TEXTURE5,this.gl.TEXTURE6,this.gl.TEXTURE7,this.gl.TEXTURE8,this.gl.TEXTURE9,this.gl.TEXTURE10,this.gl.TEXTURE11,this.gl.TEXTURE12,this.gl.TEXTURE13,this.gl.TEXTURE14,this.gl.TEXTURE15,this.gl.TEXTURE16],this.textureLocation=this.shader.GetUniformLocation(this.attribute),this.aspectRatioLocation=this.shader.GetUniformLocation(this.aspectRatioAttribute)}async SetDataFromFileAsync(t){this.image=await Cl(t),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.image)}SetRenderScale(t){if(this.image)if(t==null){const{width:e,height:n}=this.image;this.fit={width:e,height:n}}else{const[e,n]=ps(this.image,t);this.fit={width:e,height:n}}}SetDataFromImage(t){this.image=t,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),t instanceof Image||t instanceof HTMLCanvasElement?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.image):this.gl.compressedTexImage2D(this.gl.TEXTURE_2D,0,El(this.gl,t.format),t.width,t.height,0,t.buffer)}SetSlot(t){this.slot=t}Bind(){this.gl.activeTexture(this.slots[this.slot]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(this.textureLocation,this.slot),this.gl.uniform2f(this.aspectRatioLocation,this.fit.width,this.fit.height)}IsAvailable(){return this.image!=null}}class Al{constructor(t,e){this.shader=t,this.gl=t.gl,this.location=this.shader.GetUniformLocation(e)}SetInt(t){this.gl.uniform1i(this.location,t)}SetFloat(t){this.gl.uniform1f(this.location,t)}SetFloat2(t,e){this.gl.uniform2f(this.location,t,e)}SetFloat3(t,e,n){this.gl.uniform3f(this.location,t,e,n)}}function Tl(r){return r.flat().flat()}class Rl{constructor(t,e,n){this.gl=t.gl,this.shader=t,this.attribute=e,this.sizeAttribute=n,this.texture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.slot=0,this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.slots=[this.gl.TEXTURE0,this.gl.TEXTURE1,this.gl.TEXTURE2,this.gl.TEXTURE3,this.gl.TEXTURE4,this.gl.TEXTURE5,this.gl.TEXTURE6,this.gl.TEXTURE7,this.gl.TEXTURE8,this.gl.TEXTURE9,this.gl.TEXTURE10,this.gl.TEXTURE11,this.gl.TEXTURE12,this.gl.TEXTURE13,this.gl.TEXTURE14,this.gl.TEXTURE15,this.gl.TEXTURE16],this.textureLocation=this.shader.GetUniformLocation(this.attribute),this.sizeLocation=this.shader.GetUniformLocation(this.sizeAttribute)}SetDataFromArray(t){this.width=t[0].length,this.height=t.length,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(Tl(t)))}SetSlot(t){this.slot=t}Bind(){this.gl.activeTexture(this.slots[this.slot]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(this.textureLocation,this.slot),this.gl.uniform2f(this.sizeLocation,this.width-1,this.height-1)}IsAvailable(){return this.width!=null&&this.height!=null}}class As{constructor(t){if(this.gl=t.getContext("webgl2",{preserveDrawingBuffer:!0}),!this.gl)throw new Error("web gl is not supported");this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.canvas=t,this.buffers=[],this.textures=[],this.uniforms={}}AddShader(){return this.shader=new kl(this.gl),this.shader}AddBuffer(t){const e=new Sl(this.shader,t);return this.buffers.push(e),e}AddTexture(t,e){const n=new Fl(this.shader,t,e);return this.textures.push(n),n}AddTextureArray(t,e){const n=new Rl(this.shader,t,e);return this.textures.push(n),n}GetUniform(t){if(t in this.uniforms)return this.uniforms[t];const e=new Al(this.shader,t);return this.uniforms[t]=e,e}FitTexture(t,e){if(e!=null){const[n,i]=ps(t.image,e);this.canvas.width=n,this.canvas.height=i}else this.canvas.width=t.image.width,this.canvas.height=t.image.height}SetSize({width:t,height:e,maxSize:n}){if(n!=null){let[i,s]=ps({width:t,height:e},n);i=Math.max(i,1),s=Math.max(s,1),this.canvas.width=i,this.canvas.height=s}else t=Math.max(t,1),e=Math.max(e,1),this.canvas.width=t,this.canvas.height=e}Clear(){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}RenderTriangleStrip(t){for(const e of this.buffers)e.Bind();for(const e of this.textures)e.IsAvailable()&&e.Bind();this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,t)}}class or{constructor(t,e,n,i,s=0){this.direction=t,this.p=0,this.snapDistance=e,this.offset=s,n<=i?(this.min=n,this.max=i,this.flip=!1):(this.min=i,this.max=n,this.flip=!0)}SetElement(t){this.element=t}GetSize(){if(this.element){if(this.direction=="x"){const t=window.getComputedStyle(this.element.parentElement);return Number(t.width.replace(/px$/gi,""))}else if(this.direction=="y"){const t=window.getComputedStyle(this.element.parentElement);return Number(t.height.replace(/px$/gi,""))}}return 0}GetValueInPixels(t){return this.GetSize(),this.flip?(this.max-t)*100/this.max:t*100/this.max}GetPixelsAsValue(t){let e=this.GetSize();return this.flip?this.max-((t+this.offset)/e*this.max-this.p):(t+this.offset)/e*this.max-this.p}ShouldSnap(t,e){const n=this.GetValueInPixels(t);return Math.abs(n-e)>this.snapDistance}DoSnap(t){return this.flip?this.max-t/this.GetSize()*this.max:t/this.GetSize()*this.max}GetCursorP(t,e){return this.flip?(t+this.offset)/this.GetSize()*this.max-(this.max-e):(t+this.offset)/this.GetSize()*this.max-e}LimitValue(t){return t>this.max?this.max:t<this.min?this.min:t}}function Ki(r,t,e){var n,i,s,o,d,c,h,g;switch(arguments.length===1&&(t=r.s,e=r.v,r=r.h),o=Math.floor(r*6),d=r*6-o,c=e*(1-t),h=e*(1-d*t),g=e*(1-(1-d)*t),o%6){case 0:n=e,i=g,s=c;break;case 1:n=h,i=e,s=c;break;case 2:n=c,i=e,s=g;break;case 3:n=c,i=h,s=e;break;case 4:n=g,i=c,s=e;break;case 5:n=e,i=c,s=h;break}return[Math.round(n*255),Math.round(i*255),Math.round(s*255)]}function nr(r,t,e){arguments.length===1&&(t=r.g,e=r.b,r=r.r);var n=Math.max(r,t,e),i=Math.min(r,t,e),s=n-i,o,d=n===0?0:s/n,c=n/255;switch(n){case i:o=0;break;case r:o=t-e+s*(t<e?6:0),o/=6*s;break;case t:o=e-r+s*2,o/=6*s;break;case e:o=r-t+s*4,o/=6*s;break}return[o,d,c]}function Lt(r){var t=r.toString(16);return t.length==1?"0"+t:t}function zt(r,t,e,n){return Lt(r)+Lt(t)+Lt(e)}function Zt(r,t,e,n){return Lt(r)+Lt(t)+Lt(e)+Lt(n)}function Il(r){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return t==null?null:[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}function xi(r){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return t==null?null:[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),parseInt(t[4],16)]}function Dl(r){return typeof r!="string"?!1:!isNaN(r)&&!isNaN(parseFloat(r))}function Ji(r,t,e){return typeof r!="number"&&(Dl(r)||(r=Number(r))),isNaN(r)?null:r<t?t:r>e?e:r}let Qi=null;var vr;const $s=class $s{constructor(){ge(this,"element",null);ge(this,"mouseX",0);ge(this,"mouseY",0);ee(this,vr,Q(H([])));const t=this;function e(n){t.mouseX=n.clientX,t.mouseY=n.clientY}window.addEventListener("mousemove",e),window.addEventListener("mousedown",n=>{this.element.contains(n.target)||this.Close()}),pt(()=>{this.options;const n=this.element.getBoundingClientRect(),i=n.top,s=n.left,o=n.height,d=n.width,c=window.innerWidth,h=window.innerHeight;i<0?this.element.style.top="0px":i+o>h&&(this.element.style.top=`${h-o}px`),s<0?this.element.style.left="0px":s+d>c&&(this.element.style.left=`${c-d}px`)})}get options(){return a(T(this,vr))}set options(t){V(T(this,vr),H(t))}static GetSingleton(){return Qi==null&&(Qi=new $s),Qi}Open(t,e){this.options=t,this.callback=e,this.element.style.display="flex",this.element.style.left=this.mouseX-250+"px",this.element.style.top=this.mouseY+"px"}Close(){this.element.style.display="none"}PickEvent(t){return e=>{var n;(n=this.callback)==null||n.call(this,t),this.Close()}}};vr=new WeakMap;let Ri=$s;var pr,mr,gr;const Os=class Os extends Qt{constructor(e){super();ee(this,pr,Q("Folder"));ee(this,mr,Q(!0));ee(this,gr,Q(!0));e&&(this.name=e)}get name(){return a(T(this,pr))}set name(e){V(T(this,pr),H(e))}get open(){return a(T(this,mr))}set open(e){V(T(this,mr),H(e))}get openCtx(){return a(T(this,gr))}set openCtx(e){V(T(this,gr),H(e))}get type(){return"separator"}Copy(){var e=new Os(this.name);return e.open=this.open,e}Contains(){return!1}};pr=new WeakMap,mr=new WeakMap,gr=new WeakMap;let De=Os;class Pl{constructor(t){ge(this,"cursorElement",null);ge(this,"cursorSnapDistance",20);ge(this,"axis",null);this.colorPicker=t,this.axis=new or("y",20,360,0)}mouseDownEvent(){return t=>{this.colorPicker.activeEvent="hue";const{clientY:e,offsetY:n}=t;this.axis.ShouldSnap(this.colorPicker.hue,n)&&(this.colorPicker.hue=this.axis.DoSnap(n)),this.axis.p=this.axis.GetCursorP(e,this.colorPicker.hue),this.update()}}mouseMoveEvent(){return t=>{if(this.colorPicker.activeEvent=="hue"){const{clientY:e}=t;this.colorPicker.hue=this.axis.GetPixelsAsValue(e),this.update()}}}update(){this.axis.SetElement(this.cursorElement),this.colorPicker.hue=this.axis.LimitValue(this.colorPicker.hue),this.colorPicker.hue=Math.round(this.colorPicker.hue),this.cursorElement.style.top=this.axis.GetValueInPixels(this.colorPicker.hue)+"%"}}class Ll{constructor(t){ge(this,"cursorElement",null);ge(this,"cursorSnapDistance",20);ge(this,"axis",null);this.colorPicker=t,this.axis=new or("x",20,0,255)}mouseDownEvent(){return t=>{this.colorPicker.activeEvent="alpha";const{clientX:e,offsetX:n}=t;this.axis.ShouldSnap(this.colorPicker.alpha,n)&&(this.colorPicker.alpha=this.axis.DoSnap(n)),this.axis.p=this.axis.GetCursorP(e,this.colorPicker.alpha),this.update()}}mouseMoveEvent(){return t=>{if(this.colorPicker.activeEvent=="alpha"){const{clientX:e}=t;this.colorPicker.alpha=this.axis.GetPixelsAsValue(e),this.update()}}}update(){this.axis.SetElement(this.cursorElement),this.colorPicker.alpha=this.axis.LimitValue(this.colorPicker.alpha),this.colorPicker.alpha=Math.round(this.colorPicker.alpha),this.cursorElement.style.left=this.axis.GetValueInPixels(this.colorPicker.alpha)+"%"}}class $l{constructor(t){ge(this,"cursorElement",null);ge(this,"cursorSnapDistance",20);ge(this,"xAxis",null);ge(this,"yAxis",null);this.colorPicker=t,this.xAxis=new or("x",20,0,100),this.yAxis=new or("y",20,100,0)}mouseDownEvent(){return t=>{this.colorPicker.activeEvent="sv";const{clientY:e,offsetY:n,clientX:i,offsetX:s}=t;(this.xAxis.ShouldSnap(this.colorPicker.saturation,s)||this.yAxis.ShouldSnap(this.colorPicker.brightness,n))&&(this.colorPicker.saturation=this.xAxis.DoSnap(s),this.colorPicker.brightness=this.yAxis.DoSnap(n)),this.xAxis.p=this.xAxis.GetCursorP(i,this.colorPicker.saturation),this.yAxis.p=this.yAxis.GetCursorP(e,this.colorPicker.brightness),this.update()}}mouseMoveEvent(){return t=>{if(this.colorPicker.activeEvent=="sv"){const{clientY:e,clientX:n}=t;this.colorPicker.saturation=this.xAxis.GetPixelsAsValue(n),this.colorPicker.brightness=this.yAxis.GetPixelsAsValue(e),this.update()}}}update(){this.xAxis.SetElement(this.cursorElement),this.yAxis.SetElement(this.cursorElement),this.colorPicker.saturation=this.xAxis.LimitValue(this.colorPicker.saturation),this.colorPicker.brightness=this.yAxis.LimitValue(this.colorPicker.brightness),this.colorPicker.saturation=Math.round(this.colorPicker.saturation),this.colorPicker.brightness=Math.round(this.colorPicker.brightness),this.cursorElement.style.left=this.xAxis.GetValueInPixels(this.colorPicker.saturation)+"%",this.cursorElement.style.top=this.yAxis.GetValueInPixels(this.colorPicker.brightness)+"%"}}let es=null;var _r,br,yr,wr,xr,kr,Sr,Cr,Er,Fr,Ar,Tr;const Gs=class Gs{constructor(){ge(this,"modal",null);ge(this,"callback",null);ee(this,_r,Q(0));ee(this,br,Q(100));ee(this,yr,Q(0));ee(this,wr,Q(0));ee(this,xr,Q(0));ee(this,kr,Q(0));ee(this,Sr,Q(0));ee(this,Cr,Q(0));ee(this,Er,Q(0));ee(this,Fr,Q(0));ee(this,Ar,Q("000000"));ee(this,Tr,Q(H([])));ge(this,"huePicker",new Pl(this));ge(this,"alphaPicker",new Ll(this));ge(this,"svPicker",new $l(this));ge(this,"activeEvent",null);document.addEventListener("mousemove",t=>this.mouseMove(t)),document.addEventListener("mouseup",t=>this.mouseUp(t)),document.addEventListener("mouseleave",t=>this.mouseUp(t)),pt(()=>{const[t,e,n]=Ki(this.hue/360,1,1);this.svRed=t,this.svGreen=e,this.svBlue=n}),pt(()=>{const[t,e,n]=Ki(this.hue/360,this.saturation/100,this.brightness/100);this.red=t,this.blue=n,this.green=e,this.hex=zt(t,e,n),this.svPicker.update(),this.alphaPicker.update(),this.huePicker.update()})}get hue(){return a(T(this,_r))}set hue(t){V(T(this,_r),H(t))}get alpha(){return a(T(this,br))}set alpha(t){V(T(this,br),H(t))}get saturation(){return a(T(this,yr))}set saturation(t){V(T(this,yr),H(t))}get brightness(){return a(T(this,wr))}set brightness(t){V(T(this,wr),H(t))}get red(){return a(T(this,xr))}set red(t){V(T(this,xr),H(t))}get green(){return a(T(this,kr))}set green(t){V(T(this,kr),H(t))}get blue(){return a(T(this,Sr))}set blue(t){V(T(this,Sr),H(t))}get svRed(){return a(T(this,Cr))}set svRed(t){V(T(this,Cr),H(t))}get svGreen(){return a(T(this,Er))}set svGreen(t){V(T(this,Er),H(t))}get svBlue(){return a(T(this,Fr))}set svBlue(t){V(T(this,Fr),H(t))}get hex(){return a(T(this,Ar))}set hex(t){V(T(this,Ar),H(t))}get colorHistory(){return a(T(this,Tr))}set colorHistory(t){V(T(this,Tr),H(t))}static GetSingleton(){return es==null&&(es=new Gs),es}PickColor(t,e){this.red=t[0],this.green=t[1],this.blue=t[2],this.alpha=t[3],this.updateRGB(),this.modal&&(this.callback=e,this.modal.open()),document.addEventListener("mouseup",()=>{this.mouseColor=null})}CloseEvent(){return t=>{this.callback&&(this.callback([this.red,this.green,this.blue,this.alpha]),this.AddThisColorToHistory())}}GetRGBAHex(){return Zt(this.red,this.green,this.blue,this.alpha)}AddThisColorToHistory(){const t=Zt(this.red,this.green,this.blue,this.alpha);this.colorHistory.includes(t)||this.colorHistory.push(t)}ColorHistoryContextMenuEvent(t){return e=>{e.preventDefault();const n=Ri.GetSingleton(),i=[new De("Base Channels"),"Copy All","Copy Color","Copy Alpha",new De("HSV Channels"),"Copy Hue","Copy Saturation Value","Copy Saturation","Copy Value",new De("Delete"),"Delete"];n.Open(i,s=>{if(s=="Delete"){this.colorHistory.splice(this.colorHistory.indexOf(t),1);return}if(s=="Copy All"){this.SetColorFromRGBAHEX(t);return}if(s=="Copy Color"){this.SetColorFromRGBHEX(t);return}const o=xi(t),d=o[0],c=o[1],h=o[2],g=o[3],[p,u,l]=nr(d,c,h);s=="Copy Hue"&&(this.hue=p*360,this.huePicker.update()),(s=="Copy Saturation"||s=="Copy Saturation Value")&&(this.saturation=u*100),(s=="Copy Value"||s=="Copy Saturation Value")&&(this.brightness=l*100),(s=="Copy Saturation"||s=="Copy Value"||s=="Copy Saturation Value")&&this.svPicker.update(),s=="Copy Alpha"&&(this.alpha=g,this.alphaPicker.update())})}}MouseDownEvent(t){return e=>{this.mouseButton=e.button,this.mouseColor=t}}ColorHistoryClickEvent(t){return e=>{this.mouseColor==t&&(this.mouseButton==0?this.SetColorFromRGBAHEX(t):this.mouseButton==1&&this.colorHistory.splice(this.colorHistory.indexOf(t),1))}}SetColorFromRGBAHEX(t){const e=xi(t);this.red=e[0],this.green=e[1],this.blue=e[2],this.alpha=e[3];const[n,i,s]=nr(this.red,this.green,this.blue);this.hue=n*360,this.saturation=i*100,this.brightness=s*100,this.svPicker.update(),this.alphaPicker.update(),this.huePicker.update()}SetColorFromRGBHEX(t){const e=xi(t);this.red=e[0],this.green=e[1],this.blue=e[2];const[n,i,s]=nr(this.red,this.green,this.blue);this.hue=n*360,this.saturation=i*100,this.brightness=s*100,this.svPicker.update(),this.alphaPicker.update(),this.huePicker.update()}mouseUp(t){this.activeEvent=null}mouseMove(t){this.huePicker.mouseMoveEvent()(t),this.alphaPicker.mouseMoveEvent()(t),this.svPicker.mouseMoveEvent()(t)}setHex(t){const e=Il(t);if(e==null)return;this.hex=t;const[n,i,s]=e,[o,d,c]=nr(n,i,s);this.hue=o*360,this.saturation=d*100,this.brightness=c*100}updateRGB(){const[t,e,n]=Ki(this.hue/360,this.saturation/100,this.brightness/100);this.red=Ji(Number(this.red),0,255)??t,this.green=Ji(Number(this.green),0,255)??e,this.blue=Ji(Number(this.blue),0,255)??n;const[i,s,o]=nr(this.red,this.green,this.blue);this.hue=i*360,this.saturation=s*100,this.brightness=o*100}};_r=new WeakMap,br=new WeakMap,yr=new WeakMap,wr=new WeakMap,xr=new WeakMap,kr=new WeakMap,Sr=new WeakMap,Cr=new WeakMap,Er=new WeakMap,Fr=new WeakMap,Ar=new WeakMap,Tr=new WeakMap;let Rt=Gs;function Ol(r){var t=0,e=0;let n=r;do t+=n.offsetTop||0,e+=n.offsetLeft||0,n=n.offsetParent;while(n);n=r;do t-=n.scrollTop||0,e-=n.scrollLeft||0,n=n.parentElement;while(n);return[t,e]}var Rr,Ir,Dr,Pr;const Ms=class Ms{constructor(t){ge(this,"lastPosition",0);ge(this,"lastColor",[255,0,0,0]);ee(this,Rr,Q(0));ee(this,Ir,Q(H([255,0,0,0])));ee(this,Dr,Q(null));ge(this,"tracker",null);ee(this,Pr,Q(!1));this.axis=new or("x",0,0,100,-45),t&&(this.parent=t)}get position(){return a(T(this,Rr))}set position(t){V(T(this,Rr),H(t))}get color(){return a(T(this,Ir))}set color(t){V(T(this,Ir),H(t))}get element(){return a(T(this,Dr))}set element(t){V(T(this,Dr),H(t))}get isRemovingCandidate(){return a(T(this,Pr))}set isRemovingCandidate(t){V(T(this,Pr),H(t))}DoubleClickEvent(){return t=>{Rt.GetSingleton().PickColor(this.color,n=>{var i,s;this.color=[...n],(s=(i=this.parent).oninput)==null||s.call(i)})}}MouseDownEvent(){return t=>{if(t.shiftKey)this.parent.CopyItemEvent(this)(t);else if(this.element){this.isRemovingCandidate=!1,this.axis.SetElement(this.element);const{clientX:e}=t;this.axis.p=this.axis.GetCursorP(e,this.position),this.parent.draggingItem=this}}}Copy(){const t=new Ms;return t.position=this.position,t.color=[...this.color],t}ContextMenuEvent(){return t=>{t.preventDefault(),this.parent.items.splice(this.parent.items.indexOf(this),1)}}MouseUpEvent(){return t=>{this.isRemovingCandidate&&this.parent.items.splice(this.parent.items.indexOf(this),1)}}MouseMoveEvent(){return t=>{if(this.element){const{clientX:e,clientY:n}=t;this.position=this.axis.GetPixelsAsValue(e);const[i,s]=Ol(this.element);this.isRemovingCandidate=Math.abs(n-i)>100,this.UpdatePosition()}}}UpdatePosition(){this.axis.SetElement(this.element),this.position=this.axis.LimitValue(this.position),this.position=Math.round(this.position),this.element.style.left=this.axis.GetValueInPixels(this.position)+"%"}UpdateLastPosition(){this.lastColor=[...this.color],this.lastPosition=this.position}HasChanged(){if(this.position!=this.lastPosition)return this.UpdateLastPosition(),!0;for(let t=0;t<4;(t+=1)-1)if(this.color[t]!=this.lastColor[t])return this.UpdateLastPosition(),!0;return!1}};Rr=new WeakMap,Ir=new WeakMap,Dr=new WeakMap,Pr=new WeakMap;let wt=Ms;var Lr,$r;class Gl{constructor(t,e){ee(this,Lr,Q(null));ee(this,$r,Q(null));ge(this,"items",null);if(this.items=t,document.addEventListener("mousemove",this.MouseMoveEvent()),document.addEventListener("mouseup",this.MouseUpEvent()),document.addEventListener("mouseleave",this.MouseUpEvent()),this.oninput=e,this.items.length==0){const n=new wt(this);n.position=0,n.color=[0,0,0,255];const i=new wt(this);i.position=100,i.color=[255,255,255,255],this.items.push(n,i)}pt(()=>{for(const n of this.items)n.parent=this,n.UpdatePosition(),pt(()=>{const i=n.color;n.UpdatePosition(i)})})}get draggingItem(){return a(T(this,Lr))}set draggingItem(t){V(T(this,Lr),H(t))}get selectedItem(){return a(T(this,$r))}set selectedItem(t){V(T(this,$r),H(t))}GetGradient(){const t=[],e=this.GetItems();e.length==1&&(t.push(`rgba(${e[0].color[0]},${e[0].color[1]},${e[0].color[2]},${e[0].color[3]/100}) 0%`),t.push(`rgba(${e[0].color[0]},${e[0].color[1]},${e[0].color[2]},${e[0].color[3]/100}) 100%`));for(const n of e)t.push(`rgba(${n.color[0]},${n.color[1]},${n.color[2]},${n.color[3]/100}) ${n.position}%`);return` linear-gradient(90deg, ${t.join(",")})`}GetItems(){const t=[...this.items];return t.sort((e,n)=>e.position-n.position),t}SetItemColor(t){const e=this.GetItems(),n=e.indexOf(t);if(e.length>=1){if(n==0){for(let i=0;i<4;(i+=1)-1)t.color[i]=e[1].color[i];return}if(n==e.length-1){for(let i=0;i<4;(i+=1)-1)t.color[i]=e.at(-2).color[i];return}}if(e.length>=2){for(let i=0;i<e.length;(i+=1)-1)if(i+2<e.length){const s=e[i],o=e[i+2];if(t.position>s.position&&t.position<o.position){const d=(t.position-s.position)/(o.position-s.position);for(let c=0;c<4;(c+=1)-1)t.color[c]=Math.round(s.color[c]+(o.color[c]-s.color[c])*d)}}}}AddItemEvent(){return t=>{const e=new wt(this);this.items.push(e),setTimeout(()=>{e.MouseMoveEvent()(t),this.SetItemColor(e),this.selectedItem=e,this.draggingItem=e},0)}}CopyItemEvent(t){return e=>{const n=new wt(this);n.color=[...t.color],this.items.push(n),setTimeout(()=>{n.MouseMoveEvent()(e),this.selectedItem=n,this.draggingItem=n},0)}}MouseMoveEvent(){return t=>{this.draggingItem&&this.draggingItem.MouseMoveEvent()(t)}}MouseUpEvent(){return t=>{var e;this.draggingItem!=null&&((e=this.draggingItem)==null||e.MouseUpEvent()(t),this.draggingItem=null,Ne.GetSingleton().updateScreen())}}}Lr=new WeakMap,$r=new WeakMap;class Ml{constructor(){this.locked=!1,this.queue=[]}async lock(t){const e=()=>{this.queue.length>0?this.queue.shift()():this.locked=!1};return this.locked?await new Promise(n=>this.queue.push(async()=>{await t(),e(),n()})):(this.locked=!0,await t(),e(),Promise.resolve())}}class Ul{constructor(t,e){const n=[-1,-1,1,-1,-1,1,1,1],i=[0,1,1,1,0,0,1,0];e.AddBuffer("a_position").SetDataStatic(n),e.AddBuffer("a_texCoord").SetDataStatic(i),this.groupTexture=e.AddTexture("u_group_texture","u_group_texture_ratio"),this.groupTexture.SetSlot(0),this.ctx=e,this.canvas=t}async Render(t,e,n,i){this.groupTexture.SetDataFromImage(t),this.groupTexture.SetRenderScale(n),this.ctx.FitTexture(this.groupTexture,n),this.ctx.GetUniform("u_normal_strength").SetFloat(e),this.ctx.GetUniform("u_direct_x_normal").SetInt(i?1:0),this.ctx.GetUniform("resolution").SetFloat2(this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.Clear(),this.ctx.RenderTriangleStrip(4)}async ToImageAsync(){return await new Promise(t=>this.canvas.toBlob(t))}async ToDataUrlAsync(){return URL.createObjectURL(await this.ToImageAsync())}}async function zl(r){const t=new As(r);return await t.AddShader().SetDataFromFileAsync("normal.glsl"),new Ul(r,t)}class Xi{constructor(t,...e){this.base=t,this.props=e,this.instance=null}GetSingleton(){return this.instance||(this.instance=new this.base(...this.props)),this.instance}}class Ts{constructor(t){ge(this,"canvas",document.createElement("canvas"));ge(this,"renderer",null);this.createRenderer=t}async InitRendererAsync(){this.renderer==null&&(this.renderer=await this.createRenderer(this.canvas))}}const Bl=new Xi(Ts,ql),Nl=new Xi(Ts,zl),jl=new Xi(Ml);class Na{constructor(t=!0){ge(this,"renderTarget",Bl.GetSingleton());ge(this,"normalRenderTarget",Nl.GetSingleton());ge(this,"enablePostProcessing",!0);ge(this,"mutex",jl.GetSingleton());this.enablePostProcessing=t}async Lock(t){await this.mutex.lock(t)}async InitRendererAsync(){await this.renderTarget.InitRendererAsync(),await this.normalRenderTarget.InitRendererAsync()}async Render(t,e,n,i,s){await this.renderTarget.renderer.Render(t,e,n,i,s),this.enablePostProcessing&&t.convertToNormal&&await this.normalRenderTarget.renderer.Render(this.renderTarget.canvas,t.normalStrength,i.maxSize,t.directXNormal)}GetCanvas(t){return this.enablePostProcessing&&t.convertToNormal?this.normalRenderTarget.canvas:this.renderTarget.canvas}}class Hl{constructor(t,e){const n=[-1,-1,1,-1,-1,1,1,1],i=[0,1,1,1,0,0,1,0];e.AddBuffer("a_position").SetDataStatic(n),e.AddBuffer("a_texCoord").SetDataStatic(i),this.gradientMapTexture=e.AddTextureArray("u_gradient_map_texture","u_gradient_map_size"),this.gradientMapTexture.SetSlot(1),this.ctx=e,this.canvas=t}async Render(t,{time:e,octaves:n,persistence:i,scale:s,disturbance:o,contrast:d,noiseType:c},h,g){const p=[],u=[...t];u.sort((_,v)=>_.position-v.position);for(const _ of u){const v=_.color;p.push([[v[0],v[1],v[2],v[3]],[_.position/100*255,0,0,0]])}this.gradientMapTexture.SetDataFromArray(p);const l={width:h,height:g,maxSize:null};this.ctx.SetSize(l),this.ctx.GetUniform("u_time").SetFloat(e),this.ctx.GetUniform("u_octaves").SetInt(n),this.ctx.GetUniform("u_persistence").SetFloat(i),this.ctx.GetUniform("u_noise_type").SetInt(c),this.ctx.GetUniform("u_scale").SetFloat(s),this.ctx.GetUniform("u_disturbance").SetFloat(o),this.ctx.GetUniform("u_contrast").SetFloat(d),this.ctx.Clear(),this.ctx.RenderTriangleStrip(4)}async ToImageAsync(){return await new Promise(t=>this.canvas.toBlob(t))}async ToDataUrlAsync(){return URL.createObjectURL(await this.ToImageAsync())}}async function Xl(r){const t=new As(r);return await t.AddShader().SetDataFromFileAsync("noise.glsl","gradientMap.glsl","perlinNoise.glsl","voronoiNoise.glsl"),new Hl(r,t)}const Wl=new Xi(Ts,Xl);var Or,Gr,Mr,Ur,zr,Br,Nr,jr,Hr,Xr,Wr,Vr,qr,Zr,Yr;const Us=class Us extends Qt{constructor(e,n=null){super();ge(this,"id",null);ee(this,Or,Q(H({name:"Color",value:"color"})));ee(this,Gr,Q("Pattern"));ee(this,Mr,Q(null));ee(this,Ur,Q(H([255,255,255,255])));ee(this,zr,Q(H([])));ee(this,Br,Q(.5));ee(this,Nr,Q(.5));ee(this,jr,Q(-90));ee(this,Hr,Q(1));ee(this,Xr,Q(10));ee(this,Wr,Q(0));ee(this,Vr,Q(6));ee(this,qr,Q(.5));ee(this,Zr,Q(.8));ee(this,Yr,Q(1.2));ge(this,"canvas",document.createElement("canvas"));ge(this,"version",1);ge(this,"noiseTarget",Wl.GetSingleton());this.image=this.canvas,n!=null&&(this.fillType=n),e&&(this.name=e,this.id=Mt(),this.Render(64,64,!0))}get fillType(){return a(T(this,Or))}set fillType(e){V(T(this,Or),H(e))}get name(){return a(T(this,Gr))}set name(e){V(T(this,Gr),H(e))}get thumbnail(){return a(T(this,Mr))}set thumbnail(e){V(T(this,Mr),H(e))}get color(){return a(T(this,Ur))}set color(e){V(T(this,Ur),H(e))}get gradient(){return a(T(this,zr))}set gradient(e){V(T(this,zr),H(e))}get x1(){return a(T(this,Br))}set x1(e){V(T(this,Br),H(e))}get y1(){return a(T(this,Nr))}set y1(e){V(T(this,Nr),H(e))}get angle(){return a(T(this,jr))}set angle(e){V(T(this,jr),H(e))}get radios(){return a(T(this,Hr))}set radios(e){V(T(this,Hr),H(e))}get scale(){return a(T(this,Xr))}set scale(e){V(T(this,Xr),H(e))}get time(){return a(T(this,Wr))}set time(e){V(T(this,Wr),H(e))}get octaves(){return a(T(this,Vr))}set octaves(e){V(T(this,Vr),H(e))}get persistence(){return a(T(this,qr))}set persistence(e){V(T(this,qr),H(e))}get disturbance(){return a(T(this,Zr))}set disturbance(e){V(T(this,Zr),H(e))}get contrast(){return a(T(this,Yr))}set contrast(e){V(T(this,Yr),H(e))}get type(){return"pattern"}GetGradientReplaced(e=null){const n=[];for(const i of this.gradient){const s=e?e.GetColor(i.color):i.color;n.push({color:s,position:i.position})}return n}Copy(){var n;var e=new Us(this.name,this.fillType);return e.thumbnail=this.thumbnail,e.id=Mt(),e.color=this.color,e.gradient=(n=this.gradient)==null?void 0:n.map(i=>{const s=new wt;return s.position=i.position,s.color=[...i.color],s}),e.x1=this.x1,e.y1=this.y1,e.angle=this.angle,e.radios=this.radios,e}Contains(){return!1}GetUniqueColors(){const e=new Set;if(this.fillType.value=="color")e.add(Zt(...this.color));else if(["linearGradient","radialGradient","perlinNoise","voronoiNoise","grainNoise"].includes(this.fillType.value))for(const n of this.gradient)e.add(Zt(...n.color));return Array.from(e)}async Render(e=800,n=800,i=!1,s=null){e=Math.max(e,1),n=Math.max(n,1);let o=[];const d=s?s.GetColor(this.color):this.color;if(this.gradient.length>0)o=this.GetGradientReplaced(s);else{const g={};g.position=0,g.color=[0,0,0,255];const p={};p.position=100,p.color=[255,255,255,255],o.push(g,p)}const c=["perlinNoise","voronoiNoise","grainNoise"];let h=null;if(this.fillType.value=="color")h=_l(d,e,n);else if(this.fillType.value=="linearGradient")h=ml({x1:this.x1,y1:this.y1,radios:this.radios,angle:this.angle},o,e,n);else if(this.fillType.value=="radialGradient")h=gl({x1:this.x1,y1:this.y1,radios:this.radios},o,e,n);else if(c.includes(this.fillType.value)){await this.noiseTarget.InitRendererAsync();const g={scale:this.scale,time:this.time,octaves:this.octaves,persistence:this.persistence,disturbance:this.disturbance,contrast:this.contrast,noiseType:c.indexOf(this.fillType.value)};await this.noiseTarget.renderer.Render(o,g,e,n),h=this.noiseTarget.canvas}Ni(h,this.image),this.canvas=this.image,i&&(this.thumbnail=qt(this.image,{width:40,height:40})),this.version++}};Or=new WeakMap,Gr=new WeakMap,Mr=new WeakMap,Ur=new WeakMap,zr=new WeakMap,Br=new WeakMap,Nr=new WeakMap,jr=new WeakMap,Hr=new WeakMap,Xr=new WeakMap,Wr=new WeakMap,Vr=new WeakMap,qr=new WeakMap,Zr=new WeakMap,Yr=new WeakMap;let Ue=Us;class Vl{constructor(t,e){const n=[-1,-1,1,-1,-1,1,1,1],i=[0,1,1,1,0,0,1,0];e.AddBuffer("a_position").SetDataStatic(n),e.AddBuffer("a_texCoord").SetDataStatic(i),this.gradientMapTexture=e.AddTextureArray("u_gradient_map_texture","u_gradient_map_size"),this.gradientMapTexture.SetSlot(3),this.groupTexture=e.AddTexture("u_group_texture","u_group_texture_ratio"),this.groupTexture.SetSlot(0),this.maskTexture=e.AddTexture("u_mask_texture","u_mask_texture_ratio"),this.maskTexture.SetSlot(1),this.lastTexture=e.AddTexture("u_last_texture","u_last_texture_ratio"),this.lastTexture.SetSlot(2),this.fileMaskTexture=e.AddTexture("u_file_mask_texture","u_file_mask_ratio"),this.fileMaskTexture.SetSlot(4),this.blurMaskTexture=e.AddTexture("u_blur_mask_texture","u_blur_mask_ratio"),this.blurMaskTexture.SetSlot(5),this.ctx=e,this.canvas=t}async Render(t,e,n,i,s=null){var d;if(!t)return;if(e.length<=0){this.ctx.Clear();return}if(t.file){const c=s.GetFile(t.file);c&&(this.maskTexture.SetDataFromImage(c.image),this.maskTexture.SetRenderScale(i.maxSize))}this.ctx.SetSize(i),this.ctx.GetUniform("resolution").SetFloat2(this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.Clear();let o=!1;for(let c=e.length-1;c>=0;(c-=1)+1){const h=e[c];if(!h.visible&&!n)continue;const g=h.file;if(g instanceof Ut||g instanceof Le||g instanceof Ue){const p=h.scale/100;if(h.enableGradientMap){this.ctx.GetUniform("u_enable_gradient_map").SetInt(1);const l=[],_=[...h.gradientMapColors];_.sort((v,f)=>v.position-f.position);for(const v of _){const f=s.GetColor(v.color);l.push([[f[0],f[1],f[2],f[3]],[v.position/100*255,0,0,0]])}this.gradientMapTexture.SetDataFromArray(l)}else this.ctx.GetUniform("u_enable_gradient_map").SetInt(0);if(h.fileMask!=null){this.ctx.GetUniform("u_has_file_mask").SetInt(1);const l=s.GetFile(h.fileMask);l instanceof Ue&&await l.Render(this.ctx.canvas.width*p,this.ctx.canvas.height*p,!1,s),l&&(this.fileMaskTexture.SetDataFromImage(l.image),this.fileMaskTexture.SetRenderScale(i.maxSize))}else this.ctx.GetUniform("u_has_file_mask").SetInt(0);if(h.blurMask!=null){this.ctx.GetUniform("u_has_blur_mask").SetInt(1);const l=s.GetFile(h.blurMask);l instanceof Ue&&await l.Render(this.ctx.canvas.width*p,this.ctx.canvas.height*p,!1,s),l&&(this.blurMaskTexture.SetDataFromImage(l.image),this.blurMaskTexture.SetRenderScale(i.maxSize))}else this.ctx.GetUniform("u_has_blur_mask").SetInt(0);o?(this.ctx.GetUniform("u_has_last").SetInt(1),this.ctx.GetUniform("u_blend_mode").SetInt(((d=h.blendMode)==null?void 0:d.value)??17),this.lastTexture.SetDataFromImage(this.ctx.canvas),this.lastTexture.SetRenderScale(i.maxSize)):(this.ctx.GetUniform("u_has_last").SetInt(0),o=!0),this.ctx.GetUniform("u_alpha").SetFloat(h.alpha/100),this.ctx.GetUniform("u_enable_r").SetInt(h.enableR),this.ctx.GetUniform("u_enable_g").SetInt(h.enableG),this.ctx.GetUniform("u_enable_b").SetInt(h.enableB),this.ctx.GetUniform("u_enable_hue").SetInt(h.enableH),this.ctx.GetUniform("u_enable_saturation").SetInt(h.enableS),this.ctx.GetUniform("u_enable_brightens").SetInt(h.enableV),this.ctx.GetUniform("u_blur_amount").SetFloat(h.blurAmount),this.ctx.GetUniform("u_saturation").SetFloat(h.saturation),this.ctx.GetUniform("u_contrast").SetFloat(h.contrast),this.ctx.GetUniform("u_brightens").SetFloat(h.brightness),this.ctx.GetUniform("u_hue").SetFloat(h.hue),this.ctx.GetUniform("u_colorize").SetInt(h.colorize?1:0),this.ctx.GetUniform("u_invert").SetInt(h.invert?1:0),this.ctx.GetUniform("u_scale").SetFloat(h.scale/100),this.ctx.GetUniform("u_horizontal_alignment").SetInt(h.horizontalAlignment.value),this.ctx.GetUniform("u_vertical_alignment").SetInt(h.verticalAlignment.value),this.ctx.GetUniform("u_offset").SetFloat2(h.xOffset,h.yOffset),this.ctx.GetUniform("u_tile").SetInt(h.tile),this.ctx.GetUniform("u_has_mask").SetInt(h.maskGroup!=null?1:0);const u=s.GetFile(g);u instanceof Ue&&await u.Render(this.ctx.canvas.width*p,this.ctx.canvas.height*p,!1,s),u&&(this.groupTexture.SetDataFromImage(u.image),this.groupTexture.SetRenderScale(i.maxSize)),h.maskGroup?(this.ctx.GetUniform("u_mask_color").SetFloat3(...h.maskGroup.map(l=>l/255)),this.ctx.RenderTriangleStrip(4)):(this.ctx.GetUniform("u_mask_color").SetFloat3(0,0,0),this.ctx.RenderTriangleStrip(4))}}}async ToImageAsync(){return await new Promise(t=>this.canvas.toBlob(t))}async ToDataUrlAsync(){return URL.createObjectURL(await this.ToImageAsync())}}async function ql(r){const t=new As(r);return await t.AddShader().SetDataFromFileAsync("shader.glsl","blend.glsl","adjustment.glsl","gradientMap.glsl"),new Vl(r,t)}var Kr,Jr,Qr,en,tn,rn,nn,sn,an,on,ln,un,cn,dn,hn,fn,vn,pn,mn,gn,_n,bn,yn,wn,xn,kn,Sn,Cn,En,Fn;const Li=class Li extends Qt{constructor(e){super();ee(this,Kr,Q(""));ee(this,Jr,Q(!0));ee(this,Qr,Q(100));ee(this,en,Q(null));ee(this,tn,Q(null));ee(this,rn,Q(null));ee(this,nn,Q(null));ee(this,sn,Q(null));ee(this,an,Q(null));ee(this,on,Q(H([])));ee(this,ln,Q(!1));ee(this,un,Q(0));ee(this,cn,Q(1));ee(this,dn,Q(1));ee(this,hn,Q(0));ee(this,fn,Q(100));ee(this,vn,Q(0));ee(this,pn,Q(!1));ee(this,mn,Q(!1));ee(this,gn,Q(!0));ee(this,_n,Q(!0));ee(this,bn,Q(!0));ee(this,yn,Q(!1));ee(this,wn,Q(!1));ee(this,xn,Q(!1));ee(this,kn,Q(H({name:"Center",value:1})));ee(this,Sn,Q(H({name:"Center",value:1})));ee(this,Cn,Q(!0));ee(this,En,Q(0));ee(this,Fn,Q(0));ge(this,"canvas",document.createElement("canvas"));ge(this,"renderingContext",new Na(!1));e!=null&&(this.id=Mt(),this.name=e)}get name(){return a(T(this,Kr))}set name(e){V(T(this,Kr),H(e))}get visible(){return a(T(this,Jr))}set visible(e){V(T(this,Jr),H(e))}get alpha(){return a(T(this,Qr))}set alpha(e){V(T(this,Qr),H(e))}get maskGroup(){return a(T(this,en))}set maskGroup(e){V(T(this,en),H(e))}get blendMode(){return a(T(this,tn))}set blendMode(e){V(T(this,tn),H(e))}get file(){return a(T(this,rn))}set file(e){V(T(this,rn),H(e))}get fileMask(){return a(T(this,nn))}set fileMask(e){V(T(this,nn),H(e))}get blurMask(){return a(T(this,sn))}set blurMask(e){V(T(this,sn),H(e))}get thumbnail(){return a(T(this,an))}set thumbnail(e){V(T(this,an),H(e))}get gradientMapColors(){return a(T(this,on))}set gradientMapColors(e){V(T(this,on),H(e))}get enableGradientMap(){return a(T(this,ln))}set enableGradientMap(e){V(T(this,ln),H(e))}get blurAmount(){return a(T(this,un))}set blurAmount(e){V(T(this,un),H(e))}get saturation(){return a(T(this,cn))}set saturation(e){V(T(this,cn),H(e))}get contrast(){return a(T(this,dn))}set contrast(e){V(T(this,dn),H(e))}get brightness(){return a(T(this,hn))}set brightness(e){V(T(this,hn),H(e))}get scale(){return a(T(this,fn))}set scale(e){V(T(this,fn),H(e))}get hue(){return a(T(this,vn))}set hue(e){V(T(this,vn),H(e))}get colorize(){return a(T(this,pn))}set colorize(e){V(T(this,pn),H(e))}get invert(){return a(T(this,mn))}set invert(e){V(T(this,mn),H(e))}get enableR(){return a(T(this,gn))}set enableR(e){V(T(this,gn),H(e))}get enableG(){return a(T(this,_n))}set enableG(e){V(T(this,_n),H(e))}get enableB(){return a(T(this,bn))}set enableB(e){V(T(this,bn),H(e))}get enableH(){return a(T(this,yn))}set enableH(e){V(T(this,yn),H(e))}get enableS(){return a(T(this,wn))}set enableS(e){V(T(this,wn),H(e))}get enableV(){return a(T(this,xn))}set enableV(e){V(T(this,xn),H(e))}get horizontalAlignment(){return a(T(this,kn))}set horizontalAlignment(e){V(T(this,kn),H(e))}get verticalAlignment(){return a(T(this,Sn))}set verticalAlignment(e){V(T(this,Sn),H(e))}get tile(){return a(T(this,Cn))}set tile(e){V(T(this,Cn),H(e))}get xOffset(){return a(T(this,En))}set xOffset(e){V(T(this,En),H(e))}get yOffset(){return a(T(this,Fn))}set yOffset(e){V(T(this,Fn),H(e))}static CreateFromFile(e){let n=new Li(e.name);return n.thumbnail=e.thumbnail,n.file=e,n}ResetBlurAmount(){this.blurAmount=0}ResetSaturation(){this.saturation=1}ResetContrast(){this.contrast=1}ResetBrightness(){this.brightness=0}ResetScale(){this.scale=100}ResetHue(){this.hue=0}ResetAlpha(){this.alpha=100}ResetColorize(){this.colorize=!1}ResetAdjustments(){this.blurAmount=0,this.saturation=1,this.contrast=1,this.brightness=0,this.scale=100,this.alpha=100,this.hue=0,this.colorize=!1,this.blendMode=null,this.invert=!1,this.enableGradientMap=!1,this.fileMask=null,this.blurMask=null,this.gradientMapColors=[],this.horizontalAlignment={name:"Center",value:1},this.verticalAlignment={name:"Center",value:1},this.tile=!0,this.xOffset=0,this.yOffset=0,this.enableR=!0,this.enableG=!0,this.enableB=!0,this.enableH=!1,this.enableS=!1,this.enableV=!1}CreateThumbnail(e){this.thumbnail=qt(e,{width:40,height:40})}Contains(e){if(this.file&&this.file instanceof Le){for(const n of this.file.layers)if(n.Contains(e))return!0}return this.file!=null&&this.file==e}Copy(){const e=new Li;return e.blurAmount=this.blurAmount,e.saturation=this.saturation,e.contrast=this.contrast,e.brightness=this.brightness,e.scale=this.scale,e.alpha=this.alpha,e.hue=this.hue,e.colorize=this.colorize,e.maskGroup=this.maskGroup,e.fileMask=this.fileMask,e.blurMask=this.blurMask,e.blendMode=this.blendMode,e.file=this.file,e.thumbnail=this.thumbnail,e.name=this.name,e.invert=this.invert,e.enableGradientMap=this.enableGradientMap,e.gradientMapColors=this.gradientMapColors.map(n=>n.Copy()),e.thumbnail=this.thumbnail,e.enableR=this.enableR,e.enableG=this.enableG,e.enableB=this.enableB,e.enableH=this.enableH,e.enableS=this.enableS,e.enableV=this.enableV,e.horizontalAlignment=this.horizontalAlignment,e.verticalAlignment=this.verticalAlignment,e.tile=this.tile,e.xOffset=this.xOffset,e.yOffset=this.yOffset,e}RenderAsync(e){this.renderingContext.Lock(async()=>{if(this.file&&this.file.image){await this.renderingContext.InitRendererAsync();const n=Ne.GetSingleton(),i={width:this.file.image.width,height:this.file.image.height,maxSize:e};await this.renderingContext.Render(n.selectedFile,[this],!0,i,n.selectedFile);const s=this.renderingContext.GetCanvas(n.selectedFile);Ni(s,this.canvas),this.CreateThumbnail(this.canvas)}})}};Kr=new WeakMap,Jr=new WeakMap,Qr=new WeakMap,en=new WeakMap,tn=new WeakMap,rn=new WeakMap,nn=new WeakMap,sn=new WeakMap,an=new WeakMap,on=new WeakMap,ln=new WeakMap,un=new WeakMap,cn=new WeakMap,dn=new WeakMap,hn=new WeakMap,fn=new WeakMap,vn=new WeakMap,pn=new WeakMap,mn=new WeakMap,gn=new WeakMap,_n=new WeakMap,bn=new WeakMap,yn=new WeakMap,wn=new WeakMap,xn=new WeakMap,kn=new WeakMap,Sn=new WeakMap,Cn=new WeakMap,En=new WeakMap,Fn=new WeakMap;let Ii=Li;var An;const zs=class zs{constructor(t){ee(this,An,Q(null));t&&(this.color=xi(t),this.baseColor=t)}get color(){return a(T(this,An))}set color(t){V(T(this,An),H(t))}Copy(){const t=new zs;return t.color=this.color,t.baseColor=this.baseColor,t}};An=new WeakMap;let Di=zs;var Tn,Rn;const Bs=class Bs{constructor(t){ee(this,Tn,Q(null));ee(this,Rn,Q(null));t&&(this.file=t,this.baseFile=t)}get file(){return a(T(this,Tn))}set file(t){V(T(this,Tn),H(t))}get baseFile(){return a(T(this,Rn))}set baseFile(t){V(T(this,Rn),H(t))}Copy(){const t=new Bs;return t.file=this.file,t.baseFile=this.baseFile,t}};Tn=new WeakMap,Rn=new WeakMap;let Pi=Bs;var In,Dn,Pn,Ln,$n,On,Gn;const Ns=class Ns extends Qt{constructor(e,n){super();ee(this,In,Q(H([])));ee(this,Dn,Q(H([])));ee(this,Pn,Q(!0));ee(this,Ln,Q(null));ee(this,$n,Q(""));ee(this,On,Q(null));ee(this,Gn,Q(null));n&&(this.name=n),e&&(this.base=e,this.Load()),this.id=Mt()}get files(){return a(T(this,In))}set files(e){V(T(this,In),H(e))}get colors(){return a(T(this,Dn))}set colors(e){V(T(this,Dn),H(e))}get enabled(){return a(T(this,Pn))}set enabled(e){V(T(this,Pn),H(e))}get base(){return a(T(this,Ln))}set base(e){V(T(this,Ln),H(e))}get name(){return a(T(this,$n))}set name(e){V(T(this,$n),H(e))}get thumbnail(){return a(T(this,On))}set thumbnail(e){V(T(this,On),H(e))}get preview(){return a(T(this,Gn))}set preview(e){V(T(this,Gn),H(e))}async Render(e=null){const n=this;this.BuildFileCache();async function i(s,o,d=null,c=null){if(s==null)return;const[h,g]=s.CalculateSize(n,d,c);o===null&&(o=Math.max(h,g));for(const u of s.layers){const l=u.scale/100;u.file instanceof Le&&await i(u.file,o?o*l:null,h*l,g*l),u.fileMask instanceof Le&&await i(u.fileMask,o?o*l:null,h*l,g*l),u.blurMask instanceof Le&&await i(u.blurMask,o?o*l:null,h*l,g*l)}const p={width:h,height:g,maxSize:o};await s.renderingContext.Lock(async()=>{await s.renderingContext.InitRendererAsync(),await s.renderingContext.Render(s,s.layers,!1,p,n),Ni(s.renderingContext.GetCanvas(s),s.outputCanvas),s.image=s.outputCanvas})}await i(this.base,e,1024,1024)}GetCanvas(){return this.base.convertToNormal?this.base.normalCanvas:this.base.canvas}BuildFileCache(){this.fileDictionary={},this.colorDictionary={};for(const e of this.files)this.fileDictionary[e.baseFile.id]=e.file;for(const e of this.colors)this.colorDictionary[e.baseColor]=e.color}get file(){var e;return(e=this.base)==null?void 0:e.file}GetFile(e){return e==null||e.id in this.fileDictionary&&(e=this.fileDictionary[e.id]),e}GetColor(e){const n=Zt(...e);return n in this.colorDictionary?this.colorDictionary[n]:e}Load(){var e,n,i,s;this.files=((n=(e=this.base)==null?void 0:e.GetUniqueFiles())==null?void 0:n.map(o=>new Pi(o)))??[],this.colors=((s=(i=this.base)==null?void 0:i.GetUniqueColors())==null?void 0:s.map(o=>new Di(o)))??[],this.UpdatePreview()}Copy(){const e=new Ns;return e.name=this.name,e.files=this.files.map(n=>n.Copy()),e.colors=this.colors.map(n=>n.Copy()),e.enabled=this.enabled,e.base=this.base,e.thumbnail=this.thumbnail,e.preview=this.preview,e}async UpdatePreview(){var n;await this.Render(500);const e=(n=this.base)==null?void 0:n.renderingContext.GetCanvas(this.base);e&&(this.thumbnail=await qt(e,{width:40,height:40}),this.preview=e.toDataURL("image/png"))}};In=new WeakMap,Dn=new WeakMap,Pn=new WeakMap,Ln=new WeakMap,$n=new WeakMap,On=new WeakMap,Gn=new WeakMap;let Yt=Ns;var Mn,Un,zn,Bn,Nn,jn,Hn,Xn,Wn;const ot=class ot extends Qt{constructor(e){super();ee(this,Mn,Q(H([])));ee(this,Un,Q(null));ee(this,zn,Q(""));ee(this,Bn,Q(null));ee(this,Nn,Q(null));ee(this,jn,Q(null));ge(this,"image",null);ge(this,"renderingContext",new Na);ge(this,"version",1);ee(this,Hn,Q(!1));ee(this,Xn,Q(!0));ee(this,Wn,Q(10));ge(this,"canvas",document.createElement("canvas"));ge(this,"outputCanvas",document.createElement("canvas"));e&&(this.name=e,this.id=Mt(),this.RenderAsync())}get layers(){return a(T(this,Mn))}set layers(e){V(T(this,Mn),H(e))}get selectedLayer(){return a(T(this,Un))}set selectedLayer(e){V(T(this,Un),H(e))}get name(){return a(T(this,zn))}set name(e){V(T(this,zn),H(e))}get thumbnail(){return a(T(this,Bn))}set thumbnail(e){V(T(this,Bn),H(e))}get file(){return a(T(this,Nn))}set file(e){V(T(this,Nn),H(e))}get colors(){return a(T(this,jn))}set colors(e){V(T(this,jn),H(e))}get convertToNormal(){return a(T(this,Hn))}set convertToNormal(e){V(T(this,Hn),H(e))}get directXNormal(){return a(T(this,Xn))}set directXNormal(e){V(T(this,Xn),H(e))}get normalStrength(){return a(T(this,Wn))}set normalStrength(e){V(T(this,Wn),H(e))}BuildFileCache(){}GetFile(e){return e}GetColor(e){return e}AddLayer(e,n){this.layers.splice(e,0,Ii.CreateFromFile(n)),this.selectedLayer=this.layers[e]}CopyLayer(e){this.layers.splice(e,0,this.layers[e].Copy()),this.selectedLayer=this.layers[e]}CreateReference(e){return new Yt(this,e)}Copy(){const e=new ot;return e.layers=this.layers.map(n=>n.Copy()),e.thumbnail=this.thumbnail,e.colors=this.colors,e.file=this.file,e.name=this.name,e.image=this.image,e.convertToNormal=this.convertToNormal,e.directXNormal=this.directXNormal,e.normalStrength=this.normalStrength,e.selectedLayer=e.layers[this.layers.indexOf(this.selectedLayer)],e}CreateThumbnail(e){this.thumbnail=qt(e,{width:40,height:40})}Contains(e){for(const n of this.layers)if(n.Contains(e))return!0;return e==this}GenerateMask(){this.colors=pl(this.file.image)}CalculateSize(e,n,i){var d;let s=this,o=this;do s=e.GetFile(s.file??((d=s.layers.at(-1))==null?void 0:d.file));while(s instanceof ot&&o!=s);return s&&!(s instanceof Ue)&&(n=s.image.width,i=s.image.height),n=Math.max(1,n),i=Math.max(1,i),[n,i]}async RenderAsync(e,n=null,i=null,s=!0){if(this.layers.length==0)return;const[o,d]=this.CalculateSize(this,n,i);e===null&&(e=Math.max(o,d));for(const c of this.layers){const h=c.scale/100;c.file instanceof ot&&await c.file.RenderAsync(e*h,o*h,d*h,!1),c.fileMask instanceof ot&&await c.fileMask.RenderAsync(e*h,o*h,d*h,!1),c.blurMask instanceof ot&&await c.blurMask.RenderAsync(e*h,o*h,d*h,!1)}await this.renderingContext.Lock(async()=>{await this.renderingContext.InitRendererAsync();const c={width:o,height:d,maxSize:e};await this.renderingContext.Render(this,this.layers,!1,c,this);const h=this.renderingContext.GetCanvas(this);Ni(h,this.canvas),s&&this.CreateThumbnail(this.canvas),this.image=this.canvas,this.version++})}GetCanvas(){return this.canvas}GetUniqueFiles(){const e=new Set;function n(i){i.file&&e.add(i.file);for(const s of i.layers)s.file&&(s.file instanceof ot?n(s.file):e.add(s.file)),s.fileMask&&e.add(s.fileMask),s.blurMask&&e.add(s.blurMask)}return n(this),Array.from(e)}GetUniqueColors(){const e=new Set;for(const n of this.layers){if(n.gradientMapColors)for(const i of n.gradientMapColors)e.add(Zt(...i.color));if(n.file instanceof Ue||n.file instanceof ot)for(const i of n.file.GetUniqueColors())e.add(i);if(n.fileMask instanceof Ue||n.fileMask instanceof ot)for(const i of n.fileMask.GetUniqueColors())e.add(i);if(n.blurMask instanceof Ue||n.blurMask instanceof ot)for(const i of n.blurMask.GetUniqueColors())e.add(i)}return Array.from(e)}ReplaceFile(e,n){for(const i of this.layers)i.file==e&&(i.file=n),i.fileMask==e&&(i.fileMask=n),i.blurMask==e&&(i.blurMask=n)}updateAllLayers(){for(const e of this.layers)e.RenderAsync(300)}getSelectedLayerIndex(){return this.layers.indexOf(this.selectedLayer)}};Mn=new WeakMap,Un=new WeakMap,zn=new WeakMap,Bn=new WeakMap,Nn=new WeakMap,jn=new WeakMap,Hn=new WeakMap,Xn=new WeakMap,Wn=new WeakMap;let Le=ot,ts=null;var Vn,qn,Zn,Yn,Kn;const js=class js{constructor(){ge(this,"projectName","Project");ee(this,Vn,Q(H([])));ee(this,qn,Q(H([])));ee(this,Zn,Q(null));ee(this,Yn,Q(-1));ee(this,Kn,Q(H([])));ge(this,"renderChanged",null);this.renderChanged=new CustomEvent("renderChanged",{})}get files(){return a(T(this,Vn))}set files(t){V(T(this,Vn),H(t))}get selectedFileHistory(){return a(T(this,qn))}set selectedFileHistory(t){V(T(this,qn),H(t))}get selectedFileHistoryItem(){return this.selectedFile}set selectedFileHistoryItem(t){}get selectedFile(){return a(T(this,Zn))}set selectedFile(t){V(T(this,Zn),H(t))}get historyIndex(){return a(T(this,Yn))}set historyIndex(t){V(T(this,Yn),H(t))}get history(){return a(T(this,Kn))}set history(t){V(T(this,Kn),H(t))}static GetSingleton(){return ts==null&&(ts=new js),ts}CopyComposition(t){const e=this.files[t].Copy();this.files.splice(t,0,e),this.selectFile(e)}updateScreen(){document.dispatchEvent(this.renderChanged)}selectFile(t){if(this.files.length>0){const e=this.files.indexOf(t);e!=-1&&(this.selectedFile=this.files[e])}}addComposition(){const t=new Le(this.GetAvailableName("Composition"));this.files.splice(0,0,t),this.selectFile(t)}getFolder(t){if(t instanceof Le&&(t=this.files.indexOf(t)),this.files[t]instanceof De)return null;for(let e=t-1;e>=0;(e-=1)+1)if(this.files[e]instanceof De)return this.files[e];return null}GetAvailableName(t){let e=t,n=2;for(;this.files.some(i=>i.name==e);)e=t+" ("+n+")",n+=1;return e}addFolder(){const t=new De(this.GetAvailableName("Folder"));this.files.push(t)}addColor(){const t=new Ue(this.GetAvailableName("Color"));this.files.splice(0,0,t),this.selectFile(t)}addLinearGradient(){const t=new Ue(this.GetAvailableName("Linear Gradient"),{name:"Linear Gradient",value:"linearGradient"});this.files.splice(0,0,t),this.selectFile(t)}addRadialGradient(){const t=new Ue(this.GetAvailableName("Radial Gradient"),{name:"Radial Gradient",value:"radialGradient"});this.files.splice(0,0,t),this.selectFile(t)}addPerlinNoise(){const t=new Ue(this.GetAvailableName("Perlin Noise"),{name:"Perlin Noise",value:"perlinNoise"});this.files.splice(0,0,t),this.selectFile(t)}addVoronoiNoise(){const t=new Ue(this.GetAvailableName("Voronoi Noise"),{name:"Voronoi Noise",value:"voronoiNoise"});this.files.splice(0,0,t),this.selectFile(t)}addGrainNoise(){const t=new Ue(this.GetAvailableName("Grain Noise"),{name:"Grain Noise",value:"grainNoise"});this.files.splice(0,0,t),this.selectFile(t)}addImage(t,e){this.files.splice(0,0,new Ut(t.name,e))}getSelectedLayer(){return this.selectedFile?this.selectedFile.selectedLayer:null}getSelectedFile(){return this.selectedFile}isCompositionActive(){return this.selectedFile instanceof Le}getSelectedFileIndex(){return this.files.indexOf(this.selectedFile)}removeFromTabs(t){const e=this.files[t],n=this.selectedFileHistory.indexOf(e);n!=-1&&this.selectedFileHistory.splice(n,1)}cleanReferences(t){const e=this.files[t];for(const n of this.files)if(n instanceof Le){n.file==e&&(n.file=null);for(const i of n.layers)i.file==e&&(i.file=null),i.fileMask==e&&(i.fileMask=null),i.blurMask==e&&(i.blurMask=null)}}};Vn=new WeakMap,qn=new WeakMap,Zn=new WeakMap,Yn=new WeakMap,Kn=new WeakMap;let Ne=js;function Zl(r,t){const i=window.getComputedStyle(r).getPropertyValue("grid-template-areas").split(/"\s*"{0,1}/gi).filter(f=>f!="").map(f=>f.split(/\s+/)),s={};for(const f of Array.from(r.children)){const b=window.getComputedStyle(f).getPropertyValue("grid-area").trim();s[b]=f}const o={};let d=0,c=0;for(let f=0;f<i.length;f++){const b=i[f];d=0;for(let w=0;w<b.length;w++){const x=b[w],k=w+1<b.length?b[w+1]:null,E=f+1<i.length?i[f+1][w]:null;t.fixedAreas.includes(x)||(k!=null&&!t.fixedAreas.includes(k)&&x!=k&&(o[x]==null&&(o[x]=[]),o[x].push({position:"x+",edge:d})),E!=null&&!t.fixedAreas.includes(E)&&E!=null&&x!=E&&(o[x]==null&&(o[x]=[]),o[x].push({position:"y+",edge:c}))),d++}c++}const h=[];for(const[f,b]of Object.entries(o))h.push({item:s[f],helpers:b});t.thickness==null&&(t.thickness="15px"),t.minWidth==null&&(t.minWidth=30),t.minHeight==null&&(t.minHeight=30),t.helperClass==null&&(t.helperClass=null),t.helperActiveClass==null&&(t.helperActiveClass=null);const g=getComputedStyle(r),p=g.gap??"0px",u=g.gridTemplateColumns.split(" ").length,l=g.gridTemplateRows.split(" ").length,_={"x+":Ql,"y+":eu},v={x:Yl,y:Kl};for(const f of h){const b=f.item;for(let{position:w,edge:x}of f.helpers){if(w[0]=="x"&&(x<0||x>u-2)){console.warn(`Horizontal internal edge "${x}" does not exist in the grid, skipping it`);continue}if(w[0]=="y"&&(x<0||x>l-2)){console.warn(`Vertical internal edge "${x}" does not exist in the grid, skipping it`);continue}v[w[0]](r,_[w](Jl(b,t),p,t),x,t)}}}function Yl(r,t,e,n){let i=null,s=0,o=0,d=null;t.addEventListener("mousedown",c);function c(p){const{clientX:u}=p;n.helperActiveClass!=null&&t.classList.add(n.helperActiveClass),d=r.style.userSelect,r.style.userSelect="none",i=getComputedStyle(r).gridTemplateColumns.split(" ").map(_=>Number(_.replace("px",""))),r.addEventListener("mousemove",g),r.addEventListener("mouseup",h);let l=i[e];o=i[e+1]+l,s=u-l}function h(p){r.removeEventListener("mousemove",g),r.removeEventListener("mouseUp",h),r.style.userSelect=d,n.helperActiveClass!=null&&t.classList.remove(n.helperActiveClass)}function g(p){const{clientX:u}=p;let l=Math.min(Math.max(u-s,n.minWidth),o-n.minWidth);i[e]=l,i[e+1]=Math.max(o-l,0);let _=i.map(v=>v+"px").join(" ");r.style.gridTemplateColumns=_}}function Kl(r,t,e,n){let i=null,s=0,o=0,d=null;t.addEventListener("mousedown",c);function c(p){const{clientY:u}=p;n.helperActiveClass!=null&&t.classList.add(n.helperActiveClass),d=r.style.userSelect,r.style.userSelect="none",i=getComputedStyle(r).gridTemplateRows.split(" ").map(_=>Number(_.replace("px",""))),r.addEventListener("mousemove",g),r.addEventListener("mouseup",h),document.addEventListener("mouseleave",h);let l=i[e];o=i[e+1]+l,s=u-l}function h(p){r.removeEventListener("mousemove",g),r.removeEventListener("mouseUp",h),document.removeEventListener("mouseleave",h),n.helperActiveClass!=null&&t.classList.remove(n.helperActiveClass),r.style.userSelect=d}function g(p){const{clientY:u}=p;let l=Math.min(Math.max(u-s,n.minHeight),o-n.minHeight);i[e]=l,i[e+1]=Math.max(o-l,0);let _=i.map(v=>v+"px").join(" ");r.style.gridTemplateRows=_}}function Jl(r,t){r.style.position="relative";let e=document.createElement("div");return t.helperClass!=null&&e.classList.add(t.helperClass),e.style.zIndex="1",e.style.position="absolute",r.appendChild(e),e}function Ql(r,t,e){return e.thickness=="auto"?(r.style.width=t,r.style.transform="translateX(100%)"):(/\d/.test(t)||(t="0px"),r.style.width=e.thickness,r.style.transform=`translateX(calc(50% + ${t} / 2))`),r.style.right="0",r.style.top=`calc(-${t} / 2)`,r.style.height=`calc(100% + ${t})`,r.style.cursor="ew-resize",r}function eu(r,t,e){return e.thickness=="auto"?(r.style.height=t,r.style.transform="translateY(100%)"):(/\d/.test(t)||(t="0px"),r.style.height=e.thickness,r.style.transform=`translateY(calc(50% + ${t} / 2))`),r.style.bottom="0",r.style.left=`calc(-${t} / 2)`,r.style.width=`calc(100% + ${t})`,r.style.cursor="ns-resize",r}class tu{constructor(t,e){this.menuSource=t.list.menuKind,this.item=e}}let ct;class dt{static set dragData(t){ct=t}static get dragData(){return ct}}var Jn,Qn,ei,ti;class ru{constructor(t,e){ee(this,Jn,Q(null));ee(this,Qn,Q(null));ee(this,ei,Q(!1));ee(this,ti,Q(!1));ge(this,"item");this.list=t,this.io=e}get draggingIndex(){return a(T(this,Jn))}set draggingIndex(t){V(T(this,Jn),H(t))}get dropIndex(){return a(T(this,Qn))}set dropIndex(t){V(T(this,Qn),H(t))}get isDraggingOver(){return a(T(this,ei))}set isDraggingOver(t){V(T(this,ei),H(t))}get isDroppingAbove(){return a(T(this,ti))}set isDroppingAbove(t){V(T(this,ti),H(t))}handleDragStart(t){return e=>{if(this.list.items[t].editName)return;this.draggingIndex=t,e.dataTransfer.effectAllowed="move",e.dataTransfer.cursor="move";const n=document.createElement("div");e.dataTransfer.setDragImage(n,0,0),ct=new tu(this,this.list.items[t]),n.remove()}}isAllowedToDrop(){return ct==null?!1:this.list.menuKind==ct.menuSource||this.io.allowDropEvent(ct)}isTopHalf(t,e){let n=null;for(;n=t.parentElement,!(n==null||t.classList.contains("item"));)t=n;const i=t.getBoundingClientRect();if(this.list.isOrientationVertical()){const s=i.top+i.height/2;return e.clientY<s}else{const s=i.left+i.width/2;return e.clientX<s}}handleDragOver(t){return e=>{this.isAllowedToDrop()&&(e.preventDefault(),e.dataTransfer.cursor="move",this.isDroppingAbove=this.isTopHalf(e.target,e),this.isDroppingAbove?this.dropIndex=t-1:this.dropIndex=t,this.isDraggingOver=!0)}}dragOverHandle(t){return e=>{this.isAllowedToDrop()&&(e.preventDefault(),this.dropIndex=t,this.isDraggingOver=!0)}}handleDragLeave(){return t=>{this.isDraggingOver=!1}}handleDrop(){return t=>{t.preventDefault(),this.isDroppingAbove=this.isTopHalf(t.target,t);const e=this.draggingIndex;if(ct.menuSource!=this.list.menuKind){const n=this.dropIndex;if(this.dropIndex=null,this.draggingIndex=null,this.list.items.some(i=>i==ct.item))return;this.io.dropEvent(n+1,ct),this.list.selectedItem=this.list.items[n+1],ct=null}else if(this.draggingIndex!==null&&this.dropIndex!==null&&this.draggingIndex!==this.dropIndex){const n=this.isDroppingAbove?this.dropIndex:this.dropIndex-1;this.dropIndex=null,this.draggingIndex=null;const[i]=this.list.items.splice(e,1);this.list.items.splice(n+1,0,i),this.io.reorderEvent(this.list.selectedItem)}this.resetDragState()}}handleDragEnd(){return t=>{this.resetDragState()}}doubleClickItemEvent(t){return e=>{this.list.doubleClickSelection&&(this.list.selectedItem=t,this.io.selectEvent(t))}}singleClickItemEvent(t){return e=>{this.list.doubleClickSelection||(this.list.selectedItem=t,this.io.selectEvent(t))}}resetDragState(){this.draggingIndex=null,this.dropIndex=null,this.isDraggingOver=!1}}Jn=new WeakMap,Qn=new WeakMap,ei=new WeakMap,ti=new WeakMap;function nu(r){r.stopPropagation()}function ca(r){r.stopPropagation(),r.preventDefault()}var iu=(r,t,e)=>{t().allowRenaming&&(r.preventDefault(),e.editName=!0)},su=r=>r.key==="Enter"&&r.target.blur(),au=ie('<div style="width:100%"><input class="rename-input svelte-1po5t46" type="text"></div>'),ou=ie('<div class="row overflow"><div><!> <div class="row" style="margin-left: auto;"><!></div></div></div> <div></div>',1),lu=ie('<div><div></div> <!> <div class="footer svelte-1po5t46"></div></div>');function Wi(r,t){Ae(t,!0);let e=Ee(t,"list",7),n=Ee(t,"io",7);n().removeLayer=f=>{e().selectedItem==f&&(e().selectedItem=null),e().items.splice(f,1)};const i=new ru(e(),n());Ne.GetSingleton();var s=lu(),o=re(s),d=ye(()=>i.dragOverHandle(-1)),c=ye(()=>i.handleDragLeave()),h=ye(()=>i.handleDrop()),g=ye(()=>i.handleDragEnd()),p=G(o,2);gt(p,18,()=>e().items,f=>f,(f,b,w)=>{var x=Se(),k=ce(x);_e(k,()=>t.rendering.doRenderFunction(b,a(w)),E=>{var M=ou(),L=ce(M),I=re(L);I.__contextmenu=[iu,e,b];var R=ye(()=>i.handleDragStart(a(w))),N=ye(()=>i.handleDragOver(a(w))),X=ye(()=>i.handleDragLeave()),S=ye(()=>i.handleDrop()),P=ye(()=>i.handleDragEnd()),y=ye(()=>i.doubleClickItemEvent(b));I.__dblclick=function(...se){var A;(A=a(y))==null||A.apply(this,se)};var B=ye(()=>i.singleClickItemEvent(b));I.__click=function(...se){var A;(A=a(B))==null||A.apply(this,se)};var ae=re(I);_e(ae,()=>b.editName&&e().allowRenaming,se=>{var A=au();A.__mousedown=[nu];var O=re(A);O.__keydown=[su],Yo(O),qe("blur",O,()=>{b.editName=!1}),at(O,()=>b.name,oe=>b.name=oe),$(se,A)},se=>{var A=Se(),O=ce(A);xt(O,()=>t.rendering.renderFunction,()=>b,()=>a(w)),$(se,A)});var W=G(ae,2);W.__mousedown=[ca],W.__click=[ca];var ue=re(W);_e(ue,()=>t.rendering.optionsRenderFunction!=null,se=>{var A=Se(),O=ce(A);xt(O,()=>t.rendering.optionsRenderFunction,()=>b,()=>a(w)),$(se,A)});var Y=G(L,2);be(()=>{$e(I,"draggable",!b.editName),We(I,`item 
        ${(a(w)==i.draggingIndex&&(i.draggingIndex==i.dropIndex||i.draggingIndex==i.dropIndex+1)?"not-changed":"")??""} 
        ${(i.draggingIndex!=null?"dragging":"")??""} 
        ${(b==i.list.selectedItem?"selected":"")??""}
         svelte-1po5t46`),We(Y,`drop-indicator ${(i.isDraggingOver&&a(w)==i.dropIndex&&i.draggingIndex!=i.dropIndex&&i.draggingIndex!=i.dropIndex+1?"active":"drop-indicator")??""} svelte-1po5t46`)}),qe("dragstart",I,function(...se){var A;(A=a(R))==null||A.apply(this,se)}),qe("dragover",I,function(...se){var A;(A=a(N))==null||A.apply(this,se)}),qe("dragleave",I,function(...se){var A;(A=a(X))==null||A.apply(this,se)}),qe("drop",I,function(...se){var A;(A=a(S))==null||A.apply(this,se)}),qe("dragend",I,function(...se){var A;(A=a(P))==null||A.apply(this,se)}),$(E,M)}),$(f,x)});var u=G(p,2),l=ye(()=>i.dragOverHandle(e().items.length-1)),_=ye(()=>i.handleDragLeave()),v=ye(()=>i.handleDrop());be(()=>{We(s,`container ${e().listType??""} svelte-1po5t46`),We(o,`${(i.isDraggingOver&&i.dropIndex==-1&&i.draggingIndex!=i.dropIndex&&i.draggingIndex!=i.dropIndex+1?"drop-indicator active":"drop-indicator")??""} svelte-1po5t46`)}),qe("dragover",o,function(...f){var b;(b=a(d))==null||b.apply(this,f)}),qe("dragleave",o,function(...f){var b;(b=a(c))==null||b.apply(this,f)}),qe("drop",o,function(...f){var b;(b=a(h))==null||b.apply(this,f)}),qe("dragend",o,function(...f){var b;(b=a(g))==null||b.apply(this,f)}),qe("dragover",u,function(...f){var b;(b=a(l))==null||b.apply(this,f)}),qe("dragleave",u,function(...f){var b;(b=a(_))==null||b.apply(this,f)}),qe("drop",u,function(...f){var b;(b=a(v))==null||b.apply(this,f)}),$(r,s),Te()}He(["contextmenu","dblclick","click","mousedown","keydown"]);let rs=null;var ri,ni;const Hs=class Hs{constructor(){ee(this,ri,Q(null));ee(this,ni,Q(""));ge(this,"callback",null)}get modal(){return a(T(this,ri))}set modal(t){V(T(this,ri),H(t))}get message(){return a(T(this,ni))}set message(t){V(T(this,ni),H(t))}static GetSingleton(){return rs==null&&(rs=new Hs),rs}Prompt(t,e){this.message=t,this.callback=e,this.modal&&this.modal.open()}CancelEvent(){return t=>{this.modal&&this.modal.close()}}ConfirmEvent(){return t=>{this.modal&&this.modal.close(),this.callback&&this.callback()}}};ri=new WeakMap,ni=new WeakMap;let kt=Hs;var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ja(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ha={exports:{}};(function(r,t){(function(e,n){n()})(yt,function(){function e(h,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,g,p){var u=new XMLHttpRequest;u.open("GET",h),u.responseType="blob",u.onload=function(){c(u.response,g,p)},u.onerror=function(){console.error("could not download file")},u.send()}function i(h){var g=new XMLHttpRequest;g.open("HEAD",h,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function s(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(g)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof yt=="object"&&yt.global===yt?yt:void 0,d=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(h,g,p){var u=o.URL||o.webkitURL,l=document.createElement("a");g=g||h.name||"download",l.download=g,l.rel="noopener",typeof h=="string"?(l.href=h,l.origin===location.origin?s(l):i(l.href)?n(h,g,p):s(l,l.target="_blank")):(l.href=u.createObjectURL(h),setTimeout(function(){u.revokeObjectURL(l.href)},4e4),setTimeout(function(){s(l)},0))}:"msSaveOrOpenBlob"in navigator?function(h,g,p){if(g=g||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(e(h,p),g);else if(i(h))n(h,g,p);else{var u=document.createElement("a");u.href=h,u.target="_blank",setTimeout(function(){s(u)})}}:function(h,g,p,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof h=="string")return n(h,g,p);var l=h.type==="application/octet-stream",_=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||l&&_||d)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var x=f.result;x=v?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=x:location=x,u=null},f.readAsDataURL(h)}else{var b=o.URL||o.webkitURL,w=b.createObjectURL(h);u?u.location=w:location.href=w,u=null,setTimeout(function(){b.revokeObjectURL(w)},4e4)}});o.saveAs=c.saveAs=c,r.exports=c})})(Ha);var Xa=Ha.exports;function wi(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wa={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,t){(function(e){r.exports=e()})(function(){return function e(n,i,s){function o(h,g){if(!i[h]){if(!n[h]){var p=typeof wi=="function"&&wi;if(!g&&p)return p(h,!0);if(d)return d(h,!0);var u=new Error("Cannot find module '"+h+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[h]={exports:{}};n[h][0].call(l.exports,function(_){var v=n[h][1][_];return o(v||_)},l,l.exports,e,n,i,s)}return i[h].exports}for(var d=typeof wi=="function"&&wi,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(e,n,i){var s=e("./utils"),o=e("./support"),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var h,g,p,u,l,_,v,f=[],b=0,w=c.length,x=w,k=s.getTypeOf(c)!=="string";b<c.length;)x=w-b,p=k?(h=c[b++],g=b<w?c[b++]:0,b<w?c[b++]:0):(h=c.charCodeAt(b++),g=b<w?c.charCodeAt(b++):0,b<w?c.charCodeAt(b++):0),u=h>>2,l=(3&h)<<4|g>>4,_=1<x?(15&g)<<2|p>>6:64,v=2<x?63&p:64,f.push(d.charAt(u)+d.charAt(l)+d.charAt(_)+d.charAt(v));return f.join("")},i.decode=function(c){var h,g,p,u,l,_,v=0,f=0,b="data:";if(c.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var w,x=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===d.charAt(64)&&x--,c.charAt(c.length-2)===d.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=o.uint8array?new Uint8Array(0|x):new Array(0|x);v<c.length;)h=d.indexOf(c.charAt(v++))<<2|(u=d.indexOf(c.charAt(v++)))>>4,g=(15&u)<<4|(l=d.indexOf(c.charAt(v++)))>>2,p=(3&l)<<6|(_=d.indexOf(c.charAt(v++))),w[f++]=h,l!==64&&(w[f++]=g),_!==64&&(w[f++]=p);return w}},{"./support":30,"./utils":32}],2:[function(e,n,i){var s=e("./external"),o=e("./stream/DataWorker"),d=e("./stream/Crc32Probe"),c=e("./stream/DataLengthProbe");function h(g,p,u,l,_){this.compressedSize=g,this.uncompressedSize=p,this.crc32=u,this.compression=l,this.compressedContent=_}h.prototype={getContentWorker:function(){var g=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return g.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),g},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(g,p,u){return g.pipe(new d).pipe(new c("uncompressedSize")).pipe(p.compressWorker(u)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},n.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,i){var s=e("./utils"),o=function(){for(var d,c=[],h=0;h<256;h++){d=h;for(var g=0;g<8;g++)d=1&d?3988292384^d>>>1:d>>>1;c[h]=d}return c}();n.exports=function(d,c){return d!==void 0&&d.length?s.getTypeOf(d)!=="string"?function(h,g,p,u){var l=o,_=u+p;h^=-1;for(var v=u;v<_;v++)h=h>>>8^l[255&(h^g[v])];return-1^h}(0|c,d,d.length,0):function(h,g,p,u){var l=o,_=u+p;h^=-1;for(var v=u;v<_;v++)h=h>>>8^l[255&(h^g.charCodeAt(v))];return-1^h}(0|c,d,d.length,0):0}},{"./utils":32}],5:[function(e,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,n,i){var s=null;s=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:s}},{lie:37}],7:[function(e,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),d=e("./utils"),c=e("./stream/GenericWorker"),h=s?"uint8array":"array";function g(p,u){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=u,this.meta={}}i.magic="\b\0",d.inherits(g,c),g.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(d.transformTo(h,p.data),!1)},g.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},g.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},g.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(u){p.push({data:u,meta:p.meta})}},i.compressWorker=function(p){return new g("Deflate",p)},i.uncompressWorker=function(){return new g("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,i){function s(l,_){var v,f="";for(v=0;v<_;v++)f+=String.fromCharCode(255&l),l>>>=8;return f}function o(l,_,v,f,b,w){var x,k,E=l.file,M=l.compression,L=w!==h.utf8encode,I=d.transformTo("string",w(E.name)),R=d.transformTo("string",h.utf8encode(E.name)),N=E.comment,X=d.transformTo("string",w(N)),S=d.transformTo("string",h.utf8encode(N)),P=R.length!==E.name.length,y=S.length!==N.length,B="",ae="",W="",ue=E.dir,Y=E.date,se={crc32:0,compressedSize:0,uncompressedSize:0};_&&!v||(se.crc32=l.crc32,se.compressedSize=l.compressedSize,se.uncompressedSize=l.uncompressedSize);var A=0;_&&(A|=8),L||!P&&!y||(A|=2048);var O=0,oe=0;ue&&(O|=16),b==="UNIX"?(oe=798,O|=function(Z,we){var fe=Z;return Z||(fe=we?16893:33204),(65535&fe)<<16}(E.unixPermissions,ue)):(oe=20,O|=function(Z){return 63&(Z||0)}(E.dosPermissions)),x=Y.getUTCHours(),x<<=6,x|=Y.getUTCMinutes(),x<<=5,x|=Y.getUTCSeconds()/2,k=Y.getUTCFullYear()-1980,k<<=4,k|=Y.getUTCMonth()+1,k<<=5,k|=Y.getUTCDate(),P&&(ae=s(1,1)+s(g(I),4)+R,B+="up"+s(ae.length,2)+ae),y&&(W=s(1,1)+s(g(X),4)+S,B+="uc"+s(W.length,2)+W);var K="";return K+=`
\0`,K+=s(A,2),K+=M.magic,K+=s(x,2),K+=s(k,2),K+=s(se.crc32,4),K+=s(se.compressedSize,4),K+=s(se.uncompressedSize,4),K+=s(I.length,2),K+=s(B.length,2),{fileRecord:p.LOCAL_FILE_HEADER+K+I+B,dirRecord:p.CENTRAL_FILE_HEADER+s(oe,2)+K+s(X.length,2)+"\0\0\0\0"+s(O,4)+s(f,4)+I+B+X}}var d=e("../utils"),c=e("../stream/GenericWorker"),h=e("../utf8"),g=e("../crc32"),p=e("../signature");function u(l,_,v,f){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=v,this.encodeFileName=f,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}d.inherits(u,c),u.prototype.push=function(l){var _=l.meta.percent||0,v=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,c.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:v?(_+100*(v-f-1))/v:100}}))},u.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var _=this.streamFiles&&!l.file.dir;if(_){var v=o(l,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(l){this.accumulate=!1;var _=this.streamFiles&&!l.file.dir,v=o(l,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),_)this.push({data:function(f){return p.DATA_DESCRIPTOR+s(f.crc32,4)+s(f.compressedSize,4)+s(f.uncompressedSize,4)}(l),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var l=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var v=this.bytesWritten-l,f=function(b,w,x,k,E){var M=d.transformTo("string",E(k));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(b,2)+s(b,2)+s(w,4)+s(x,4)+s(M.length,2)+M}(this.dirRecords.length,v,l,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(l){this._sources.push(l);var _=this;return l.on("data",function(v){_.processChunk(v)}),l.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),l.on("error",function(v){_.error(v)}),this},u.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(l){var _=this._sources;if(!c.prototype.error.call(this,l))return!1;for(var v=0;v<_.length;v++)try{_[v].error(l)}catch{}return!0},u.prototype.lock=function(){c.prototype.lock.call(this);for(var l=this._sources,_=0;_<l.length;_++)l[_].lock()},n.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,i){var s=e("../compressions"),o=e("./ZipFileWorker");i.generateWorker=function(d,c,h){var g=new o(c.streamFiles,h,c.platform,c.encodeFileName),p=0;try{d.forEach(function(u,l){p++;var _=function(w,x){var k=w||x,E=s[k];if(!E)throw new Error(k+" is not a valid compression method !");return E}(l.options.compression,c.compression),v=l.options.compressionOptions||c.compressionOptions||{},f=l.dir,b=l.date;l._compressWorker(_,v).withStreamInfo("file",{name:u,dir:f,date:b,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(g)}),g.entriesCount=p}catch(u){g.error(u)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var d in this)typeof this[d]!="function"&&(o[d]=this[d]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,d){return new s().loadAsync(o,d)},s.external=e("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,i){var s=e("./utils"),o=e("./external"),d=e("./utf8"),c=e("./zipEntries"),h=e("./stream/Crc32Probe"),g=e("./nodejsUtils");function p(u){return new o.Promise(function(l,_){var v=u.decompressed.getContentWorker().pipe(new h);v.on("error",function(f){_(f)}).on("end",function(){v.streamInfo.crc32!==u.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}n.exports=function(u,l){var _=this;return l=s.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:d.utf8decode}),g.isNode&&g.isStream(u)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",u,!0,l.optimizedBinaryString,l.base64).then(function(v){var f=new c(l);return f.load(v),f}).then(function(v){var f=[o.Promise.resolve(v)],b=v.files;if(l.checkCRC32)for(var w=0;w<b.length;w++)f.push(p(b[w]));return o.Promise.all(f)}).then(function(v){for(var f=v.shift(),b=f.files,w=0;w<b.length;w++){var x=b[w],k=x.fileNameStr,E=s.resolve(x.fileNameStr);_.file(E,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:l.createFolders}),x.dir||(_.file(E).unsafeOriginalName=k)}return f.zipComment.length&&(_.comment=f.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,i){var s=e("../utils"),o=e("../stream/GenericWorker");function d(c,h){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(h)}s.inherits(d,o),d.prototype._bindStream=function(c){var h=this;(this._stream=c).pause(),c.on("data",function(g){h.push({data:g,meta:{percent:0}})}).on("error",function(g){h.isPaused?this.generatedError=g:h.error(g)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},d.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=d},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,i){var s=e("readable-stream").Readable;function o(d,c,h){s.call(this,c),this._helper=d;var g=this;d.on("data",function(p,u){g.push(p)||g._helper.pause(),h&&h(u)}).on("error",function(p){g.emit("error",p)}).on("end",function(){g.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,n,i){function s(E,M,L){var I,R=d.getTypeOf(M),N=d.extend(L||{},g);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&16384&N.unixPermissions&&(N.dir=!0),N.dosPermissions&&16&N.dosPermissions&&(N.dir=!0),N.dir&&(E=b(E)),N.createFolders&&(I=f(E))&&w.call(this,I,!0);var X=R==="string"&&N.binary===!1&&N.base64===!1;L&&L.binary!==void 0||(N.binary=!X),(M instanceof p&&M.uncompressedSize===0||N.dir||!M||M.length===0)&&(N.base64=!1,N.binary=!0,M="",N.compression="STORE",R="string");var S=null;S=M instanceof p||M instanceof c?M:_.isNode&&_.isStream(M)?new v(E,M):d.prepareContent(E,M,N.binary,N.optimizedBinaryString,N.base64);var P=new u(E,S,N);this.files[E]=P}var o=e("./utf8"),d=e("./utils"),c=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),g=e("./defaults"),p=e("./compressedObject"),u=e("./zipObject"),l=e("./generate"),_=e("./nodejsUtils"),v=e("./nodejs/NodejsStreamInputAdapter"),f=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var M=E.lastIndexOf("/");return 0<M?E.substring(0,M):""},b=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},w=function(E,M){return M=M!==void 0?M:g.createFolders,E=b(E),this.files[E]||s.call(this,E,null,{dir:!0,createFolders:M}),this.files[E]};function x(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var M,L,I;for(M in this.files)I=this.files[M],(L=M.slice(this.root.length,M.length))&&M.slice(0,this.root.length)===this.root&&E(L,I)},filter:function(E){var M=[];return this.forEach(function(L,I){E(L,I)&&M.push(I)}),M},file:function(E,M,L){if(arguments.length!==1)return E=this.root+E,s.call(this,E,M,L),this;if(x(E)){var I=E;return this.filter(function(N,X){return!X.dir&&I.test(N)})}var R=this.files[this.root+E];return R&&!R.dir?R:null},folder:function(E){if(!E)return this;if(x(E))return this.filter(function(R,N){return N.dir&&E.test(R)});var M=this.root+E,L=w.call(this,M),I=this.clone();return I.root=L.name,I},remove:function(E){E=this.root+E;var M=this.files[E];if(M||(E.slice(-1)!=="/"&&(E+="/"),M=this.files[E]),M&&!M.dir)delete this.files[E];else for(var L=this.filter(function(R,N){return N.name.slice(0,E.length)===E}),I=0;I<L.length;I++)delete this.files[L[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var M,L={};try{if((L=d.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");d.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var I=L.comment||this.comment||"";M=l.generateWorker(this,L,I)}catch(R){(M=new c("error")).error(R)}return new h(M,L.type||"string",L.mimeType)},generateAsync:function(E,M){return this.generateInternalStream(E).accumulate(M)},generateNodeStream:function(E,M){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(M)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,i){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,i){var s=e("./DataReader");function o(d){s.call(this,d);for(var c=0;c<this.data.length;c++)d[c]=255&d[c]}e("../utils").inherits(o,s),o.prototype.byteAt=function(d){return this.data[this.zero+d]},o.prototype.lastIndexOfSignature=function(d){for(var c=d.charCodeAt(0),h=d.charCodeAt(1),g=d.charCodeAt(2),p=d.charCodeAt(3),u=this.length-4;0<=u;--u)if(this.data[u]===c&&this.data[u+1]===h&&this.data[u+2]===g&&this.data[u+3]===p)return u-this.zero;return-1},o.prototype.readAndCheckSignature=function(d){var c=d.charCodeAt(0),h=d.charCodeAt(1),g=d.charCodeAt(2),p=d.charCodeAt(3),u=this.readData(4);return c===u[0]&&h===u[1]&&g===u[2]&&p===u[3]},o.prototype.readData=function(d){if(this.checkOffset(d),d===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,n,i){var s=e("../utils");function o(d){this.data=d,this.length=d.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(d){this.checkIndex(this.index+d)},checkIndex:function(d){if(this.length<this.zero+d||d<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+d+"). Corrupted zip ?")},setIndex:function(d){this.checkIndex(d),this.index=d},skip:function(d){this.setIndex(this.index+d)},byteAt:function(){},readInt:function(d){var c,h=0;for(this.checkOffset(d),c=this.index+d-1;c>=this.index;c--)h=(h<<8)+this.byteAt(c);return this.index+=d,h},readString:function(d){return s.transformTo("string",this.readData(d))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var d=this.readInt(4);return new Date(Date.UTC(1980+(d>>25&127),(d>>21&15)-1,d>>16&31,d>>11&31,d>>5&63,(31&d)<<1))}},n.exports=o},{"../utils":32}],19:[function(e,n,i){var s=e("./Uint8ArrayReader");function o(d){s.call(this,d)}e("../utils").inherits(o,s),o.prototype.readData=function(d){this.checkOffset(d);var c=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,i){var s=e("./DataReader");function o(d){s.call(this,d)}e("../utils").inherits(o,s),o.prototype.byteAt=function(d){return this.data.charCodeAt(this.zero+d)},o.prototype.lastIndexOfSignature=function(d){return this.data.lastIndexOf(d)-this.zero},o.prototype.readAndCheckSignature=function(d){return d===this.readData(4)},o.prototype.readData=function(d){this.checkOffset(d);var c=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,n,i){var s=e("./ArrayReader");function o(d){s.call(this,d)}e("../utils").inherits(o,s),o.prototype.readData=function(d){if(this.checkOffset(d),d===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+d);return this.index+=d,c},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,i){var s=e("../utils"),o=e("../support"),d=e("./ArrayReader"),c=e("./StringReader"),h=e("./NodeBufferReader"),g=e("./Uint8ArrayReader");n.exports=function(p){var u=s.getTypeOf(p);return s.checkSupport(u),u!=="string"||o.uint8array?u==="nodebuffer"?new h(p):o.uint8array?new g(s.transformTo("uint8array",p)):new d(s.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,i){var s=e("./GenericWorker"),o=e("../utils");function d(c){s.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(d,s),d.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},n.exports=d},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,i){var s=e("./GenericWorker"),o=e("../crc32");function d(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(d,s),d.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=d},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,i){var s=e("../utils"),o=e("./GenericWorker");function d(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(d,o),d.prototype.processChunk=function(c){if(c){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+c.data.length}o.prototype.processChunk.call(this,c)},n.exports=d},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,i){var s=e("../utils"),o=e("./GenericWorker");function d(c){o.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(g){h.dataIsReady=!0,h.data=g,h.max=g&&g.length||0,h.type=s.getTypeOf(g),h.isPaused||h._tickAndRepeat()},function(g){h.error(g)})}s.inherits(d,o),d.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,h);break;case"uint8array":c=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":c=this.data.slice(this.index,h)}return this.index=h,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=d},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,d){return this._listeners[o].push(d),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,d){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,d)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var d=this;return o.on("data",function(c){d.processChunk(c)}),o.on("end",function(){d.end()}),o.on("error",function(c){d.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,d){return this.extraStreamInfo[o]=d,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=s},{}],29:[function(e,n,i){var s=e("../utils"),o=e("./ConvertWorker"),d=e("./GenericWorker"),c=e("../base64"),h=e("../support"),g=e("../external"),p=null;if(h.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function u(_,v){return new g.Promise(function(f,b){var w=[],x=_._internalType,k=_._outputType,E=_._mimeType;_.on("data",function(M,L){w.push(M),v&&v(L)}).on("error",function(M){w=[],b(M)}).on("end",function(){try{var M=function(L,I,R){switch(L){case"blob":return s.newBlob(s.transformTo("arraybuffer",I),R);case"base64":return c.encode(I);default:return s.transformTo(L,I)}}(k,function(L,I){var R,N=0,X=null,S=0;for(R=0;R<I.length;R++)S+=I[R].length;switch(L){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(X=new Uint8Array(S),R=0;R<I.length;R++)X.set(I[R],N),N+=I[R].length;return X;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+L+"'")}}(x,w),E);f(M)}catch(L){b(L)}w=[]}).resume()})}function l(_,v,f){var b=v;switch(v){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=v,this._mimeType=f,s.checkSupport(b),this._worker=_.pipe(new o(b)),_.lock()}catch(w){this._worker=new d("error"),this._worker.error(w)}}l.prototype={accumulate:function(_){return u(this,_)},on:function(_,v){var f=this;return _==="data"?this._worker.on(_,function(b){v.call(f,b.data,b.meta)}):this._worker.on(_,function(){s.delay(v,arguments,f)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},_)}},n.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,i){for(var s=e("./utils"),o=e("./support"),d=e("./nodejsUtils"),c=e("./stream/GenericWorker"),h=new Array(256),g=0;g<256;g++)h[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;h[254]=h[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function u(){c.call(this,"utf-8 encode")}i.utf8encode=function(l){return o.nodebuffer?d.newBufferFrom(l,"utf-8"):function(_){var v,f,b,w,x,k=_.length,E=0;for(w=0;w<k;w++)(64512&(f=_.charCodeAt(w)))==55296&&w+1<k&&(64512&(b=_.charCodeAt(w+1)))==56320&&(f=65536+(f-55296<<10)+(b-56320),w++),E+=f<128?1:f<2048?2:f<65536?3:4;for(v=o.uint8array?new Uint8Array(E):new Array(E),w=x=0;x<E;w++)(64512&(f=_.charCodeAt(w)))==55296&&w+1<k&&(64512&(b=_.charCodeAt(w+1)))==56320&&(f=65536+(f-55296<<10)+(b-56320),w++),f<128?v[x++]=f:(f<2048?v[x++]=192|f>>>6:(f<65536?v[x++]=224|f>>>12:(v[x++]=240|f>>>18,v[x++]=128|f>>>12&63),v[x++]=128|f>>>6&63),v[x++]=128|63&f);return v}(l)},i.utf8decode=function(l){return o.nodebuffer?s.transformTo("nodebuffer",l).toString("utf-8"):function(_){var v,f,b,w,x=_.length,k=new Array(2*x);for(v=f=0;v<x;)if((b=_[v++])<128)k[f++]=b;else if(4<(w=h[b]))k[f++]=65533,v+=w-1;else{for(b&=w===2?31:w===3?15:7;1<w&&v<x;)b=b<<6|63&_[v++],w--;1<w?k[f++]=65533:b<65536?k[f++]=b:(b-=65536,k[f++]=55296|b>>10&1023,k[f++]=56320|1023&b)}return k.length!==f&&(k.subarray?k=k.subarray(0,f):k.length=f),s.applyFromCharCode(k)}(l=s.transformTo(o.uint8array?"uint8array":"array",l))},s.inherits(p,c),p.prototype.processChunk=function(l){var _=s.transformTo(o.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=_;(_=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),_.set(v,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var f=function(w,x){var k;for((x=x||w.length)>w.length&&(x=w.length),k=x-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?x:k+h[w[k]]>x?k:x}(_),b=_;f!==_.length&&(o.uint8array?(b=_.subarray(0,f),this.leftOver=_.subarray(f,_.length)):(b=_.slice(0,f),this.leftOver=_.slice(f,_.length))),this.push({data:i.utf8decode(b),meta:l.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(u,c),u.prototype.processChunk=function(l){this.push({data:i.utf8encode(l.data),meta:l.meta})},i.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,i){var s=e("./support"),o=e("./base64"),d=e("./nodejsUtils"),c=e("./external");function h(v){return v}function g(v,f){for(var b=0;b<v.length;++b)f[b]=255&v.charCodeAt(b);return f}e("setimmediate"),i.newBlob=function(v,f){i.checkSupport("blob");try{return new Blob([v],{type:f})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(v),b.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(v,f,b){var w=[],x=0,k=v.length;if(k<=b)return String.fromCharCode.apply(null,v);for(;x<k;)f==="array"||f==="nodebuffer"?w.push(String.fromCharCode.apply(null,v.slice(x,Math.min(x+b,k)))):w.push(String.fromCharCode.apply(null,v.subarray(x,Math.min(x+b,k)))),x+=b;return w.join("")},stringifyByChar:function(v){for(var f="",b=0;b<v.length;b++)f+=String.fromCharCode(v[b]);return f},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,d.allocBuffer(1)).length===1}catch{return!1}}()}};function u(v){var f=65536,b=i.getTypeOf(v),w=!0;if(b==="uint8array"?w=p.applyCanBeUsed.uint8array:b==="nodebuffer"&&(w=p.applyCanBeUsed.nodebuffer),w)for(;1<f;)try{return p.stringifyByChunk(v,b,f)}catch{f=Math.floor(f/2)}return p.stringifyByChar(v)}function l(v,f){for(var b=0;b<v.length;b++)f[b]=v[b];return f}i.applyFromCharCode=u;var _={};_.string={string:h,array:function(v){return g(v,new Array(v.length))},arraybuffer:function(v){return _.string.uint8array(v).buffer},uint8array:function(v){return g(v,new Uint8Array(v.length))},nodebuffer:function(v){return g(v,d.allocBuffer(v.length))}},_.array={string:u,array:h,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(v)}},_.arraybuffer={string:function(v){return u(new Uint8Array(v))},array:function(v){return l(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:h,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return d.newBufferFrom(new Uint8Array(v))}},_.uint8array={string:u,array:function(v){return l(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:h,nodebuffer:function(v){return d.newBufferFrom(v)}},_.nodebuffer={string:u,array:function(v){return l(v,new Array(v.length))},arraybuffer:function(v){return _.nodebuffer.uint8array(v).buffer},uint8array:function(v){return l(v,new Uint8Array(v.length))},nodebuffer:h},i.transformTo=function(v,f){if(f=f||"",!v)return f;i.checkSupport(v);var b=i.getTypeOf(f);return _[b][v](f)},i.resolve=function(v){for(var f=v.split("/"),b=[],w=0;w<f.length;w++){var x=f[w];x==="."||x===""&&w!==0&&w!==f.length-1||(x===".."?b.pop():b.push(x))}return b.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&d.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var f,b,w="";for(b=0;b<(v||"").length;b++)w+="\\x"+((f=v.charCodeAt(b))<16?"0":"")+f.toString(16).toUpperCase();return w},i.delay=function(v,f,b){setImmediate(function(){v.apply(b||null,f||[])})},i.inherits=function(v,f){function b(){}b.prototype=f.prototype,v.prototype=new b},i.extend=function(){var v,f,b={};for(v=0;v<arguments.length;v++)for(f in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],f)&&b[f]===void 0&&(b[f]=arguments[v][f]);return b},i.prepareContent=function(v,f,b,w,x){return c.Promise.resolve(f).then(function(k){return s.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(E,M){var L=new FileReader;L.onload=function(I){E(I.target.result)},L.onerror=function(I){M(I.target.error)},L.readAsArrayBuffer(k)}):k}).then(function(k){var E=i.getTypeOf(k);return E?(E==="arraybuffer"?k=i.transformTo("uint8array",k):E==="string"&&(x?k=o.decode(k):b&&w!==!0&&(k=function(M){return g(M,s.uint8array?new Uint8Array(M.length):new Array(M.length))}(k))),k):c.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,i){var s=e("./reader/readerFor"),o=e("./utils"),d=e("./signature"),c=e("./zipEntry"),h=e("./support");function g(p){this.files=[],this.loadOptions=p}g.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var u=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(u)+", expected "+o.pretty(p)+")")}},isSignature:function(p,u){var l=this.reader.index;this.reader.setIndex(p);var _=this.reader.readString(4)===u;return this.reader.setIndex(l),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),u=h.uint8array?"uint8array":"array",l=o.transformTo(u,p);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,u,l,_=this.zip64EndOfCentralSize-44;0<_;)p=this.reader.readInt(2),u=this.reader.readInt(4),l=this.reader.readData(u),this.zip64ExtensibleData[p]={id:p,length:u,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,u;for(p=0;p<this.files.length;p++)u=this.files[p],this.reader.setIndex(u.localHeaderOffset),this.checkSignature(d.LOCAL_FILE_HEADER),u.readLocalPart(this.reader),u.handleUTF8(),u.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(d.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(d.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,d.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var u=p;if(this.checkSignature(d.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,d.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var _=u-l;if(0<_)this.isSignature(u,d.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=g},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,i){var s=e("./reader/readerFor"),o=e("./utils"),d=e("./compressedObject"),c=e("./crc32"),h=e("./utf8"),g=e("./compressions"),p=e("./support");function u(l,_){this.options=l,this.loadOptions=_}u.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var _,v;if(l.skip(22),this.fileNameLength=l.readInt(2),v=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=function(f){for(var b in g)if(Object.prototype.hasOwnProperty.call(g,b)&&g[b].magic===f)return g[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new d(this.compressedSize,this.uncompressedSize,this.crc32,_,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var _=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(_),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var _,v,f,b=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<b;)_=l.readInt(2),v=l.readInt(2),f=l.readData(v),this.extraFields[_]={id:_,length:v,value:f};l.setIndex(b)},handleUTF8:function(){var l=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var v=o.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var b=o.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var _=s(l.value);return _.readInt(1)!==1||c(this.fileName)!==_.readInt(4)?null:h.utf8decode(_.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var _=s(l.value);return _.readInt(1)!==1||c(this.fileComment)!==_.readInt(4)?null:h.utf8decode(_.readData(l.length-5))}return null}},n.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,i){function s(_,v,f){this.name=_,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=v,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var o=e("./stream/StreamHelper"),d=e("./stream/DataWorker"),c=e("./utf8"),h=e("./compressedObject"),g=e("./stream/GenericWorker");s.prototype={internalStream:function(_){var v=null,f="string";try{if(!_)throw new Error("No output type specified.");var b=(f=_.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),v=this._decompressWorker();var w=!this._dataBinary;w&&!b&&(v=v.pipe(new c.Utf8EncodeWorker)),!w&&b&&(v=v.pipe(new c.Utf8DecodeWorker))}catch(x){(v=new g("error")).error(x)}return new o(v,f,"")},async:function(_,v){return this.internalStream(_).accumulate(v)},nodeStream:function(_,v){return this.internalStream(_||"nodebuffer").toNodejsStream(v)},_compressWorker:function(_,v){if(this._data instanceof h&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new c.Utf8EncodeWorker)),h.createWorkerFrom(f,_,v)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof g?this._data:new d(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<p.length;l++)s.prototype[p[l]]=u;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,i){(function(s){var o,d,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var h=0,g=new c(_),p=s.document.createTextNode("");g.observe(p,{characterData:!0}),o=function(){p.data=h=++h%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){_(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(_,0)};else{var u=new s.MessageChannel;u.port1.onmessage=_,o=function(){u.port2.postMessage(0)}}var l=[];function _(){var v,f;d=!0;for(var b=l.length;b;){for(f=l,l=[],v=-1;++v<b;)f[v]();b=l.length}d=!1}n.exports=function(v){l.push(v)!==1||d||o()}}).call(this,typeof yt<"u"?yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,i){var s=e("immediate");function o(){}var d={},c=["REJECTED"],h=["FULFILLED"],g=["PENDING"];function p(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,b!==o&&v(this,b)}function u(b,w,x){this.promise=b,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function l(b,w,x){s(function(){var k;try{k=w(x)}catch(E){return d.reject(b,E)}k===b?d.reject(b,new TypeError("Cannot resolve promise with itself")):d.resolve(b,k)})}function _(b){var w=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof w=="function")return function(){w.apply(b,arguments)}}function v(b,w){var x=!1;function k(L){x||(x=!0,d.reject(b,L))}function E(L){x||(x=!0,d.resolve(b,L))}var M=f(function(){w(E,k)});M.status==="error"&&k(M.value)}function f(b,w){var x={};try{x.value=b(w),x.status="success"}catch(k){x.status="error",x.value=k}return x}(n.exports=p).prototype.finally=function(b){if(typeof b!="function")return this;var w=this.constructor;return this.then(function(x){return w.resolve(b()).then(function(){return x})},function(x){return w.resolve(b()).then(function(){throw x})})},p.prototype.catch=function(b){return this.then(null,b)},p.prototype.then=function(b,w){if(typeof b!="function"&&this.state===h||typeof w!="function"&&this.state===c)return this;var x=new this.constructor(o);return this.state!==g?l(x,this.state===h?b:w,this.outcome):this.queue.push(new u(x,b,w)),x},u.prototype.callFulfilled=function(b){d.resolve(this.promise,b)},u.prototype.otherCallFulfilled=function(b){l(this.promise,this.onFulfilled,b)},u.prototype.callRejected=function(b){d.reject(this.promise,b)},u.prototype.otherCallRejected=function(b){l(this.promise,this.onRejected,b)},d.resolve=function(b,w){var x=f(_,w);if(x.status==="error")return d.reject(b,x.value);var k=x.value;if(k)v(b,k);else{b.state=h,b.outcome=w;for(var E=-1,M=b.queue.length;++E<M;)b.queue[E].callFulfilled(w)}return b},d.reject=function(b,w){b.state=c,b.outcome=w;for(var x=-1,k=b.queue.length;++x<k;)b.queue[x].callRejected(w);return b},p.resolve=function(b){return b instanceof this?b:d.resolve(new this(o),b)},p.reject=function(b){var w=new this(o);return d.reject(w,b)},p.all=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,k=!1;if(!x)return this.resolve([]);for(var E=new Array(x),M=0,L=-1,I=new this(o);++L<x;)R(b[L],L);return I;function R(N,X){w.resolve(N).then(function(S){E[X]=S,++M!==x||k||(k=!0,d.resolve(I,E))},function(S){k||(k=!0,d.reject(I,S))})}},p.race=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,k=!1;if(!x)return this.resolve([]);for(var E=-1,M=new this(o);++E<x;)L=b[E],w.resolve(L).then(function(I){k||(k=!0,d.resolve(M,I))},function(I){k||(k=!0,d.reject(M,I))});var L;return M}},{immediate:36}],38:[function(e,n,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,i){var s=e("./zlib/deflate"),o=e("./utils/common"),d=e("./utils/strings"),c=e("./zlib/messages"),h=e("./zlib/zstream"),g=Object.prototype.toString,p=0,u=-1,l=0,_=8;function v(b){if(!(this instanceof v))return new v(b);this.options=o.assign({level:u,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},b||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var x=s.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(x!==p)throw new Error(c[x]);if(w.header&&s.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?d.string2buf(w.dictionary):g.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(x=s.deflateSetDictionary(this.strm,k))!==p)throw new Error(c[x]);this._dict_set=!0}}function f(b,w){var x=new v(w);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}v.prototype.push=function(b,w){var x,k,E=this.strm,M=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof b=="string"?E.input=d.string2buf(b):g.call(b)==="[object ArrayBuffer]"?E.input=new Uint8Array(b):E.input=b,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new o.Buf8(M),E.next_out=0,E.avail_out=M),(x=s.deflate(E,k))!==1&&x!==p)return this.onEnd(x),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(d.buf2binstring(o.shrinkBuf(E.output,E.next_out))):this.onData(o.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&x!==1);return k===4?(x=s.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===p):k!==2||(this.onEnd(p),!(E.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},i.Deflate=v,i.deflate=f,i.deflateRaw=function(b,w){return(w=w||{}).raw=!0,f(b,w)},i.gzip=function(b,w){return(w=w||{}).gzip=!0,f(b,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,i){var s=e("./zlib/inflate"),o=e("./utils/common"),d=e("./utils/strings"),c=e("./zlib/constants"),h=e("./zlib/messages"),g=e("./zlib/zstream"),p=e("./zlib/gzheader"),u=Object.prototype.toString;function l(v){if(!(this instanceof l))return new l(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||v&&v.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&!(15&f.windowBits)&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var b=s.inflateInit2(this.strm,f.windowBits);if(b!==c.Z_OK)throw new Error(h[b]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function _(v,f){var b=new l(f);if(b.push(v,!0),b.err)throw b.msg||h[b.err];return b.result}l.prototype.push=function(v,f){var b,w,x,k,E,M,L=this.strm,I=this.options.chunkSize,R=this.options.dictionary,N=!1;if(this.ended)return!1;w=f===~~f?f:f===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof v=="string"?L.input=d.binstring2buf(v):u.call(v)==="[object ArrayBuffer]"?L.input=new Uint8Array(v):L.input=v,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new o.Buf8(I),L.next_out=0,L.avail_out=I),(b=s.inflate(L,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&R&&(M=typeof R=="string"?d.string2buf(R):u.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,b=s.inflateSetDictionary(this.strm,M)),b===c.Z_BUF_ERROR&&N===!0&&(b=c.Z_OK,N=!1),b!==c.Z_STREAM_END&&b!==c.Z_OK)return this.onEnd(b),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&b!==c.Z_STREAM_END&&(L.avail_in!==0||w!==c.Z_FINISH&&w!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=d.utf8border(L.output,L.next_out),k=L.next_out-x,E=d.buf2string(L.output,x),L.next_out=k,L.avail_out=I-k,k&&o.arraySet(L.output,L.output,x,k,0),this.onData(E)):this.onData(o.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(N=!0)}while((0<L.avail_in||L.avail_out===0)&&b!==c.Z_STREAM_END);return b===c.Z_STREAM_END&&(w=c.Z_FINISH),w===c.Z_FINISH?(b=s.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===c.Z_OK):w!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(L.avail_out=0))},l.prototype.onData=function(v){this.chunks.push(v)},l.prototype.onEnd=function(v){v===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=l,i.inflate=_,i.inflateRaw=function(v,f){return(f=f||{}).raw=!0,_(v,f)},i.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var g=h.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var p in g)g.hasOwnProperty(p)&&(c[p]=g[p])}}return c},i.shrinkBuf=function(c,h){return c.length===h?c:c.subarray?c.subarray(0,h):(c.length=h,c)};var o={arraySet:function(c,h,g,p,u){if(h.subarray&&c.subarray)c.set(h.subarray(g,g+p),u);else for(var l=0;l<p;l++)c[u+l]=h[g+l]},flattenChunks:function(c){var h,g,p,u,l,_;for(h=p=0,g=c.length;h<g;h++)p+=c[h].length;for(_=new Uint8Array(p),h=u=0,g=c.length;h<g;h++)l=c[h],_.set(l,u),u+=l.length;return _}},d={arraySet:function(c,h,g,p,u){for(var l=0;l<p;l++)c[u+l]=h[g+l]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,d))},i.setTyped(s)},{}],42:[function(e,n,i){var s=e("./common"),o=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var c=new s.Buf8(256),h=0;h<256;h++)c[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function g(p,u){if(u<65537&&(p.subarray&&d||!p.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(p,u));for(var l="",_=0;_<u;_++)l+=String.fromCharCode(p[_]);return l}c[254]=c[254]=1,i.string2buf=function(p){var u,l,_,v,f,b=p.length,w=0;for(v=0;v<b;v++)(64512&(l=p.charCodeAt(v)))==55296&&v+1<b&&(64512&(_=p.charCodeAt(v+1)))==56320&&(l=65536+(l-55296<<10)+(_-56320),v++),w+=l<128?1:l<2048?2:l<65536?3:4;for(u=new s.Buf8(w),v=f=0;f<w;v++)(64512&(l=p.charCodeAt(v)))==55296&&v+1<b&&(64512&(_=p.charCodeAt(v+1)))==56320&&(l=65536+(l-55296<<10)+(_-56320),v++),l<128?u[f++]=l:(l<2048?u[f++]=192|l>>>6:(l<65536?u[f++]=224|l>>>12:(u[f++]=240|l>>>18,u[f++]=128|l>>>12&63),u[f++]=128|l>>>6&63),u[f++]=128|63&l);return u},i.buf2binstring=function(p){return g(p,p.length)},i.binstring2buf=function(p){for(var u=new s.Buf8(p.length),l=0,_=u.length;l<_;l++)u[l]=p.charCodeAt(l);return u},i.buf2string=function(p,u){var l,_,v,f,b=u||p.length,w=new Array(2*b);for(l=_=0;l<b;)if((v=p[l++])<128)w[_++]=v;else if(4<(f=c[v]))w[_++]=65533,l+=f-1;else{for(v&=f===2?31:f===3?15:7;1<f&&l<b;)v=v<<6|63&p[l++],f--;1<f?w[_++]=65533:v<65536?w[_++]=v:(v-=65536,w[_++]=55296|v>>10&1023,w[_++]=56320|1023&v)}return g(w,_)},i.utf8border=function(p,u){var l;for((u=u||p.length)>p.length&&(u=p.length),l=u-1;0<=l&&(192&p[l])==128;)l--;return l<0||l===0?u:l+c[p[l]]>u?l:u}},{"./common":41}],43:[function(e,n,i){n.exports=function(s,o,d,c){for(var h=65535&s|0,g=s>>>16&65535|0,p=0;d!==0;){for(d-=p=2e3<d?2e3:d;g=g+(h=h+o[c++]|0)|0,--p;);h%=65521,g%=65521}return h|g<<16|0}},{}],44:[function(e,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,i){var s=function(){for(var o,d=[],c=0;c<256;c++){o=c;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;d[c]=o}return d}();n.exports=function(o,d,c,h){var g=s,p=h+c;o^=-1;for(var u=h;u<p;u++)o=o>>>8^g[255&(o^d[u])];return-1^o}},{}],46:[function(e,n,i){var s,o=e("../utils/common"),d=e("./trees"),c=e("./adler32"),h=e("./crc32"),g=e("./messages"),p=0,u=4,l=0,_=-2,v=-1,f=4,b=2,w=8,x=9,k=286,E=30,M=19,L=2*k+1,I=15,R=3,N=258,X=N+R+1,S=42,P=113,y=1,B=2,ae=3,W=4;function ue(m,J){return m.msg=g[J],J}function Y(m){return(m<<1)-(4<m?9:0)}function se(m){for(var J=m.length;0<=--J;)m[J]=0}function A(m){var J=m.state,j=J.pending;j>m.avail_out&&(j=m.avail_out),j!==0&&(o.arraySet(m.output,J.pending_buf,J.pending_out,j,m.next_out),m.next_out+=j,J.pending_out+=j,m.total_out+=j,m.avail_out-=j,J.pending-=j,J.pending===0&&(J.pending_out=0))}function O(m,J){d._tr_flush_block(m,0<=m.block_start?m.block_start:-1,m.strstart-m.block_start,J),m.block_start=m.strstart,A(m.strm)}function oe(m,J){m.pending_buf[m.pending++]=J}function K(m,J){m.pending_buf[m.pending++]=J>>>8&255,m.pending_buf[m.pending++]=255&J}function Z(m,J){var j,F,C=m.max_chain_length,D=m.strstart,te=m.prev_length,q=m.nice_match,U=m.strstart>m.w_size-X?m.strstart-(m.w_size-X):0,ne=m.window,de=m.w_mask,le=m.prev,me=m.strstart+N,Pe=ne[D+te-1],xe=ne[D+te];m.prev_length>=m.good_match&&(C>>=2),q>m.lookahead&&(q=m.lookahead);do if(ne[(j=J)+te]===xe&&ne[j+te-1]===Pe&&ne[j]===ne[D]&&ne[++j]===ne[D+1]){D+=2,j++;do;while(ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&ne[++D]===ne[++j]&&D<me);if(F=N-(me-D),D=me-N,te<F){if(m.match_start=J,q<=(te=F))break;Pe=ne[D+te-1],xe=ne[D+te]}}while((J=le[J&de])>U&&--C!=0);return te<=m.lookahead?te:m.lookahead}function we(m){var J,j,F,C,D,te,q,U,ne,de,le=m.w_size;do{if(C=m.window_size-m.lookahead-m.strstart,m.strstart>=le+(le-X)){for(o.arraySet(m.window,m.window,le,le,0),m.match_start-=le,m.strstart-=le,m.block_start-=le,J=j=m.hash_size;F=m.head[--J],m.head[J]=le<=F?F-le:0,--j;);for(J=j=le;F=m.prev[--J],m.prev[J]=le<=F?F-le:0,--j;);C+=le}if(m.strm.avail_in===0)break;if(te=m.strm,q=m.window,U=m.strstart+m.lookahead,ne=C,de=void 0,de=te.avail_in,ne<de&&(de=ne),j=de===0?0:(te.avail_in-=de,o.arraySet(q,te.input,te.next_in,de,U),te.state.wrap===1?te.adler=c(te.adler,q,de,U):te.state.wrap===2&&(te.adler=h(te.adler,q,de,U)),te.next_in+=de,te.total_in+=de,de),m.lookahead+=j,m.lookahead+m.insert>=R)for(D=m.strstart-m.insert,m.ins_h=m.window[D],m.ins_h=(m.ins_h<<m.hash_shift^m.window[D+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[D+R-1])&m.hash_mask,m.prev[D&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=D,D++,m.insert--,!(m.lookahead+m.insert<R)););}while(m.lookahead<X&&m.strm.avail_in!==0)}function fe(m,J){for(var j,F;;){if(m.lookahead<X){if(we(m),m.lookahead<X&&J===p)return y;if(m.lookahead===0)break}if(j=0,m.lookahead>=R&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+R-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),j!==0&&m.strstart-j<=m.w_size-X&&(m.match_length=Z(m,j)),m.match_length>=R)if(F=d._tr_tally(m,m.strstart-m.match_start,m.match_length-R),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=R){for(m.match_length--;m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+R-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart,--m.match_length!=0;);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else F=d._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(F&&(O(m,!1),m.strm.avail_out===0))return y}return m.insert=m.strstart<R-1?m.strstart:R-1,J===u?(O(m,!0),m.strm.avail_out===0?ae:W):m.last_lit&&(O(m,!1),m.strm.avail_out===0)?y:B}function pe(m,J){for(var j,F,C;;){if(m.lookahead<X){if(we(m),m.lookahead<X&&J===p)return y;if(m.lookahead===0)break}if(j=0,m.lookahead>=R&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+R-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=R-1,j!==0&&m.prev_length<m.max_lazy_match&&m.strstart-j<=m.w_size-X&&(m.match_length=Z(m,j),m.match_length<=5&&(m.strategy===1||m.match_length===R&&4096<m.strstart-m.match_start)&&(m.match_length=R-1)),m.prev_length>=R&&m.match_length<=m.prev_length){for(C=m.strstart+m.lookahead-R,F=d._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-R),m.lookahead-=m.prev_length-1,m.prev_length-=2;++m.strstart<=C&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+R-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),--m.prev_length!=0;);if(m.match_available=0,m.match_length=R-1,m.strstart++,F&&(O(m,!1),m.strm.avail_out===0))return y}else if(m.match_available){if((F=d._tr_tally(m,0,m.window[m.strstart-1]))&&O(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return y}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(F=d._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<R-1?m.strstart:R-1,J===u?(O(m,!0),m.strm.avail_out===0?ae:W):m.last_lit&&(O(m,!1),m.strm.avail_out===0)?y:B}function ve(m,J,j,F,C){this.good_length=m,this.max_lazy=J,this.nice_length=j,this.max_chain=F,this.func=C}function Re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*L),this.dyn_dtree=new o.Buf16(2*(2*E+1)),this.bl_tree=new o.Buf16(2*(2*M+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(I+1),this.heap=new o.Buf16(2*k+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*k+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Fe(m){var J;return m&&m.state?(m.total_in=m.total_out=0,m.data_type=b,(J=m.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?S:P,m.adler=J.wrap===2?0:1,J.last_flush=p,d._tr_init(J),l):ue(m,_)}function Xe(m){var J=Fe(m);return J===l&&function(j){j.window_size=2*j.w_size,se(j.head),j.max_lazy_match=s[j.level].max_lazy,j.good_match=s[j.level].good_length,j.nice_match=s[j.level].nice_length,j.max_chain_length=s[j.level].max_chain,j.strstart=0,j.block_start=0,j.lookahead=0,j.insert=0,j.match_length=j.prev_length=R-1,j.match_available=0,j.ins_h=0}(m.state),J}function Me(m,J,j,F,C,D){if(!m)return _;var te=1;if(J===v&&(J=6),F<0?(te=0,F=-F):15<F&&(te=2,F-=16),C<1||x<C||j!==w||F<8||15<F||J<0||9<J||D<0||f<D)return ue(m,_);F===8&&(F=9);var q=new Re;return(m.state=q).strm=m,q.wrap=te,q.gzhead=null,q.w_bits=F,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=C+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+R-1)/R),q.window=new o.Buf8(2*q.w_size),q.head=new o.Buf16(q.hash_size),q.prev=new o.Buf16(q.w_size),q.lit_bufsize=1<<C+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new o.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=J,q.strategy=D,q.method=j,Xe(m)}s=[new ve(0,0,0,0,function(m,J){var j=65535;for(j>m.pending_buf_size-5&&(j=m.pending_buf_size-5);;){if(m.lookahead<=1){if(we(m),m.lookahead===0&&J===p)return y;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var F=m.block_start+j;if((m.strstart===0||m.strstart>=F)&&(m.lookahead=m.strstart-F,m.strstart=F,O(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-X&&(O(m,!1),m.strm.avail_out===0))return y}return m.insert=0,J===u?(O(m,!0),m.strm.avail_out===0?ae:W):(m.strstart>m.block_start&&(O(m,!1),m.strm.avail_out),y)}),new ve(4,4,8,4,fe),new ve(4,5,16,8,fe),new ve(4,6,32,32,fe),new ve(4,4,16,16,pe),new ve(8,16,32,32,pe),new ve(8,16,128,128,pe),new ve(8,32,128,256,pe),new ve(32,128,258,1024,pe),new ve(32,258,258,4096,pe)],i.deflateInit=function(m,J){return Me(m,J,w,15,8,0)},i.deflateInit2=Me,i.deflateReset=Xe,i.deflateResetKeep=Fe,i.deflateSetHeader=function(m,J){return m&&m.state?m.state.wrap!==2?_:(m.state.gzhead=J,l):_},i.deflate=function(m,J){var j,F,C,D;if(!m||!m.state||5<J||J<0)return m?ue(m,_):_;if(F=m.state,!m.output||!m.input&&m.avail_in!==0||F.status===666&&J!==u)return ue(m,m.avail_out===0?-5:_);if(F.strm=m,j=F.last_flush,F.last_flush=J,F.status===S)if(F.wrap===2)m.adler=0,oe(F,31),oe(F,139),oe(F,8),F.gzhead?(oe(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),oe(F,255&F.gzhead.time),oe(F,F.gzhead.time>>8&255),oe(F,F.gzhead.time>>16&255),oe(F,F.gzhead.time>>24&255),oe(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),oe(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(oe(F,255&F.gzhead.extra.length),oe(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(m.adler=h(m.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(oe(F,0),oe(F,0),oe(F,0),oe(F,0),oe(F,0),oe(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),oe(F,3),F.status=P);else{var te=w+(F.w_bits-8<<4)<<8;te|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(te|=32),te+=31-te%31,F.status=P,K(F,te),F.strstart!==0&&(K(F,m.adler>>>16),K(F,65535&m.adler)),m.adler=1}if(F.status===69)if(F.gzhead.extra){for(C=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>C&&(m.adler=h(m.adler,F.pending_buf,F.pending-C,C)),A(m),C=F.pending,F.pending!==F.pending_buf_size));)oe(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>C&&(m.adler=h(m.adler,F.pending_buf,F.pending-C,C)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){C=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>C&&(m.adler=h(m.adler,F.pending_buf,F.pending-C,C)),A(m),C=F.pending,F.pending===F.pending_buf_size)){D=1;break}D=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,oe(F,D)}while(D!==0);F.gzhead.hcrc&&F.pending>C&&(m.adler=h(m.adler,F.pending_buf,F.pending-C,C)),D===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){C=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>C&&(m.adler=h(m.adler,F.pending_buf,F.pending-C,C)),A(m),C=F.pending,F.pending===F.pending_buf_size)){D=1;break}D=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,oe(F,D)}while(D!==0);F.gzhead.hcrc&&F.pending>C&&(m.adler=h(m.adler,F.pending_buf,F.pending-C,C)),D===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&A(m),F.pending+2<=F.pending_buf_size&&(oe(F,255&m.adler),oe(F,m.adler>>8&255),m.adler=0,F.status=P)):F.status=P),F.pending!==0){if(A(m),m.avail_out===0)return F.last_flush=-1,l}else if(m.avail_in===0&&Y(J)<=Y(j)&&J!==u)return ue(m,-5);if(F.status===666&&m.avail_in!==0)return ue(m,-5);if(m.avail_in!==0||F.lookahead!==0||J!==p&&F.status!==666){var q=F.strategy===2?function(U,ne){for(var de;;){if(U.lookahead===0&&(we(U),U.lookahead===0)){if(ne===p)return y;break}if(U.match_length=0,de=d._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++,de&&(O(U,!1),U.strm.avail_out===0))return y}return U.insert=0,ne===u?(O(U,!0),U.strm.avail_out===0?ae:W):U.last_lit&&(O(U,!1),U.strm.avail_out===0)?y:B}(F,J):F.strategy===3?function(U,ne){for(var de,le,me,Pe,xe=U.window;;){if(U.lookahead<=N){if(we(U),U.lookahead<=N&&ne===p)return y;if(U.lookahead===0)break}if(U.match_length=0,U.lookahead>=R&&0<U.strstart&&(le=xe[me=U.strstart-1])===xe[++me]&&le===xe[++me]&&le===xe[++me]){Pe=U.strstart+N;do;while(le===xe[++me]&&le===xe[++me]&&le===xe[++me]&&le===xe[++me]&&le===xe[++me]&&le===xe[++me]&&le===xe[++me]&&le===xe[++me]&&me<Pe);U.match_length=N-(Pe-me),U.match_length>U.lookahead&&(U.match_length=U.lookahead)}if(U.match_length>=R?(de=d._tr_tally(U,1,U.match_length-R),U.lookahead-=U.match_length,U.strstart+=U.match_length,U.match_length=0):(de=d._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++),de&&(O(U,!1),U.strm.avail_out===0))return y}return U.insert=0,ne===u?(O(U,!0),U.strm.avail_out===0?ae:W):U.last_lit&&(O(U,!1),U.strm.avail_out===0)?y:B}(F,J):s[F.level].func(F,J);if(q!==ae&&q!==W||(F.status=666),q===y||q===ae)return m.avail_out===0&&(F.last_flush=-1),l;if(q===B&&(J===1?d._tr_align(F):J!==5&&(d._tr_stored_block(F,0,0,!1),J===3&&(se(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),A(m),m.avail_out===0))return F.last_flush=-1,l}return J!==u?l:F.wrap<=0?1:(F.wrap===2?(oe(F,255&m.adler),oe(F,m.adler>>8&255),oe(F,m.adler>>16&255),oe(F,m.adler>>24&255),oe(F,255&m.total_in),oe(F,m.total_in>>8&255),oe(F,m.total_in>>16&255),oe(F,m.total_in>>24&255)):(K(F,m.adler>>>16),K(F,65535&m.adler)),A(m),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?l:1)},i.deflateEnd=function(m){var J;return m&&m.state?(J=m.state.status)!==S&&J!==69&&J!==73&&J!==91&&J!==103&&J!==P&&J!==666?ue(m,_):(m.state=null,J===P?ue(m,-3):l):_},i.deflateSetDictionary=function(m,J){var j,F,C,D,te,q,U,ne,de=J.length;if(!m||!m.state||(D=(j=m.state).wrap)===2||D===1&&j.status!==S||j.lookahead)return _;for(D===1&&(m.adler=c(m.adler,J,de,0)),j.wrap=0,de>=j.w_size&&(D===0&&(se(j.head),j.strstart=0,j.block_start=0,j.insert=0),ne=new o.Buf8(j.w_size),o.arraySet(ne,J,de-j.w_size,j.w_size,0),J=ne,de=j.w_size),te=m.avail_in,q=m.next_in,U=m.input,m.avail_in=de,m.next_in=0,m.input=J,we(j);j.lookahead>=R;){for(F=j.strstart,C=j.lookahead-(R-1);j.ins_h=(j.ins_h<<j.hash_shift^j.window[F+R-1])&j.hash_mask,j.prev[F&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=F,F++,--C;);j.strstart=F,j.lookahead=R-1,we(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=R-1,j.match_available=0,m.next_in=q,m.input=U,m.avail_in=te,j.wrap=D,l},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,i){n.exports=function(s,o){var d,c,h,g,p,u,l,_,v,f,b,w,x,k,E,M,L,I,R,N,X,S,P,y,B;d=s.state,c=s.next_in,y=s.input,h=c+(s.avail_in-5),g=s.next_out,B=s.output,p=g-(o-s.avail_out),u=g+(s.avail_out-257),l=d.dmax,_=d.wsize,v=d.whave,f=d.wnext,b=d.window,w=d.hold,x=d.bits,k=d.lencode,E=d.distcode,M=(1<<d.lenbits)-1,L=(1<<d.distbits)-1;e:do{x<15&&(w+=y[c++]<<x,x+=8,w+=y[c++]<<x,x+=8),I=k[w&M];t:for(;;){if(w>>>=R=I>>>24,x-=R,(R=I>>>16&255)===0)B[g++]=65535&I;else{if(!(16&R)){if(!(64&R)){I=k[(65535&I)+(w&(1<<R)-1)];continue t}if(32&R){d.mode=12;break e}s.msg="invalid literal/length code",d.mode=30;break e}N=65535&I,(R&=15)&&(x<R&&(w+=y[c++]<<x,x+=8),N+=w&(1<<R)-1,w>>>=R,x-=R),x<15&&(w+=y[c++]<<x,x+=8,w+=y[c++]<<x,x+=8),I=E[w&L];r:for(;;){if(w>>>=R=I>>>24,x-=R,!(16&(R=I>>>16&255))){if(!(64&R)){I=E[(65535&I)+(w&(1<<R)-1)];continue r}s.msg="invalid distance code",d.mode=30;break e}if(X=65535&I,x<(R&=15)&&(w+=y[c++]<<x,(x+=8)<R&&(w+=y[c++]<<x,x+=8)),l<(X+=w&(1<<R)-1)){s.msg="invalid distance too far back",d.mode=30;break e}if(w>>>=R,x-=R,(R=g-p)<X){if(v<(R=X-R)&&d.sane){s.msg="invalid distance too far back",d.mode=30;break e}if(P=b,(S=0)===f){if(S+=_-R,R<N){for(N-=R;B[g++]=b[S++],--R;);S=g-X,P=B}}else if(f<R){if(S+=_+f-R,(R-=f)<N){for(N-=R;B[g++]=b[S++],--R;);if(S=0,f<N){for(N-=R=f;B[g++]=b[S++],--R;);S=g-X,P=B}}}else if(S+=f-R,R<N){for(N-=R;B[g++]=b[S++],--R;);S=g-X,P=B}for(;2<N;)B[g++]=P[S++],B[g++]=P[S++],B[g++]=P[S++],N-=3;N&&(B[g++]=P[S++],1<N&&(B[g++]=P[S++]))}else{for(S=g-X;B[g++]=B[S++],B[g++]=B[S++],B[g++]=B[S++],2<(N-=3););N&&(B[g++]=B[S++],1<N&&(B[g++]=B[S++]))}break}}break}}while(c<h&&g<u);c-=N=x>>3,w&=(1<<(x-=N<<3))-1,s.next_in=c,s.next_out=g,s.avail_in=c<h?h-c+5:5-(c-h),s.avail_out=g<u?u-g+257:257-(g-u),d.hold=w,d.bits=x}},{}],49:[function(e,n,i){var s=e("../utils/common"),o=e("./adler32"),d=e("./crc32"),c=e("./inffast"),h=e("./inftrees"),g=1,p=2,u=0,l=-2,_=1,v=852,f=592;function b(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(S){var P;return S&&S.state?(P=S.state,S.total_in=S.total_out=P.total=0,S.msg="",P.wrap&&(S.adler=1&P.wrap),P.mode=_,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new s.Buf32(v),P.distcode=P.distdyn=new s.Buf32(f),P.sane=1,P.back=-1,u):l}function k(S){var P;return S&&S.state?((P=S.state).wsize=0,P.whave=0,P.wnext=0,x(S)):l}function E(S,P){var y,B;return S&&S.state?(B=S.state,P<0?(y=0,P=-P):(y=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?l:(B.window!==null&&B.wbits!==P&&(B.window=null),B.wrap=y,B.wbits=P,k(S))):l}function M(S,P){var y,B;return S?(B=new w,(S.state=B).window=null,(y=E(S,P))!==u&&(S.state=null),y):l}var L,I,R=!0;function N(S){if(R){var P;for(L=new s.Buf32(512),I=new s.Buf32(32),P=0;P<144;)S.lens[P++]=8;for(;P<256;)S.lens[P++]=9;for(;P<280;)S.lens[P++]=7;for(;P<288;)S.lens[P++]=8;for(h(g,S.lens,0,288,L,0,S.work,{bits:9}),P=0;P<32;)S.lens[P++]=5;h(p,S.lens,0,32,I,0,S.work,{bits:5}),R=!1}S.lencode=L,S.lenbits=9,S.distcode=I,S.distbits=5}function X(S,P,y,B){var ae,W=S.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new s.Buf8(W.wsize)),B>=W.wsize?(s.arraySet(W.window,P,y-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(B<(ae=W.wsize-W.wnext)&&(ae=B),s.arraySet(W.window,P,y-B,ae,W.wnext),(B-=ae)?(s.arraySet(W.window,P,y-B,B,0),W.wnext=B,W.whave=W.wsize):(W.wnext+=ae,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=ae))),0}i.inflateReset=k,i.inflateReset2=E,i.inflateResetKeep=x,i.inflateInit=function(S){return M(S,15)},i.inflateInit2=M,i.inflate=function(S,P){var y,B,ae,W,ue,Y,se,A,O,oe,K,Z,we,fe,pe,ve,Re,Fe,Xe,Me,m,J,j,F,C=0,D=new s.Buf8(4),te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return l;(y=S.state).mode===12&&(y.mode=13),ue=S.next_out,ae=S.output,se=S.avail_out,W=S.next_in,B=S.input,Y=S.avail_in,A=y.hold,O=y.bits,oe=Y,K=se,J=u;e:for(;;)switch(y.mode){case _:if(y.wrap===0){y.mode=13;break}for(;O<16;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(2&y.wrap&&A===35615){D[y.check=0]=255&A,D[1]=A>>>8&255,y.check=d(y.check,D,2,0),O=A=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&A)<<8)+(A>>8))%31){S.msg="incorrect header check",y.mode=30;break}if((15&A)!=8){S.msg="unknown compression method",y.mode=30;break}if(O-=4,m=8+(15&(A>>>=4)),y.wbits===0)y.wbits=m;else if(m>y.wbits){S.msg="invalid window size",y.mode=30;break}y.dmax=1<<m,S.adler=y.check=1,y.mode=512&A?10:12,O=A=0;break;case 2:for(;O<16;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(y.flags=A,(255&y.flags)!=8){S.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){S.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=A>>8&1),512&y.flags&&(D[0]=255&A,D[1]=A>>>8&255,y.check=d(y.check,D,2,0)),O=A=0,y.mode=3;case 3:for(;O<32;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}y.head&&(y.head.time=A),512&y.flags&&(D[0]=255&A,D[1]=A>>>8&255,D[2]=A>>>16&255,D[3]=A>>>24&255,y.check=d(y.check,D,4,0)),O=A=0,y.mode=4;case 4:for(;O<16;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}y.head&&(y.head.xflags=255&A,y.head.os=A>>8),512&y.flags&&(D[0]=255&A,D[1]=A>>>8&255,y.check=d(y.check,D,2,0)),O=A=0,y.mode=5;case 5:if(1024&y.flags){for(;O<16;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}y.length=A,y.head&&(y.head.extra_len=A),512&y.flags&&(D[0]=255&A,D[1]=A>>>8&255,y.check=d(y.check,D,2,0)),O=A=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&(Y<(Z=y.length)&&(Z=Y),Z&&(y.head&&(m=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),s.arraySet(y.head.extra,B,W,Z,m)),512&y.flags&&(y.check=d(y.check,B,Z,W)),Y-=Z,W+=Z,y.length-=Z),y.length))break e;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(Y===0)break e;for(Z=0;m=B[W+Z++],y.head&&m&&y.length<65536&&(y.head.name+=String.fromCharCode(m)),m&&Z<Y;);if(512&y.flags&&(y.check=d(y.check,B,Z,W)),Y-=Z,W+=Z,m)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(Y===0)break e;for(Z=0;m=B[W+Z++],y.head&&m&&y.length<65536&&(y.head.comment+=String.fromCharCode(m)),m&&Z<Y;);if(512&y.flags&&(y.check=d(y.check,B,Z,W)),Y-=Z,W+=Z,m)break e}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;O<16;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(A!==(65535&y.check)){S.msg="header crc mismatch",y.mode=30;break}O=A=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),S.adler=y.check=0,y.mode=12;break;case 10:for(;O<32;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}S.adler=y.check=b(A),O=A=0,y.mode=11;case 11:if(y.havedict===0)return S.next_out=ue,S.avail_out=se,S.next_in=W,S.avail_in=Y,y.hold=A,y.bits=O,2;S.adler=y.check=1,y.mode=12;case 12:if(P===5||P===6)break e;case 13:if(y.last){A>>>=7&O,O-=7&O,y.mode=27;break}for(;O<3;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}switch(y.last=1&A,O-=1,3&(A>>>=1)){case 0:y.mode=14;break;case 1:if(N(y),y.mode=20,P!==6)break;A>>>=2,O-=2;break e;case 2:y.mode=17;break;case 3:S.msg="invalid block type",y.mode=30}A>>>=2,O-=2;break;case 14:for(A>>>=7&O,O-=7&O;O<32;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if((65535&A)!=(A>>>16^65535)){S.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&A,O=A=0,y.mode=15,P===6)break e;case 15:y.mode=16;case 16:if(Z=y.length){if(Y<Z&&(Z=Y),se<Z&&(Z=se),Z===0)break e;s.arraySet(ae,B,W,Z,ue),Y-=Z,W+=Z,se-=Z,ue+=Z,y.length-=Z;break}y.mode=12;break;case 17:for(;O<14;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(y.nlen=257+(31&A),A>>>=5,O-=5,y.ndist=1+(31&A),A>>>=5,O-=5,y.ncode=4+(15&A),A>>>=4,O-=4,286<y.nlen||30<y.ndist){S.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;O<3;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}y.lens[te[y.have++]]=7&A,A>>>=3,O-=3}for(;y.have<19;)y.lens[te[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,j={bits:y.lenbits},J=h(0,y.lens,0,19,y.lencode,0,y.work,j),y.lenbits=j.bits,J){S.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;ve=(C=y.lencode[A&(1<<y.lenbits)-1])>>>16&255,Re=65535&C,!((pe=C>>>24)<=O);){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(Re<16)A>>>=pe,O-=pe,y.lens[y.have++]=Re;else{if(Re===16){for(F=pe+2;O<F;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(A>>>=pe,O-=pe,y.have===0){S.msg="invalid bit length repeat",y.mode=30;break}m=y.lens[y.have-1],Z=3+(3&A),A>>>=2,O-=2}else if(Re===17){for(F=pe+3;O<F;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}O-=pe,m=0,Z=3+(7&(A>>>=pe)),A>>>=3,O-=3}else{for(F=pe+7;O<F;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}O-=pe,m=0,Z=11+(127&(A>>>=pe)),A>>>=7,O-=7}if(y.have+Z>y.nlen+y.ndist){S.msg="invalid bit length repeat",y.mode=30;break}for(;Z--;)y.lens[y.have++]=m}}if(y.mode===30)break;if(y.lens[256]===0){S.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,j={bits:y.lenbits},J=h(g,y.lens,0,y.nlen,y.lencode,0,y.work,j),y.lenbits=j.bits,J){S.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,j={bits:y.distbits},J=h(p,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,j),y.distbits=j.bits,J){S.msg="invalid distances set",y.mode=30;break}if(y.mode=20,P===6)break e;case 20:y.mode=21;case 21:if(6<=Y&&258<=se){S.next_out=ue,S.avail_out=se,S.next_in=W,S.avail_in=Y,y.hold=A,y.bits=O,c(S,K),ue=S.next_out,ae=S.output,se=S.avail_out,W=S.next_in,B=S.input,Y=S.avail_in,A=y.hold,O=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;ve=(C=y.lencode[A&(1<<y.lenbits)-1])>>>16&255,Re=65535&C,!((pe=C>>>24)<=O);){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(ve&&!(240&ve)){for(Fe=pe,Xe=ve,Me=Re;ve=(C=y.lencode[Me+((A&(1<<Fe+Xe)-1)>>Fe)])>>>16&255,Re=65535&C,!(Fe+(pe=C>>>24)<=O);){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}A>>>=Fe,O-=Fe,y.back+=Fe}if(A>>>=pe,O-=pe,y.back+=pe,y.length=Re,ve===0){y.mode=26;break}if(32&ve){y.back=-1,y.mode=12;break}if(64&ve){S.msg="invalid literal/length code",y.mode=30;break}y.extra=15&ve,y.mode=22;case 22:if(y.extra){for(F=y.extra;O<F;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}y.length+=A&(1<<y.extra)-1,A>>>=y.extra,O-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;ve=(C=y.distcode[A&(1<<y.distbits)-1])>>>16&255,Re=65535&C,!((pe=C>>>24)<=O);){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(!(240&ve)){for(Fe=pe,Xe=ve,Me=Re;ve=(C=y.distcode[Me+((A&(1<<Fe+Xe)-1)>>Fe)])>>>16&255,Re=65535&C,!(Fe+(pe=C>>>24)<=O);){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}A>>>=Fe,O-=Fe,y.back+=Fe}if(A>>>=pe,O-=pe,y.back+=pe,64&ve){S.msg="invalid distance code",y.mode=30;break}y.offset=Re,y.extra=15&ve,y.mode=24;case 24:if(y.extra){for(F=y.extra;O<F;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}y.offset+=A&(1<<y.extra)-1,A>>>=y.extra,O-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){S.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(se===0)break e;if(Z=K-se,y.offset>Z){if((Z=y.offset-Z)>y.whave&&y.sane){S.msg="invalid distance too far back",y.mode=30;break}we=Z>y.wnext?(Z-=y.wnext,y.wsize-Z):y.wnext-Z,Z>y.length&&(Z=y.length),fe=y.window}else fe=ae,we=ue-y.offset,Z=y.length;for(se<Z&&(Z=se),se-=Z,y.length-=Z;ae[ue++]=fe[we++],--Z;);y.length===0&&(y.mode=21);break;case 26:if(se===0)break e;ae[ue++]=y.length,se--,y.mode=21;break;case 27:if(y.wrap){for(;O<32;){if(Y===0)break e;Y--,A|=B[W++]<<O,O+=8}if(K-=se,S.total_out+=K,y.total+=K,K&&(S.adler=y.check=y.flags?d(y.check,ae,K,ue-K):o(y.check,ae,K,ue-K)),K=se,(y.flags?A:b(A))!==y.check){S.msg="incorrect data check",y.mode=30;break}O=A=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;O<32;){if(Y===0)break e;Y--,A+=B[W++]<<O,O+=8}if(A!==(4294967295&y.total)){S.msg="incorrect length check",y.mode=30;break}O=A=0}y.mode=29;case 29:J=1;break e;case 30:J=-3;break e;case 31:return-4;case 32:default:return l}return S.next_out=ue,S.avail_out=se,S.next_in=W,S.avail_in=Y,y.hold=A,y.bits=O,(y.wsize||K!==S.avail_out&&y.mode<30&&(y.mode<27||P!==4))&&X(S,S.output,S.next_out,K-S.avail_out)?(y.mode=31,-4):(oe-=S.avail_in,K-=S.avail_out,S.total_in+=oe,S.total_out+=K,y.total+=K,y.wrap&&K&&(S.adler=y.check=y.flags?d(y.check,ae,K,S.next_out-K):o(y.check,ae,K,S.next_out-K)),S.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(oe==0&&K===0||P===4)&&J===u&&(J=-5),J)},i.inflateEnd=function(S){if(!S||!S.state)return l;var P=S.state;return P.window&&(P.window=null),S.state=null,u},i.inflateGetHeader=function(S,P){var y;return S&&S.state&&2&(y=S.state).wrap?((y.head=P).done=!1,u):l},i.inflateSetDictionary=function(S,P){var y,B=P.length;return S&&S.state?(y=S.state).wrap!==0&&y.mode!==11?l:y.mode===11&&o(1,P,B,0)!==y.check?-3:X(S,P,B,B)?(y.mode=31,-4):(y.havedict=1,u):l},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,i){var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(g,p,u,l,_,v,f,b){var w,x,k,E,M,L,I,R,N,X=b.bits,S=0,P=0,y=0,B=0,ae=0,W=0,ue=0,Y=0,se=0,A=0,O=null,oe=0,K=new s.Buf16(16),Z=new s.Buf16(16),we=null,fe=0;for(S=0;S<=15;S++)K[S]=0;for(P=0;P<l;P++)K[p[u+P]]++;for(ae=X,B=15;1<=B&&K[B]===0;B--);if(B<ae&&(ae=B),B===0)return _[v++]=20971520,_[v++]=20971520,b.bits=1,0;for(y=1;y<B&&K[y]===0;y++);for(ae<y&&(ae=y),S=Y=1;S<=15;S++)if(Y<<=1,(Y-=K[S])<0)return-1;if(0<Y&&(g===0||B!==1))return-1;for(Z[1]=0,S=1;S<15;S++)Z[S+1]=Z[S]+K[S];for(P=0;P<l;P++)p[u+P]!==0&&(f[Z[p[u+P]]++]=P);if(L=g===0?(O=we=f,19):g===1?(O=o,oe-=257,we=d,fe-=257,256):(O=c,we=h,-1),S=y,M=v,ue=P=A=0,k=-1,E=(se=1<<(W=ae))-1,g===1&&852<se||g===2&&592<se)return 1;for(;;){for(I=S-ue,N=f[P]<L?(R=0,f[P]):f[P]>L?(R=we[fe+f[P]],O[oe+f[P]]):(R=96,0),w=1<<S-ue,y=x=1<<W;_[M+(A>>ue)+(x-=w)]=I<<24|R<<16|N|0,x!==0;);for(w=1<<S-1;A&w;)w>>=1;if(w!==0?(A&=w-1,A+=w):A=0,P++,--K[S]==0){if(S===B)break;S=p[u+f[P]]}if(ae<S&&(A&E)!==k){for(ue===0&&(ue=ae),M+=y,Y=1<<(W=S-ue);W+ue<B&&!((Y-=K[W+ue])<=0);)W++,Y<<=1;if(se+=1<<W,g===1&&852<se||g===2&&592<se)return 1;_[k=A&E]=ae<<24|W<<16|M-v|0}}return A!==0&&(_[M+A]=S-ue<<24|64<<16|0),b.bits=ae,0}},{"../utils/common":41}],51:[function(e,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,i){var s=e("../utils/common"),o=0,d=1;function c(C){for(var D=C.length;0<=--D;)C[D]=0}var h=0,g=29,p=256,u=p+1+g,l=30,_=19,v=2*u+1,f=15,b=16,w=7,x=256,k=16,E=17,M=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(u+2));c(X);var S=new Array(2*l);c(S);var P=new Array(512);c(P);var y=new Array(256);c(y);var B=new Array(g);c(B);var ae,W,ue,Y=new Array(l);function se(C,D,te,q,U){this.static_tree=C,this.extra_bits=D,this.extra_base=te,this.elems=q,this.max_length=U,this.has_stree=C&&C.length}function A(C,D){this.dyn_tree=C,this.max_code=0,this.stat_desc=D}function O(C){return C<256?P[C]:P[256+(C>>>7)]}function oe(C,D){C.pending_buf[C.pending++]=255&D,C.pending_buf[C.pending++]=D>>>8&255}function K(C,D,te){C.bi_valid>b-te?(C.bi_buf|=D<<C.bi_valid&65535,oe(C,C.bi_buf),C.bi_buf=D>>b-C.bi_valid,C.bi_valid+=te-b):(C.bi_buf|=D<<C.bi_valid&65535,C.bi_valid+=te)}function Z(C,D,te){K(C,te[2*D],te[2*D+1])}function we(C,D){for(var te=0;te|=1&C,C>>>=1,te<<=1,0<--D;);return te>>>1}function fe(C,D,te){var q,U,ne=new Array(f+1),de=0;for(q=1;q<=f;q++)ne[q]=de=de+te[q-1]<<1;for(U=0;U<=D;U++){var le=C[2*U+1];le!==0&&(C[2*U]=we(ne[le]++,le))}}function pe(C){var D;for(D=0;D<u;D++)C.dyn_ltree[2*D]=0;for(D=0;D<l;D++)C.dyn_dtree[2*D]=0;for(D=0;D<_;D++)C.bl_tree[2*D]=0;C.dyn_ltree[2*x]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function ve(C){8<C.bi_valid?oe(C,C.bi_buf):0<C.bi_valid&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function Re(C,D,te,q){var U=2*D,ne=2*te;return C[U]<C[ne]||C[U]===C[ne]&&q[D]<=q[te]}function Fe(C,D,te){for(var q=C.heap[te],U=te<<1;U<=C.heap_len&&(U<C.heap_len&&Re(D,C.heap[U+1],C.heap[U],C.depth)&&U++,!Re(D,q,C.heap[U],C.depth));)C.heap[te]=C.heap[U],te=U,U<<=1;C.heap[te]=q}function Xe(C,D,te){var q,U,ne,de,le=0;if(C.last_lit!==0)for(;q=C.pending_buf[C.d_buf+2*le]<<8|C.pending_buf[C.d_buf+2*le+1],U=C.pending_buf[C.l_buf+le],le++,q===0?Z(C,U,D):(Z(C,(ne=y[U])+p+1,D),(de=L[ne])!==0&&K(C,U-=B[ne],de),Z(C,ne=O(--q),te),(de=I[ne])!==0&&K(C,q-=Y[ne],de)),le<C.last_lit;);Z(C,x,D)}function Me(C,D){var te,q,U,ne=D.dyn_tree,de=D.stat_desc.static_tree,le=D.stat_desc.has_stree,me=D.stat_desc.elems,Pe=-1;for(C.heap_len=0,C.heap_max=v,te=0;te<me;te++)ne[2*te]!==0?(C.heap[++C.heap_len]=Pe=te,C.depth[te]=0):ne[2*te+1]=0;for(;C.heap_len<2;)ne[2*(U=C.heap[++C.heap_len]=Pe<2?++Pe:0)]=1,C.depth[U]=0,C.opt_len--,le&&(C.static_len-=de[2*U+1]);for(D.max_code=Pe,te=C.heap_len>>1;1<=te;te--)Fe(C,ne,te);for(U=me;te=C.heap[1],C.heap[1]=C.heap[C.heap_len--],Fe(C,ne,1),q=C.heap[1],C.heap[--C.heap_max]=te,C.heap[--C.heap_max]=q,ne[2*U]=ne[2*te]+ne[2*q],C.depth[U]=(C.depth[te]>=C.depth[q]?C.depth[te]:C.depth[q])+1,ne[2*te+1]=ne[2*q+1]=U,C.heap[1]=U++,Fe(C,ne,1),2<=C.heap_len;);C.heap[--C.heap_max]=C.heap[1],function(xe,st){var er,ut,tr,je,_i,Zi,bt=st.dyn_tree,Vs=st.max_code,Za=st.stat_desc.static_tree,Ya=st.stat_desc.has_stree,Ka=st.stat_desc.extra_bits,qs=st.stat_desc.extra_base,rr=st.stat_desc.max_length,bi=0;for(je=0;je<=f;je++)xe.bl_count[je]=0;for(bt[2*xe.heap[xe.heap_max]+1]=0,er=xe.heap_max+1;er<v;er++)rr<(je=bt[2*bt[2*(ut=xe.heap[er])+1]+1]+1)&&(je=rr,bi++),bt[2*ut+1]=je,Vs<ut||(xe.bl_count[je]++,_i=0,qs<=ut&&(_i=Ka[ut-qs]),Zi=bt[2*ut],xe.opt_len+=Zi*(je+_i),Ya&&(xe.static_len+=Zi*(Za[2*ut+1]+_i)));if(bi!==0){do{for(je=rr-1;xe.bl_count[je]===0;)je--;xe.bl_count[je]--,xe.bl_count[je+1]+=2,xe.bl_count[rr]--,bi-=2}while(0<bi);for(je=rr;je!==0;je--)for(ut=xe.bl_count[je];ut!==0;)Vs<(tr=xe.heap[--er])||(bt[2*tr+1]!==je&&(xe.opt_len+=(je-bt[2*tr+1])*bt[2*tr],bt[2*tr+1]=je),ut--)}}(C,D),fe(ne,Pe,C.bl_count)}function m(C,D,te){var q,U,ne=-1,de=D[1],le=0,me=7,Pe=4;for(de===0&&(me=138,Pe=3),D[2*(te+1)+1]=65535,q=0;q<=te;q++)U=de,de=D[2*(q+1)+1],++le<me&&U===de||(le<Pe?C.bl_tree[2*U]+=le:U!==0?(U!==ne&&C.bl_tree[2*U]++,C.bl_tree[2*k]++):le<=10?C.bl_tree[2*E]++:C.bl_tree[2*M]++,ne=U,Pe=(le=0)===de?(me=138,3):U===de?(me=6,3):(me=7,4))}function J(C,D,te){var q,U,ne=-1,de=D[1],le=0,me=7,Pe=4;for(de===0&&(me=138,Pe=3),q=0;q<=te;q++)if(U=de,de=D[2*(q+1)+1],!(++le<me&&U===de)){if(le<Pe)for(;Z(C,U,C.bl_tree),--le!=0;);else U!==0?(U!==ne&&(Z(C,U,C.bl_tree),le--),Z(C,k,C.bl_tree),K(C,le-3,2)):le<=10?(Z(C,E,C.bl_tree),K(C,le-3,3)):(Z(C,M,C.bl_tree),K(C,le-11,7));ne=U,Pe=(le=0)===de?(me=138,3):U===de?(me=6,3):(me=7,4)}}c(Y);var j=!1;function F(C,D,te,q){K(C,(h<<1)+(q?1:0),3),function(U,ne,de,le){ve(U),oe(U,de),oe(U,~de),s.arraySet(U.pending_buf,U.window,ne,de,U.pending),U.pending+=de}(C,D,te)}i._tr_init=function(C){j||(function(){var D,te,q,U,ne,de=new Array(f+1);for(U=q=0;U<g-1;U++)for(B[U]=q,D=0;D<1<<L[U];D++)y[q++]=U;for(y[q-1]=U,U=ne=0;U<16;U++)for(Y[U]=ne,D=0;D<1<<I[U];D++)P[ne++]=U;for(ne>>=7;U<l;U++)for(Y[U]=ne<<7,D=0;D<1<<I[U]-7;D++)P[256+ne++]=U;for(te=0;te<=f;te++)de[te]=0;for(D=0;D<=143;)X[2*D+1]=8,D++,de[8]++;for(;D<=255;)X[2*D+1]=9,D++,de[9]++;for(;D<=279;)X[2*D+1]=7,D++,de[7]++;for(;D<=287;)X[2*D+1]=8,D++,de[8]++;for(fe(X,u+1,de),D=0;D<l;D++)S[2*D+1]=5,S[2*D]=we(D,5);ae=new se(X,L,p+1,u,f),W=new se(S,I,0,l,f),ue=new se(new Array(0),R,0,_,w)}(),j=!0),C.l_desc=new A(C.dyn_ltree,ae),C.d_desc=new A(C.dyn_dtree,W),C.bl_desc=new A(C.bl_tree,ue),C.bi_buf=0,C.bi_valid=0,pe(C)},i._tr_stored_block=F,i._tr_flush_block=function(C,D,te,q){var U,ne,de=0;0<C.level?(C.strm.data_type===2&&(C.strm.data_type=function(le){var me,Pe=4093624447;for(me=0;me<=31;me++,Pe>>>=1)if(1&Pe&&le.dyn_ltree[2*me]!==0)return o;if(le.dyn_ltree[18]!==0||le.dyn_ltree[20]!==0||le.dyn_ltree[26]!==0)return d;for(me=32;me<p;me++)if(le.dyn_ltree[2*me]!==0)return d;return o}(C)),Me(C,C.l_desc),Me(C,C.d_desc),de=function(le){var me;for(m(le,le.dyn_ltree,le.l_desc.max_code),m(le,le.dyn_dtree,le.d_desc.max_code),Me(le,le.bl_desc),me=_-1;3<=me&&le.bl_tree[2*N[me]+1]===0;me--);return le.opt_len+=3*(me+1)+5+5+4,me}(C),U=C.opt_len+3+7>>>3,(ne=C.static_len+3+7>>>3)<=U&&(U=ne)):U=ne=te+5,te+4<=U&&D!==-1?F(C,D,te,q):C.strategy===4||ne===U?(K(C,2+(q?1:0),3),Xe(C,X,S)):(K(C,4+(q?1:0),3),function(le,me,Pe,xe){var st;for(K(le,me-257,5),K(le,Pe-1,5),K(le,xe-4,4),st=0;st<xe;st++)K(le,le.bl_tree[2*N[st]+1],3);J(le,le.dyn_ltree,me-1),J(le,le.dyn_dtree,Pe-1)}(C,C.l_desc.max_code+1,C.d_desc.max_code+1,de+1),Xe(C,C.dyn_ltree,C.dyn_dtree)),pe(C),q&&ve(C)},i._tr_tally=function(C,D,te){return C.pending_buf[C.d_buf+2*C.last_lit]=D>>>8&255,C.pending_buf[C.d_buf+2*C.last_lit+1]=255&D,C.pending_buf[C.l_buf+C.last_lit]=255&te,C.last_lit++,D===0?C.dyn_ltree[2*te]++:(C.matches++,D--,C.dyn_ltree[2*(y[te]+p+1)]++,C.dyn_dtree[2*O(D)]++),C.last_lit===C.lit_bufsize-1},i._tr_align=function(C){K(C,2,3),Z(C,x,X),function(D){D.bi_valid===16?(oe(D,D.bi_buf),D.bi_buf=0,D.bi_valid=0):8<=D.bi_valid&&(D.pending_buf[D.pending++]=255&D.bi_buf,D.bi_buf>>=8,D.bi_valid-=8)}(C)}},{"../utils/common":41}],53:[function(e,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,i){(function(s){(function(o,d){if(!o.setImmediate){var c,h,g,p,u=1,l={},_=!1,v=o.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(o);f=f&&f.setTimeout?f:o,c={}.toString.call(o.process)==="[object process]"?function(k){process.nextTick(function(){w(k)})}:function(){if(o.postMessage&&!o.importScripts){var k=!0,E=o.onmessage;return o.onmessage=function(){k=!1},o.postMessage("","*"),o.onmessage=E,k}}()?(p="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",x,!1):o.attachEvent("onmessage",x),function(k){o.postMessage(p+k,"*")}):o.MessageChannel?((g=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){g.port2.postMessage(k)}):v&&"onreadystatechange"in v.createElement("script")?(h=v.documentElement,function(k){var E=v.createElement("script");E.onreadystatechange=function(){w(k),E.onreadystatechange=null,h.removeChild(E),E=null},h.appendChild(E)}):function(k){setTimeout(w,0,k)},f.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var E=new Array(arguments.length-1),M=0;M<E.length;M++)E[M]=arguments[M+1];var L={callback:k,args:E};return l[u]=L,c(u),u++},f.clearImmediate=b}function b(k){delete l[k]}function w(k){if(_)setTimeout(w,0,k);else{var E=l[k];if(E){_=!0;try{(function(M){var L=M.callback,I=M.args;switch(I.length){case 0:L();break;case 1:L(I[0]);break;case 2:L(I[0],I[1]);break;case 3:L(I[0],I[1],I[2]);break;default:L.apply(d,I)}})(E)}finally{b(k),_=!1}}}}function x(k){k.source===o&&typeof k.data=="string"&&k.data.indexOf(p)===0&&w(+k.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof yt<"u"?yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Wa);var uu=Wa.exports;const Rs=ja(uu);let ns=null;var ii,si,ai;const Xs=class Xs{constructor(){ee(this,ii,Q(null));ee(this,si,Q(""));ee(this,ai,Q(""));ge(this,"callback",null)}get modal(){return a(T(this,ii))}set modal(t){V(T(this,ii),H(t))}get message(){return a(T(this,si))}set message(t){V(T(this,si),H(t))}get fileName(){return a(T(this,ai))}set fileName(t){V(T(this,ai),H(t))}static GetSingleton(){return ns==null&&(ns=new Xs),ns}Prompt(t,e,n){this.fileName=e,this.message=t,this.callback=n,this.modal&&this.modal.open()}CancelEvent(){return t=>{this.modal&&this.modal.close()}}ConfirmEvent(){return t=>{this.modal&&this.modal.close(),this.callback&&this.callback(this.fileName)}}};ii=new WeakMap,si=new WeakMap,ai=new WeakMap;let lr=Xs;const jt=Ne.GetSingleton();let is=null,cu=class{constructor(){this.zip=new Rs}WriteImage(t,e){e&&this.zip.file(t,e.replace(/^data:.*?;base64,/,""),{base64:!0})}Download(t){this.zip.generateAsync({type:"blob"}).then(function(e){Xa.saveAs(e,t)})}};var oi,li,ui,ci;const Ws=class Ws{constructor(){ee(this,oi,Q(null));ee(this,li,Q(null));ge(this,"renderTarget",null);ee(this,ui,Q(H([])));ee(this,ci,Q(null))}get modal(){return a(T(this,oi))}set modal(t){V(T(this,oi),H(t))}get contentModal(){return a(T(this,li))}set contentModal(t){V(T(this,li),H(t))}get outputs(){return a(T(this,ui))}set outputs(t){V(T(this,ui),H(t))}get selectedOutput(){return a(T(this,ci))}set selectedOutput(t){V(T(this,ci),H(t))}static GetSingleton(){return is==null&&(is=new Ws),is}Open(){this.modal&&this.modal.open()}async RenderOutput(t){var n;return await t.Render(),(n=t.base)==null?void 0:n.outputCanvas.toDataURL("image/png")}cleanReferences(t){const e=jt.files[t];for(const n of this.outputs){if(n instanceof Yt){for(const i of n.files)i.file.id==e.id&&(i.file=i.baseFile);n.files=n.files.filter(i=>i.baseFile.id!==e.id)}n.BuildFileCache()}}async Download(){const t=lr.GetSingleton(),e=this.outputs.filter(i=>i.enabled),n=[];for(const i of e){const s=await this.RenderOutput(i);s!=null&&n.push({image:s,name:i.name})}n.length==1?t.Prompt("Render Asset",n[0].name,async i=>{const s=document.createElement("a");s.href=n[0].image,s.download=i+".png",s.click()}):n.length>0&&t.Prompt("Render Assets",jt.projectName+" Assets",async i=>{const s=new cu;for(const o of n)s.WriteImage(o.name+".png",o.image);s.Download(i)})}OpenContentModalEvent(t){return e=>{this.selectedOutput=t,this.contentModal.setTitle("Rendering output - "+t.name),this.contentModal.open(),this.selectedOutput.UpdatePreview()}}PickColorEvent(t,e){return n=>{Rt.GetSingleton().PickColor(e.color,s=>{e.color=[...s],t.UpdatePreview()})}}RemoveOutput(t){t==this.selectedOutput&&this.contentModal.close(),this.outputs.splice(this.outputs.indexOf(t),1)}CopyEvent(t){return e=>{const n=t.Copy();n.name=this.GetAvailableName(t.name.replace(/\s+-\s+Copy\s+(?:\(\d+\)){0,1}$/g,"")+" - Copy "),this.outputs.splice(Math.min(this.outputs.indexOf(t)+1,this.outputs.length),0,n),this.selectedOutput=n,this.contentModal.setTitle("Rendering output - "+n.name)}}UpdateAllPreviewEvent(){return t=>{for(const e of this.outputs)e.UpdatePreview()}}GetAvailableName(t){let e=t,n=2;for(;this.outputs.some(i=>i.name==e);)e=t+" ("+n+")",n+=1;return e}AddOutputEvent(){return t=>{jt.selectedFile&&jt.selectedFile instanceof Le?this.outputs.push(jt.selectedFile.CreateReference(this.GetAvailableName(jt.selectedFile.name+" Render Output"))):this.outputs.push(new Yt(null,this.GetAvailableName("Render Output")))}}};oi=new WeakMap,li=new WeakMap,ui=new WeakMap,ci=new WeakMap;let It=Ws;var du=ie('<img class="thumb  h-margin" alt="thumb">'),hu=ie('<i class="fa-solid fa-folder icon"></i>'),fu=ie('<i class="fa-solid fa-file icon"></i>'),vu=ie('<div class="row"><div><!> </div></div>'),pu=(r,t,e)=>a(t).CopyComposition(e()),mu=ie('<button class="button" style="margin-left: auto;"><i class="fa-solid fa-copy icon"></i></button>'),gu=(r,t)=>t().open=!t().open,_u=ie('<button class="button" style="margin-left: auto;"><i></i></button>'),bu=(r,t,e)=>t(e()),yu=ie('<!> <button class="button" style="margin-left: auto;"><i class="fa-solid fa-trash icon"></i></button>',1),wu=ie('<div class="column flex-1"><div class="separator" style="margin-bottom: 10px;"></div> <div class="flex-1 column"><!></div></div>');function xu(r,t){Ae(t,!1);const e=Je(Ne.GetSingleton()),n=It.GetSingleton(),i=kt.GetSingleton(),s=Je(Pt.GetFileListSingleton());z(s,a(s).selectEvent=p=>{p instanceof Le&&p.selectedLayer==null&&p.layers.length>0&&(p.selectedLayer=p.layers[0]),a(e).selectedFileHistory.includes(p)||a(e).selectedFileHistory.push(p),a(e).selectedFile instanceof Le&&a(e).selectedFile.layers.length>0&&z(e,a(e).selectedFile.selectedLayer=a(e).selectedFile.layers[0]),a(e).updateScreen()});function o(p){i.Prompt("Are you sure you want to remove this file?",()=>{const u=a(e).getSelectedFileIndex()==p;a(e).cleanReferences(p),n.cleanReferences(p),a(e).removeFromTabs(p),a(s).removeLayer(p),u&&(a(e).files.length==0?z(e,a(e).selectedFile=null):z(e,a(e).selectedFile=a(e).files[0]),a(e).updateScreen())})}function d(p,u){const l=a(e).getFolder(u);return l?l.open:!0}Ze();var c=wu(),h=G(re(c),2);{const p=(l,_=Be,v=Be)=>{var f=vu(),b=re(f);const w=he(()=>`center flex1 ${(a(e).getFolder(v())?"folder-item":"")??""} svelte-k0rruo`);var x=re(b);_e(x,()=>_().thumbnail,E=>{var M=du();be(()=>$e(M,"src",_().thumbnail)),$(E,M)},E=>{var M=Se(),L=ce(M);_e(L,()=>_()instanceof De,I=>{var R=hu();$(I,R)},I=>{var R=fu();$(I,R)},!0),$(E,M)});var k=G(x);be(()=>{We(b,a(w)),Ge(k,` ${_().name??""}`)}),$(l,f)},u=(l,_=Be,v=Be)=>{var f=yu(),b=ce(f);_e(b,()=>_()instanceof Le||_()instanceof Ue,x=>{var k=mu();k.__click=[pu,e,v],$(x,k)},x=>{var k=Se(),E=ce(k);_e(E,()=>_()instanceof De,M=>{var L=_u();L.__click=[gu,_];var I=re(L);be(()=>We(I,`icon fa-solid ${(_().open?"fa-angle-left":"fa-angle-down")??""}`)),$(M,L)},null,!0),$(x,k)});var w=G(b,2);w.__click=[bu,o,v],$(l,f)};var g=re(h);Ke(g,()=>a(e).files,l=>{var _=he(()=>new Hi(a(e),"files","selectedFile","file","vertical-list"));Wi(l,{get list(){return a(_)},rendering:new ji(p,u,d),get io(){return a(s)}})})}$(r,c),Te()}He(["click"]);var ku=542327876,Su=131072,Cu=4,Eu=Vi("DXT1"),Fu=Vi("DXT3"),Au=Vi("DXT5"),da=Vi("DX10"),Tu=116,Ru=512,Iu=3,Du=2,Pu=31,Lu=0,$u=1,Ou=2,Gu=3,Mu=4,Uu=7,zu=20,Bu=21,Nu=28,ju=Hu;function Hu(r){var t=new Int32Array(r,0,Pu);if(t[Lu]!==ku)throw new Error("Invalid magic number in DDS header");if(!t[zu]&Cu)throw new Error("Unsupported format, must contain a FourCC code");var e,n,i=t[Bu];switch(i){case Eu:e=8,n="dxt1";break;case Fu:e=16,n="dxt3";break;case Au:e=16,n="dxt5";break;case Tu:n="rgba32f";break;case da:var s=new Uint32Array(r.slice(128,148));n=s[0];var o=s[1];if(s[2],s[3],s[4],o===Iu&&n===Du)n="rgba32f";else throw new Error("Unsupported DX10 texture format "+n);break;default:throw new Error("Unsupported FourCC code: "+Xu(i))}var d=t[Ou],c=1;d&Su&&(c=Math.max(1,t[Uu]));var h=!1,g=t[Nu];g&Ru&&(h=!0);var p=t[Mu],u=t[Gu],l=t[$u]+4,_=p,v=u,f=[],b;if(i===da&&(l+=20),h)for(var w=0;w<6;w++){if(n!=="rgba32f")throw new Error("Only RGBA32f cubemaps are supported");var x=4*32/8;p=_,u=v;for(var k=Math.log(p)/Math.log(2)+1,E=0;E<k;E++)b=p*u*x,f.push({offset:l,length:b,shape:[p,u]}),E<c&&(l+=b),p=Math.floor(p/2),u=Math.floor(u/2)}else for(var E=0;E<c;E++)b=Math.max(4,p)/4*Math.max(4,u)/4*e,f.push({offset:l,length:b,shape:[p,u]}),l+=b,p=Math.floor(p/2),u=Math.floor(u/2);return{shape:[_,v],images:f,format:n,flags:d,cubemap:h}}function Vi(r){return r.charCodeAt(0)+(r.charCodeAt(1)<<8)+(r.charCodeAt(2)<<16)+(r.charCodeAt(3)<<24)}function Xu(r){return String.fromCharCode(r&255,r>>8&255,r>>16&255,r>>24&255)}const Wu=ja(ju);function Vu(r){const t=r.split(",")[1],e=atob(t),n=e.length,i=new ArrayBuffer(n),s=new Uint8Array(i);for(let o=0;o<n;(o+=1)-1)s[o]=e.charCodeAt(o);return i}function Va(r){return new Promise((t,e)=>{if(typeof r=="string"){const s=new Image;s.src=r,s.onload=()=>{t(s)},s.onerror=()=>{e(new Error("Failed to load image from string"+r))};return}if(!(r instanceof File)){e(new Error("Input must be a File object"));return}const n=new FileReader;n.onload=()=>{i(n.result)};function i(s){if(r.name.endsWith(".dds")){const o=Vu(s),d=Wu(o),c=d.images[0],h=new Uint8Array(o,c.offset,c.length),g=d.format,p=c.shape[0],u=c.shape[1];t({width:p,height:u,format:g,buffer:h})}else{const o=new Image;o.name=r.name,o.src=s,o.onload=()=>{t(o)},o.onerror=()=>{t()}}}n.onerror=()=>{t()},n.readAsDataURL(r)})}var qu=ie('<img alt="img" class="svelte-yjkmgc">'),Zu=ie('<div id="canvas-container"></div>'),Yu=ie('<div class="container svelte-yjkmgc"><!></div>');function Ku(r,t){Ae(t,!0);const e=Ne.GetSingleton();function n(){return dt.dragData==null?!1:dt.dragData.menuSource=="file"}function i(h,g){n()&&h.preventDefault()}function s(h){h.preventDefault(),n()&&e.isCompositionActive()&&(dt.dragData.item.Contains(e.selectedFile)||(e.selectedFile.AddLayer(0,dt.dragData.item),e.updateScreen(),dt.dragData=null))}function o(){var h;if(e.selectedFile&&e.selectedFile){const g=document.getElementById("canvas-container");if(!g||!e.selectedFile)return;e.selectedFile instanceof Le?(e.selectedFile.RenderAsync(1024,1024,1024).then(()=>{g.firstChild!=e.selectedFile.canvas&&(g.innerHTML="",g.appendChild(e.selectedFile.canvas))}),(h=e.selectedFile.selectedLayer)==null||h.RenderAsync(300)):e.selectedFile instanceof Ue&&e.selectedFile.Render(1024,1024,!0).then(()=>{g.innerHTML="",g.appendChild(e.selectedFile.canvas)})}}pt(()=>{e.selectedFile,e.updateScreen()}),document.addEventListener("renderChanged",o);var d=Yu(),c=re(d);_e(c,()=>e.selectedFile instanceof Ut,h=>{var g=qu();be(()=>{var p,u;return $e(g,"src",(u=(p=e.selectedFile)==null?void 0:p.image)==null?void 0:u.src)}),$(h,g)},h=>{var g=Se(),p=ce(g);_e(p,()=>e.selectedFile instanceof Le||e.selectedFile instanceof Ue,u=>{var l=Zu();$(u,l)},null,!0),$(h,g)}),qe("dragover",d,i),qe("drop",d,s),$(r,d),Te()}var Ju=ie('<img class="thumb h-margin" alt="thumb">'),Qu=ie('<i class="fa-solid fa-layer-group h-margin" style="font-size: 1.5em;"></i>'),ec=ie('<div class="row"><div class="center flex1"><!> </div></div>'),tc=(r,t,e)=>t.removeLayer(e()),rc=ie('<button class="button" style="margin-left: 10px;"><i class="fa-solid fa-times icon"></i></button>');function nc(r,t){Ae(t,!1);const e=(c,h=Be,g=Be)=>{var p=ec(),u=re(p),l=re(u);_e(l,()=>h().thumbnail,v=>{var f=Ju();be(()=>$e(f,"src",h().thumbnail)),$(v,f)},v=>{var f=Qu();$(v,f)});var _=G(l);be(()=>Ge(_,` ${h().name??""}`)),$(c,p)},n=(c,h=Be,g=Be)=>{var p=rc();p.__click=[tc,s,g],$(c,p)},i=Ne.GetSingleton(),s=new Pt;Ze();var o=Se(),d=ce(o);Ke(d,()=>i.selectedFileHistory,c=>{Wi(c,{list:new Hi(i,"selectedFileHistory","selectedFileHistoryItem","file-history","tab-list",!1),io:s,rendering:new ji(e,n)})}),$(r,o),Te()}He(["click"]);let ss=null;class Is{constructor(){ge(this,"zindex",0)}static GetSingleton(){return ss==null&&(ss=new Is),ss}Push(){return this.zindex++}Pop(){this.zindex--}}var ic=ie('<div></div> <div><div class="modal svelte-p2pogs"><div class="modal-header svelte-p2pogs"><div class="svelte-p2pogs"> </div>  <div class="close-button svelte-p2pogs">X</div></div> <!></div></div>',1);function ur(r,t){Ae(t,!0);let e=Ee(t,"width",3,800),n=Ee(t,"height",3,600),i=Ee(t,"title",3,""),s=Ee(t,"onclose",3,()=>{});const o=Is.GetSingleton();let d=Q(!1),c=Q(0),h=Q(H(i()));function g(){V(c,H(o.Push())),V(d,!0)}function p(){o.Pop(),V(d,!1),s()()}function u(M){V(h,H(M))}var l=ic(),_=ce(l);_.__click=p;var v=G(_,2),f=re(v),b=re(f),w=re(b),x=re(w),k=G(w,2);k.__click=p;var E=G(b,2);return xt(E,()=>t.children),be(()=>{We(_,`modal-backdrop ${(a(d)?"open":"")??""} svelte-p2pogs`),$e(_,"style",`z-index:${a(c)??""}`),We(v,`modal-container ${(a(d)?"open":"")??""} svelte-p2pogs`),$e(v,"style",`z-index:${a(c)??""}`),$e(f,"style",`width: ${e()??""}px;height: ${n()??""}px`),Ge(x,a(h))}),$(r,l),Te({open:g,close:p,setTitle:u})}He(["click"]);var sc=(r,t)=>a(t).setHex(r.target.value),ac=(r,t)=>a(t).updateRGB(),oc=(r,t)=>a(t).updateRGB(),lc=(r,t)=>a(t).updateRGB(),uc=(r,t)=>a(t).AddThisColorToHistory(),cc=ie('<div class="color-history-container svelte-12f6idv"><div class="checker-small"></div> <div></div></div>'),dc=ie('<div class="row container"><div class="column"><div class="color-picker-container svelte-12f6idv"><div class="sb-box svelte-12f6idv"><div class="sb-circle svelte-12f6idv"></div></div> <div class="hue-box svelte-12f6idv"><div class="hue-bar svelte-12f6idv"></div></div></div> <div class="trackbar-container svelte-12f6idv" style="width:calc(100% - 20px);margin:10px;"><div class="checker-small"></div> <div class="trackbar-foreground svelte-12f6idv"></div> <div class="alpha-bar svelte-12f6idv"></div></div></div> <div class="row color-picker-row h-center svelte-12f6idv"><div class="col"><div class="input-group"><label>Hue</label> <input type="text" class="input"></div> <div class="input-group"><label>Saturation</label> <input type="text" class="input"></div> <div class="input-group"><label>Brightness</label> <input type="text" class="input"></div> <div class="input-group" style="position:relative"><label>Hex</label> <div class="hashtag svelte-12f6idv">#</div> <input type="text" class="input"></div></div> <div class="col"><div class="input-group"><label>Red</label> <input type="text" class="input"></div> <div class="input-group"><label>Green</label> <input type="text" class="input"></div> <div class="input-group"><label>Blue</label> <input type="text" class="input"></div> <div class="input-group" style="position:relative"><label>Alpha</label> <input type="text" class="input"></div></div> <div class="color-container svelte-12f6idv"><div class="checker-small"></div> <div class="color-foreground svelte-12f6idv"></div></div></div></div> <div class="color-history svelte-12f6idv"></div>',1);function hc(r,t){Ae(t,!1);const e=Je(Rt.GetSingleton());Ze();var n=he(()=>a(e).CloseEvent());et(ur(r,{width:800,height:600,title:"Color picker",get onclose(){return a(n)},children:(i,s)=>{var o=dc(),d=ce(o),c=re(d),h=re(c),g=re(h),p=ye(()=>a(e).svPicker.mouseDownEvent());g.__mousedown=function(...K){var Z;(Z=a(p))==null||Z.apply(this,K)};var u=re(g);et(u,K=>z(e,a(e).svPicker.cursorElement=K),()=>{var K,Z;return(Z=(K=a(e))==null?void 0:K.svPicker)==null?void 0:Z.cursorElement});var l=G(g,2),_=ye(()=>a(e).huePicker.mouseDownEvent());l.__mousedown=function(...K){var Z;(Z=a(_))==null||Z.apply(this,K)};var v=re(l);et(v,K=>z(e,a(e).huePicker.cursorElement=K),()=>{var K,Z;return(Z=(K=a(e))==null?void 0:K.huePicker)==null?void 0:Z.cursorElement});var f=G(h,2),b=ye(()=>a(e).alphaPicker.mouseDownEvent());f.__mousedown=function(...K){var Z;(Z=a(b))==null||Z.apply(this,K)};var w=G(re(f),4);et(w,K=>z(e,a(e).alphaPicker.cursorElement=K),()=>{var K,Z;return(Z=(K=a(e))==null?void 0:K.alphaPicker)==null?void 0:Z.cursorElement});var x=G(c,2),k=re(x),E=re(k),M=G(re(E),2),L=G(E,2),I=G(re(L),2),R=G(L,2),N=G(re(R),2),X=G(R,2),S=G(re(X),4);S.__input=[sc,e];var P=G(k,2),y=re(P),B=G(re(y),2);B.__input=[ac,e];var ae=G(y,2),W=G(re(ae),2);W.__input=[oc,e];var ue=G(ae,2),Y=G(re(ue),2);Y.__input=[lc,e];var se=G(ue,2),A=G(re(se),2),O=G(P,2);O.__click=[uc,e];var oe=G(d,2);gt(oe,5,()=>a(e).colorHistory,K=>K,(K,Z)=>{var we=cc(),fe=ye(()=>a(e).MouseDownEvent(a(Z)));we.__mousedown=function(...Me){var m;(m=a(fe))==null||m.apply(this,Me)};var pe=ye(()=>a(e).ColorHistoryClickEvent(a(Z)));we.__mouseup=function(...Me){var m;(m=a(pe))==null||m.apply(this,Me)};var ve=ye(()=>a(e).ColorHistoryContextMenuEvent(a(Z)));we.__contextmenu=function(...Me){var m;(m=a(ve))==null||m.apply(this,Me)};var Re=G(re(we),2);const Fe=he(()=>`color-history-item ${(a(Z)==a(e).GetRGBAHex()?"color-history-container-selected":"")??""} svelte-12f6idv`),Xe=he(()=>`--color-history-item-color:#${a(Z)??""};--color-history-item-color-no-alpha:#${a(Z).replace(/.{2}$/gi,"")??""};`);be(()=>{We(Re,a(Fe)),$e(Re,"style",a(Xe))}),$(K,we)}),be(()=>{$e(d,"style",`--color-picker-color:${a(e).red??""},${a(e).green??""},${a(e).blue??""};--color-picker-alpha:${a(e).alpha/255}`),$e(h,"style",`--sv-color-picker-color:${a(e).svRed??""},${a(e).svGreen??""},${a(e).svBlue??""};`)}),at(M,()=>a(e).hue,K=>z(e,a(e).hue=K)),at(I,()=>a(e).saturation,K=>z(e,a(e).saturation=K)),at(N,()=>a(e).brightness,K=>z(e,a(e).brightness=K)),at(S,()=>a(e).hex,K=>z(e,a(e).hex=K)),at(B,()=>a(e).red,K=>z(e,a(e).red=K)),at(W,()=>a(e).green,K=>z(e,a(e).green=K)),at(Y,()=>a(e).blue,K=>z(e,a(e).blue=K)),at(A,()=>a(e).alpha,K=>z(e,a(e).alpha=K)),$(i,o)},$$slots:{default:!0},$$legacy:!0}),i=>z(e,a(e).modal=i),()=>{var i;return(i=a(e))==null?void 0:i.modal}),Te()}He(["mousedown","input","click","mouseup","contextmenu"]);function fc(){return new Promise(r=>{const t=document.createElement("input");t.type="file",t.accept=".tcx",t.style.display="none",t.addEventListener("change",e=>r(e.target.files[0])),document.body.appendChild(t),t.click(),t.addEventListener("change",()=>document.body.removeChild(t))})}class vc{constructor(){this.zip=new Rs,this.images=this.zip.folder("Images")}WriteObject(t,e){this.zip.file(t+".json",JSON.stringify(e))}WriteImage(t,e){e&&this.images.file(t,e.replace(/^data:.*?;base64,/,""),{base64:!0})}Download(t){this.zip.generateAsync({type:"blob"}).then(function(e){Xa.saveAs(e,t)})}}function pc(r){return new Promise(t=>{const e=new FileReader;e.onloadend=function(){const n=e.result;t(n)},e.readAsDataURL(r)})}class Ds{constructor(t){this.zip=t,this.images=this.zip.folder("Images")}static async CreateAsync(t=null){t==null&&(t=await fc());const e=await t.arrayBuffer(),n=await Rs.loadAsync(e);return new Ds(n)}async GetObject(t){const e=this.zip.file(t+".json");return e==null?null:JSON.parse(await e.async("text"))}async GetText(t){return await this.zip.file(t).async("text")}async GetImage(t){const n=await this.images.file(t).async("blob"),i=new File([n],t.replace(/^Images\//gi,""),{type:n.type}),s=await Va(i);return[i,s]}async GetImageDataUrl(t){const e=this.images.file(t);if(!e)return null;const n=await e.async("blob");return await pc(n)}}class as{static Save(t){var h,g,p,u,l,_,v;const e=Ne.GetSingleton(),n=It.GetSingleton(),i=new vc,s=[],o=[];for(const f of e.files)if(f instanceof Ut)i.WriteImage(f.id+f.extension,f.image.src),i.WriteImage(f.id+"_thumb"+f.extension,f.thumbnail),s.push({type:"image",id:f.id,name:f.name,extension:f.extension});else if(f instanceof Le){const b=[];for(const w of f.layers)i.WriteImage(w.id+"_thumb.png",w.thumbnail),b.push({id:w.id,name:w.name,visible:w.visible,alpha:w.alpha,maskGroup:w.maskGroup,blendMode:w.blendMode,file:(h=w.file)==null?void 0:h.id,fileMask:(g=w.fileMask)==null?void 0:g.id,blurMask:(p=w.blurMask)==null?void 0:p.id,gradientMapColors:(u=w.gradientMapColors)==null?void 0:u.map(x=>({position:x.position,color:[...x.color]})),enableGradientMap:w.enableGradientMap,blurAmount:w.blurAmount,saturation:w.saturation,contrast:w.contrast,brightness:w.brightness,scale:w.scale,hue:w.hue,colorize:w.colorize,invert:w.invert,enableR:w.enableR,enableG:w.enableG,enableB:w.enableB,enableH:w.enableH,enableS:w.enableS,enableV:w.enableV,horizontalAlignment:w.horizontalAlignment,verticalAlignment:w.verticalAlignment,tile:w.tile,xOffset:w.xOffset,yOffset:w.yOffset});i.WriteImage(f.id+"_thumb.png",f.thumbnail),s.push({type:"composition",id:f.id,name:f.name,convertToNormal:f.convertToNormal,directXNormal:f.directXNormal,normalStrength:f.normalStrength,file:(l=f.file)==null?void 0:l.id,colors:f.colors?[...f.colors]:null,layers:b})}else f instanceof De?s.push({type:"folder",name:f.name,open:f.open,openCtx:f.openCtx}):f instanceof Ue&&(i.WriteImage(f.id+"_thumb.png",f.thumbnail),s.push({type:"pattern",name:f.name,color:f.color,gradient:(_=f.gradient)==null?void 0:_.map(b=>({position:b.position,color:[...b.color]})),fillType:f.fillType,x1:f.x1,y1:f.y1,angle:f.angle,radios:f.radios,id:f.id,scale:f.scale,time:f.time,octaves:f.octaves,persistence:f.persistence,disturbance:f.disturbance,contrast:f.contrast}));for(const f of n.outputs){const b=[],w=[];i.WriteImage(f.id+"_thumb.png",f.thumbnail);for(const x of f.files)b.push({file:x.file==null?null:x.file.id,baseFile:x.baseFile==null?null:x.baseFile.id});for(const x of f.colors)w.push({color:x.color,baseColor:x.baseColor});o.push({files:b,colors:w,enabled:f.enabled,name:f.name,id:f.id,base:(v=f.base)==null?void 0:v.id})}const c=Rt.GetSingleton().colorHistory;i.WriteObject("data",{projectName:e.projectName,files:s,outputs:o,colorHistory:c}),i.Download(t+".tcx")}static Load(t=null){const e=Ne.GetSingleton(),n=It.GetSingleton();Ds.CreateAsync(t).then(async i=>{var g,p;const s=await i.GetObject("data");if(s==null)return;e.files=[],e.selectedFile=null;const o=[],d=[],c={};for(const u of s.files)if(u.type=="image"){const[l,_]=await i.GetImage(u.id+u.extension),v=await i.GetImageDataUrl(u.id+"_thumb"+u.extension),f=new Ut;f.id=u.id,f.extension=u.extension,f.name=u.name,f.image=_,f.thumbnail=v,c[f.id]=f}else if(u.type=="pattern"){const l=new Ue;l.thumbnail=await i.GetImageDataUrl(u.id+"_thumb.png"),l.color=u.color,l.id=u.id,l.canvas=document.createElement("canvas"),l.fillType=u.fillType,l.gradient=(g=u.gradient)==null?void 0:g.map(_=>{const v=new wt;return v.position=_.position,v.color=[..._.color],v}),l.x1=u.x1,l.y1=u.y1,l.angle=u.angle,l.radios=u.radios,l.scale=u.scale,l.time=u.time,l.octaves=u.octaves,l.persistence=u.persistence,l.disturbance=u.disturbance,l.contrast=u.contrast,l.name=u.name,c[l.id]=l}else if(u.type=="composition"){const l=new Le;l.thumbnail=await i.GetImageDataUrl(u.id+"_thumb.png"),l.name=u.name,l.id=u.id,l.canvas=document.createElement("canvas"),l.image=l.canvas,l.colors=u.colors?[...u.colors]:null,l.convertToNormal=u.convertToNormal,l.directXNormal=u.directXNormal,l.normalStrength=u.normalStrength,c[l.id]=l}for(const u of s.files)if(u.type=="image")d.push(c[u.id]);else if(u.type=="composition"){const l=c[u.id];l.file=u.file?c[u.file]:null;for(const _ of u.layers){const v=new Ii;v.thumbnail=await i.GetImageDataUrl(_.id+"_thumb.png"),v.id=_.id,v.name=_.name,v.visible=_.visible,v.alpha=_.alpha,v.maskGroup=_.maskGroup,v.blendMode=_.blendMode,v.file=_.file==null?null:c[_.file],v.fileMask=_.fileMask==null?null:c[_.fileMask],v.blurMask=_.blurMask==null?null:c[_.blurMask],v.gradientMapColors=(p=_.gradientMapColors)==null?void 0:p.map(f=>{const b=new wt;return b.position=f.position,b.color=[...f.color],b}),v.enableGradientMap=_.enableGradientMap,v.blurAmount=_.blurAmount,v.saturation=_.saturation,v.contrast=_.contrast,v.brightness=_.brightness,v.scale=_.scale,v.hue=_.hue,v.colorize=_.colorize,v.invert=_.invert,v.enableR=_.enableR,v.enableG=_.enableG,v.enableB=_.enableB,v.enableH=_.enableH,v.enableS=_.enableS,v.enableV=_.enableV,v.horizontalAlignment=_.horizontalAlignment,v.verticalAlignment=_.verticalAlignment,v.tile=_.tile,v.xOffset=_.xOffset,v.yOffset=_.yOffset,l.layers.push(v)}d.push(l)}else if(u.type=="folder"){const l=new De;l.name=u.name,l.open=u.open,l.openCtx=u.openCtx,d.push(l)}else u.type=="pattern"&&d.push(c[u.id]);if(s.outputs)for(const u of s.outputs){const l=new Yt;l.id=u.id,l.name=u.name,l.enabled=u.enabled??!0,l.base=c[u.base],l.thumbnail=await i.GetImageDataUrl(l.id+"_thumb.png");for(const _ of u.files){const v=new Pi;v.file=_.file==null?null:c[_.file],v.baseFile=_.baseFile==null?null:c[_.baseFile],l.files.push(v)}for(const _ of u.colors){const v=new Di;v.color=_.color,v.baseColor=_.baseColor,l.colors.push(v)}o.push(l)}n.outputs=o,e.files=d,e.selectedFileHistory=[],e.historyIndex=-1,e.history=[],e.selectedFile=null,e.projectName=s.projectName;const h=Rt.GetSingleton();h.colorHistory=s.colorHistory})}}var mc=(r,t)=>V(t,!0),gc=ie('<div class="separator svelte-1cdjth6"> </div>'),_c=(r,t)=>t.action(),bc=ie('<div class="link svelte-1cdjth6"><i></i> </div>'),yc=ie('<div class="dropdown svelte-1cdjth6"><button class="dropdown-button svelte-1cdjth6"><!></button> <div></div></div>');function ha(r,t){Ae(t,!0);let e,n=Q(!1);Bi(()=>{document.addEventListener("click",c=>{e!=null&&e.contains(c.target)||V(n,!1)})});var i=yc(),s=re(i);s.__click=[mc,n];var o=re(s);xt(o,()=>t.children??Be),et(s,c=>e=c,()=>e);var d=G(s,2);gt(d,20,()=>t.options,c=>c,(c,h)=>{var g=Se(),p=ce(g);_e(p,()=>h instanceof De,u=>{var l=gc(),_=re(l);be(()=>Ge(_,h.name)),$(u,l)},u=>{var l=bc();l.__click=[_c,h];var _=re(l),v=G(_);be(()=>{We(_,`${h.icon??""} svelte-1cdjth6`),Ge(v,` ${h.name??""}`)}),$(u,l)}),$(c,g)}),be(()=>We(d,`dropdown-content ${(a(n)?"open":"")??""} svelte-1cdjth6`)),$(r,i),Te()}He(["click"]);var wc=ie('<i class="fa-solid fa-diagram-project"></i> Project',1),xc=ie('<i class="fa-solid fa-file"></i> File',1),kc=(r,t)=>t.Open(),Sc=ie('<!> <!> <button class="button main-menu-button svelte-qlvpc3"><i class="fa-regular fa-image"></i> Render</button> <input type="file" accept="image/*" hidden multiple>',1);function Cc(r,t){Ae(t,!1);const e=Je(Ne.GetSingleton()),n=It.GetSingleton(),i=Pt.GetFileListSingleton(),s=kt.GetSingleton();let o=Je();function d(){a(o).click()}function c(){a(e).addComposition(),select(a(e).files.length-1)}function h(w){for(const x of w)Va(x).then(k=>{k&&a(e).addImage(x,k)})}i.uploadMedias=d,Bi(async()=>{a(e).addComposition(),a(o).addEventListener("input",()=>{h(a(o).files)})}),document.body.addEventListener("dragover",w=>{if(w.dataTransfer&&w.dataTransfer.items)for(const x of w.dataTransfer.items)x.kind==="file"&&w.preventDefault()}),document.body.addEventListener("drop",w=>{w.preventDefault();const x=w.dataTransfer.files;if(x.length===1){const k=x[0];if(k.name.endsWith(".tcx")){s.Prompt("Are you sure you want to load this project?",()=>{as.Load(k)});return}}h(w.dataTransfer.files)});const g=lr.GetSingleton();Ze();var p=Sc(),u=ce(p),l=he(()=>[{name:"Save",icon:"fa-solid fa-download",action:()=>g.Prompt("Save Project",a(e).projectName,w=>{z(e,a(e).projectName=w),as.Save(w)})},{name:"Load",icon:"fa-solid fa-upload",action:()=>as.Load()}]);ha(u,{get options(){return a(l)},children:(w,x)=>{var k=wc();$(w,k)},$$slots:{default:!0}});var _=G(u,2),v=he(()=>[new De("Upload"),{name:"Images",icon:"fa-solid fa-image",action:d},new De("Add"),{name:"Composition",icon:"fa-solid fa-layer-group",action:c},{name:"Folder",icon:"fa-solid fa-folder",action:()=>a(e).addFolder()},new De("Create Fill"),{name:"Color",icon:"fa-solid fa-droplet",action:()=>a(e).addColor()},{name:"Linear Gradient",icon:"fa-solid fa-swatchbook",action:()=>a(e).addLinearGradient()},{name:"Radial Gradient",icon:"fa-solid fa-swatchbook",action:()=>a(e).addRadialGradient()},{name:"Perlin Noise",icon:"fa-solid fa-mountain-sun",action:()=>a(e).addPerlinNoise()},{name:"Voronoi Noise",icon:"fa-solid fa-mountain-sun",action:()=>a(e).addVoronoiNoise()},{name:"Grain Noise",icon:"fa-solid fa-mountain-sun",action:()=>a(e).addGrainNoise()}]);ha(_,{get options(){return a(v)},children:(w,x)=>{var k=xc();$(w,k)},$$slots:{default:!0}});var f=G(_,2);f.__click=[kc,n];var b=G(f,2);et(b,w=>V(o,w),()=>a(o)),$(r,p),Te()}He(["click"]);var Ec=ie('<div class="button-container svelte-1alqnia"><button class="button full"><!></button></div>');function Ve(r,t){Ae(t,!0);var e=Ec(),n=re(e);n.__click=function(...s){var o;(o=t.action)==null||o.apply(this,s)};var i=re(n);xt(i,()=>t.children),$(r,e),Te()}He(["click"]);var Fc=(r,t,e)=>V(t,H(e()?!1:!a(t))),Ac=(r,t)=>t(null),Tc=ie('<div class="option svelte-1jq2j9y"> </div>'),Rc=ie('<div class="separator svelte-1jq2j9y"> <i></i></div>'),Ic=(r,t,e)=>t(e),Dc=ie('<div class="option svelte-1jq2j9y"><!></div>'),Pc=ie('<div class="options open svelte-1jq2j9y"><!> <!></div>'),Lc=ie('<div class="dropdown  svelte-1jq2j9y"><div><i class="fa-solid fa-angle-down" style="margin-right: 10px;"></i> <!></div> <!></div>');function cr(r,t){Ae(t,!0);let e=Ee(t,"value",15),n=Ee(t,"placeholder",3,"None"),i=Ee(t,"renderFunction",3,null),s=Ee(t,"oninput",3,()=>{}),o=Ee(t,"filter",3,()=>!0),d=Ee(t,"disabled",3,!1),c=Ee(t,"hasNone",3,!0),h=Q(!1),g,p=Q(void 0);function u(k){var E;V(h,!1),e(k),(E=s())==null||E()}function l(){let k=g;for(;k&&window.getComputedStyle(k).overflow!="auto";)k=k.parentElement;return k}Bi(()=>{document.addEventListener("click",E=>{g!=null&&g.contains(E.target)||V(h,!1)});const k=l();k==null||k.addEventListener("scroll",()=>{if(a(p)){const E=k.scrollTop;a(p).style.transform=`translateY(-${E}px)`}})}),pt(()=>{if(a(p)){const E=l().scrollTop;a(p).style.transform=`translateY(-${E}px)`;const M=a(p).getBoundingClientRect(),L=window.innerHeight;if(M.bottom>L){const I=M.bottom-L;a(p).style.transform=`translateY(-${E+I}px)`}}});function _(k){return E=>{k.openCtx=!k.openCtx}}function v(k){for(let E=k-1;E>=0;(E-=1)+1)if(t.options[E].type=="separator")return t.options[E].openCtx;return!0}var f=Lc(),b=re(f);b.__click=[Fc,h,d];var w=G(re(b),2);_e(w,e,k=>{var E=Se(),M=ce(E);_e(M,i,L=>{var I=Se(),R=ce(I);xt(R,i,e),$(L,I)},L=>{var I=ke();be(()=>Ge(I,e().name)),$(L,I)}),$(k,E)},k=>{var E=ke();be(()=>Ge(E,n())),$(k,E)});var x=G(b,2);_e(x,()=>a(h),k=>{var E=Pc(),M=re(E);_e(M,c,I=>{var R=Tc();R.__click=[Ac,u];var N=re(R);be(()=>Ge(N,n())),$(I,R)});var L=G(M,2);gt(L,18,()=>t.options,I=>I,(I,R,N)=>{var X=Se(),S=ce(X);_e(S,()=>R.type=="separator",P=>{var y=Rc(),B=ye(()=>_(R));y.__click=function(...ue){var Y;(Y=a(B))==null||Y.apply(this,ue)};var ae=re(y),W=G(ae);be(()=>{Ge(ae,`${R.name??""} `),We(W,`separator-icon fa-solid ${(R.openCtx?"fa-angle-left":"fa-angle-down")??""} svelte-1jq2j9y`)}),$(P,y)},P=>{var y=Se(),B=ce(y);_e(B,()=>o()(R)&&v(a(N)),ae=>{var W=Dc();W.__click=[Ic,u,R];var ue=re(W);_e(ue,i,Y=>{var se=Se(),A=ce(se);xt(A,i,()=>R),$(Y,se)},Y=>{var se=ke();be(()=>Ge(se,R.name)),$(Y,se)}),$(ae,W)}),$(P,y)}),$(I,X)}),et(E,I=>V(p,I),()=>a(p)),$(k,E)}),et(f,k=>g=k,()=>g),be(()=>We(b,`selected row v-center ${(d()?"disabled":"")??""} svelte-1jq2j9y`)),$(r,f),Te()}He(["click"]);var $c=ie('<img class="thumb  h-margin" alt="thumb">'),Oc=ie('<i class="fa-solid fa-file icon"></i>'),Gc=ie('<div class="v-center"><!> </div>'),Mc=ie('<div class="range-container"><!></div>');function Ft(r,t){Ae(t,!0);let e=Ee(t,"value",15),n=Ee(t,"oninput",3,()=>{}),i=Ee(t,"filter",3,()=>!0);const s=Ne.GetSingleton();function o(){return dt.dragData==null?!1:dt.dragData.menuSource=="file"}function d(p,u){o()&&p.preventDefault()}function c(p){p.preventDefault(),o()&&s.isCompositionActive()&&(dt.dragData.item.Contains(s.selectedFile)||(e(dt.dragData.item),n()(e()),dt.dragData=null))}var h=Mc();{const p=(u,l=Be)=>{var _=Gc(),v=re(_);_e(v,()=>l().thumbnail,b=>{var w=$c();be(()=>$e(w,"src",l().thumbnail)),$(b,w)},b=>{var w=Oc();$(b,w)});var f=G(v);be(()=>Ge(f,` ${l().name??""}`)),$(u,_)};var g=re(h);cr(g,{get value(){return e()},set value(u){e(u)},get options(){return s.files},get filter(){return i()},renderFunction:p,oninput:()=>{s.updateScreen(),n()(e())}})}qe("dragover",h,d),qe("drop",h,c),$(r,h),Te()}var Uc=ie('<div class="range-container"><input type="text"></div>');function Ps(r,t){let e=Ee(t,"value",15);var n=Uc(),i=re(n);at(i,e),$(r,n)}var zc=ie('<div class="menu-item"><div><i></i> </div> <div><!></div></div>'),Bc=ie('<div class="menu svelte-ggcc9p"></div>');function qi(r,t){let e=Q(H([]));function n(s,o){s!==!1&&(a(e).includes(o)?V(e,H(a(e).filter(d=>d!==o))):a(e).push(o))}var i=Bc();gt(i,22,()=>t.tabs,s=>s,(s,o,d)=>{var c=Se(),h=ce(c);_e(h,()=>o.enabled!==!1,g=>{var p=zc(),u=re(p);const l=ye(()=>`menu-header ${(o.defaultOpen?a(e).includes(a(d))?"":"open":a(e).includes(a(d))?"open":"")??""} svelte-ggcc9p`);u.__click=()=>n(o.enabled,a(d));var _=re(u),v=G(_),f=G(u,2);const b=ye(()=>`menu-content ${(o.defaultOpen?a(e).includes(a(d))?"":"open":a(e).includes(a(d))?"open":"")??""} svelte-ggcc9p`);var w=re(f);xt(w,()=>o.element??Be),be(()=>{We(u,a(l)),We(_,`${o.icon??""} svelte-ggcc9p`),Ge(v,` ${o.title??""}`),We(f,a(b))}),$(g,p)}),$(s,c)}),$(r,i)}He(["click"]);var Nc=(r,t,e)=>{t(!t()),e()()},jc=ie('<div class="toggle-container svelte-1ibgq8q"><button class="button full"><i></i> <!></button></div>');function nt(r,t){Ae(t,!0);let e=Ee(t,"value",15),n=Ee(t,"oninput",3,()=>{});var i=jc(),s=re(i);s.__click=[Nc,e,n];var o=re(s),d=G(o,2);xt(d,()=>t.children),be(()=>We(o,`fa-regular ${(e()?"fa-circle-dot":"fa-circle")??""}`)),$(r,i),Te()}He(["click"]);var Hc=(r,t,e)=>{t()(),e()(r)},Xc=ie('<button class="button svelte-9d7k71">Reset</button>'),Wc=(r,t)=>t()(r),Vc=(r,t)=>t()(r),qc=ie('<div class="range-container svelte-9d7k71"><!> <input type="number" class="svelte-9d7k71"> <input type="range" class="svelte-9d7k71"></div>');function Oe(r,t){Ae(t,!0);let e=Ee(t,"value",15),n=Ee(t,"reset",3,null),i=Ee(t,"oninput",3,()=>{});var s=qc(),o=re(s);_e(o,()=>n()!=null,h=>{var g=Xc();g.__click=[Hc,n,i],$(h,g)});var d=G(o,2);d.__change=[Wc,i];var c=G(d,2);c.__change=[Vc,i],be(()=>{$e(c,"min",t.min),$e(c,"max",t.max),$e(c,"step",t.step)}),at(d,e),at(c,e),$(r,s),Te()}He(["click","change"]);var Zc=ie('<label class="svelte-1xo8zpe">Normal Strength</label> <!> <label class="svelte-1xo8zpe">DirectX Normal</label> <!>',1),Yc=ie('<label class="svelte-1xo8zpe">Convert to normal</label> <!> <!>',1),Kc=ie('<img class="thumb h-margin svelte-1xo8zpe" alt="thumb">'),Jc=ie('<i class="fa-solid fa-layer-group h-margin svelte-1xo8zpe" style="font-size: 3em;"></i>'),Qc=ie('<div class="v-center flex1 swap-item svelte-1xo8zpe"><!> <!></div>'),ed=ie('<label class="svelte-1xo8zpe">Mask File</label> <!> <label class="svelte-1xo8zpe">Layer files</label> <!>',1),td=ie("<label>Mask File</label> <!>",1),rd=ie('<div class="margin-bottom-30"><!></div>  <!>',1);function nd(r,t){Ae(t,!1);const e=Je(Ne.GetSingleton());Ze();var n=Se(),i=ce(n);_e(i,()=>a(e).selectedFile&&a(e).selectedFile instanceof Le,s=>{var o=rd();const d=u=>{var l=Yc(),_=G(ce(l),2);nt(_,{get value(){return a(e).selectedFile.convertToNormal},set value(f){z(e,a(e).selectedFile.convertToNormal=f)},oninput:()=>{a(e).updateScreen()},children:(f,b)=>{var w=ke("Convert to normal");$(f,w)},$$slots:{default:!0},$$legacy:!0});var v=G(_,2);_e(v,()=>a(e).selectedFile.convertToNormal,f=>{var b=Zc(),w=G(ce(b),2);Oe(w,{get value(){return a(e).selectedFile.normalStrength},set value(k){z(e,a(e).selectedFile.normalStrength=k)},reset:()=>z(e,a(e).selectedFile.normalStrength=10),min:0,max:30,step:.1,oninput:()=>{a(e).updateScreen()},$$legacy:!0});var x=G(w,4);nt(x,{get value(){return a(e).selectedFile.directXNormal},set value(k){z(e,a(e).selectedFile.directXNormal=k)},oninput:()=>{a(e).updateScreen()},children:(k,E)=>{var M=ke("DirectX Normal");$(k,M)},$$slots:{default:!0},$$legacy:!0}),$(f,b)}),$(u,l)},c=u=>{var l=Se(),_=ce(l);Ke(_,()=>a(e).historyIndex,v=>{var f=ed(),b=G(ce(f),2);Ft(b,{get value(){return a(e).selectedFile.file},set value(x){z(e,a(e).selectedFile.file=x)},filter:x=>!x.Contains(a(e).selectedFile),oninput:()=>{var x;(x=a(e).selectedFile)==null||x.GenerateMask(),a(e).updateScreen()},$$legacy:!0});var w=G(b,4);gt(w,1,()=>a(e).selectedFile.GetUniqueFiles(),x=>x,(x,k)=>{var E=Se(),M=ce(E);_e(M,()=>a(k)!=a(e).selectedFile.file,L=>{var I=Qc(),R=re(I);_e(R,()=>a(k).thumbnail,X=>{var S=Kc();be(()=>$e(S,"src",a(k).thumbnail)),$(X,S)},X=>{var S=Jc();$(X,S)});var N=G(R,2);Ft(N,{get value(){return a(k).file},set value(X){a(k).file=X,Ua(()=>a(e).selectedFile.GetUniqueFiles())},filter:X=>!X.Contains(a(e).selectedFile),oninput:X=>{a(e).selectedFile.ReplaceFile(a(k),X),a(e).updateScreen(),a(e).selectedFile.updateAllLayers()},$$legacy:!0}),$(L,I)}),$(x,E)}),$(v,f)}),$(u,l)};var h=ce(o),g=re(h);Ke(g,()=>a(e).selectedFile,u=>{var l=Se(),_=ce(l);Ke(_,()=>a(e).historyIndex,v=>{var f=td(),b=G(ce(f),2);Ft(b,{get value(){return a(e).selectedFile.file},set value(w){z(e,a(e).selectedFile.file=w)},filter:w=>!w.Contains(a(e).selectedFile),oninput:()=>{var w;(w=a(e).selectedFile)==null||w.GenerateMask(),a(e).updateScreen()},$$legacy:!0}),$(v,f)}),$(u,l)});var p=G(h,2);qi(p,{tabs:[{title:"Normal Output",icon:"fa-solid fa-mountain",element:d},{title:"Texture swap",icon:"fa-solid fa-arrows-rotate",element:c}]}),$(s,o)}),$(r,n),Te()}var id=ie('<div class="option-container svelte-y6icpw"><div class="color-option svelte-y6icpw"></div> </div>');function sd(r,t){Ae(t,!0);const e=(o,d=Be)=>{var c=id(),h=re(c);const g=ye(()=>`background-color: #${zt(...d())??""};`);var p=G(h);be(()=>Ge(p,`#${zt(...d())??""}`)),be(()=>$e(h,"style",a(g))),$(o,c)};let n=Ee(t,"value",15),i=Ee(t,"placeholder",3,"None");Ee(t,"renderFunction",3,null);let s=Ee(t,"oninput",3,()=>{});cr(r,{get placeholder(){return i()},get value(){return n()},set value(o){n(o)},get options(){return t.options},renderFunction:e,get oninput(){return s()}}),Te()}var ad=ie('<div class="option-container svelte-y6icpw"> </div>');function qa(r,t){const e=(d,c=Be)=>{var h=ad(),g=re(h);be(()=>Ge(g,c().name)),$(d,h)};let n=Ee(t,"value",15),i=Ee(t,"placeholder",3,"None");Ee(t,"renderFunction",3,null);let s=Ee(t,"disabled",3,!1),o=Ee(t,"oninput",3,()=>{});cr(r,{get disabled(){return s()},get placeholder(){return i()},get value(){return n()},set value(d){n(d)},get options(){return t.options},renderFunction:e,get oninput(){return o()}})}var od=ie('<div><div class="caret svelte-gwpoew"></div> <div class="square svelte-gwpoew"></div></div>'),ld=ie('<div class="gradient-picker svelte-gwpoew"><div class="gradient-checker checker-small svelte-gwpoew"></div> <div class="gradient-bg svelte-gwpoew"></div>  <div class="picker-area svelte-gwpoew"></div> <!></div>');function Ht(r,t){Ae(t,!0);const e=Ee(t,"oninput",3,()=>{}),n=new Gl(t.value,e());var i=ld(),s=G(re(i),2);const o=ye(()=>`--gradient:${n.GetGradient()??""}`);var d=G(s,2),c=ye(()=>n.AddItemEvent());d.__mousedown=function(...g){var p;(p=a(c))==null||p.apply(this,g)};var h=G(d,2);gt(h,17,()=>n.items,vs,(g,p)=>{var u=od(),l=ye(()=>a(p).MouseDownEvent());u.__mousedown=function(...f){var b;(b=a(l))==null||b.apply(this,f)};var _=ye(()=>a(p).DoubleClickEvent());u.__dblclick=function(...f){var b;(b=a(_))==null||b.apply(this,f)};var v=ye(()=>a(p).ContextMenuEvent());u.__contextmenu=function(...f){var b;(b=a(v))==null||b.apply(this,f)},et(u,(f,b)=>b.element=f,f=>f==null?void 0:f.element,()=>[a(p)]),be(()=>{We(u,`picker-container ${(a(p).dragging?"picker-container-active":"")??""} ${(a(p).isRemovingCandidate?"hidden":"")??""} svelte-gwpoew`),$e(u,"style",`--picker-color:${a(p).color[0]??""}, ${a(p).color[1]??""}, ${a(p).color[2]??""}`)}),$(g,u)}),be(()=>$e(s,"style",a(o))),$(r,i),Te()}He(["mousedown","dblclick","contextmenu"]);var ud=ie("<label>File</label> <!> <label>Reset All Properties</label> <!>",1),cd=ie("<label>Alpha</label> <!>",1),dd=ie('<!> <label>Blend Mode</label> <!> <label>Override Channels</label> <div class="row"><!> <!> <!></div> <label>Affect Channels</label> <div class="row"><!> <!> <!></div>',1),hd=ie("<label>Horizontal Alignment</label> <!> <label>Vertical Alignment</label> <!> <label>Tile</label> <!> <label>X Offset</label> <!> <label>Y Offset</label> <!> <label>Scale</label> <!>",1),fd=ie("<label>Mask Group</label> <!> <label>Mask File</label> <!>",1),vd=ie('<!> <label>Blur Mask</label> <!> <div class="separator"></div> <label>Invert</label> <!> <label>Gradient map</label> <!> <!>',1),pd=ie("<label>Blur Amount</label> <!>",1),md=ie('<label>Contrast</label> <!> <label>Brightness</label> <!> <div class="separator"></div> <label>Saturation</label> <!> <label>Hue</label> <!> <label>Colorize</label> <!>',1);function gd(r,t){Ae(t,!1);const e=Je(Ne.GetSingleton()),n=kt.GetSingleton();function i(){a(e).getSelectedLayer().ResetAdjustments(),z(e,a(e).selectedFile.selectedLayer.maskGroup=null),z(e,a(e).selectedFile.selectedLayer.blendMode=null),a(e).updateScreen(),u()()}function s(){a(e).getSelectedLayer().ResetAlpha(),a(e).updateScreen()}function o(){a(e).getSelectedLayer().ResetBlurAmount(),a(e).updateScreen()}function d(){a(e).getSelectedLayer().ResetScale(),a(e).updateScreen()}function c(){a(e).getSelectedLayer().ResetSaturation(),a(e).updateScreen()}function h(){a(e).getSelectedLayer().ResetHue(),a(e).updateScreen()}function g(){a(e).getSelectedLayer().ResetContrast(),a(e).updateScreen()}function p(){a(e).getSelectedLayer().ResetBrightness(),a(e).updateScreen()}function u(f){return()=>{a(e).updateScreen()}}const l=[new De("Darkening Modes"),{name:"Color Burn",value:3},{name:"Darken",value:5},{name:"Linear Burn",value:12},{name:"Multiply",value:15},{name:"Subtract",value:24},new De("Lightening Modes"),{name:"Add",value:1},{name:"Color Dodge",value:4},{name:"Glow",value:8},{name:"Lighten",value:11},{name:"Linear Dodge",value:13},{name:"Screen",value:22},new De("Contrast Modes"),{name:"Hard Light",value:9},{name:"Hard Mix",value:10},{name:"Linear Light",value:14},{name:"Overlay",value:18},{name:"Pin Light",value:20},{name:"Soft Light",value:23},{name:"Vivid Light",value:25},new De("Comparative Modes"),{name:"Difference",value:6},{name:"Exclusion",value:7},{name:"Negation",value:16},{name:"Phoenix",value:19},new De("Other Modes"),{name:"Average",value:2},{name:"Reflect",value:21}];Ze();var _=Se(),v=ce(_);_e(v,()=>{var f;return(f=a(e).selectedFile)==null?void 0:f.selectedLayer},f=>{qi(f,{tabs:[{title:"Basic",icon:"fa-solid fa-gears",element:L=>{var I=Se(),R=ce(I);Ke(R,()=>a(e).historyIndex,N=>{var X=ud(),S=G(ce(X),2),P=he(()=>u());Ft(S,{get value(){return a(e).selectedFile.selectedLayer.file},set value(B){z(e,a(e).selectedFile.selectedLayer.file=B)},get oninput(){return a(P)},filter:B=>!B.Contains(a(e).selectedFile),$$legacy:!0});var y=G(S,4);Ve(y,{action:()=>n.Prompt("Are you sure you want to reset all properties?",i),children:(B,ae)=>{var W=ke("Reset All Properties");$(B,W)},$$slots:{default:!0}}),$(N,X)}),$(L,I)}},{title:"Positioning",icon:"fa-solid fa-arrows-up-down-left-right",element:L=>{var I=hd(),R=G(ce(I),2),N=he(()=>u());cr(R,{hasNone:!1,get value(){return a(e).selectedFile.selectedLayer.horizontalAlignment},set value(A){z(e,a(e).selectedFile.selectedLayer.horizontalAlignment=A)},options:[{name:"Left",value:0},{name:"Center",value:1},{name:"Right",value:2}],get oninput(){return a(N)},$$legacy:!0});var X=G(R,4),S=he(()=>u());cr(X,{hasNone:!1,get value(){return a(e).selectedFile.selectedLayer.verticalAlignment},set value(A){z(e,a(e).selectedFile.selectedLayer.verticalAlignment=A)},options:[{name:"Top",value:0},{name:"Center",value:1},{name:"Bottom",value:2}],get oninput(){return a(S)},$$legacy:!0});var P=G(X,4),y=he(()=>u());nt(P,{get value(){return a(e).selectedFile.selectedLayer.tile},set value(A){z(e,a(e).selectedFile.selectedLayer.tile=A)},get oninput(){return a(y)},children:(A,O)=>{var oe=ke("Tile");$(A,oe)},$$slots:{default:!0},$$legacy:!0});var B=G(P,4),ae=he(()=>u());Oe(B,{get value(){return a(e).selectedFile.selectedLayer.xOffset},set value(A){z(e,a(e).selectedFile.selectedLayer.xOffset=A)},min:-1,max:1,step:.001,reset:()=>z(e,a(e).selectedFile.selectedLayer.xOffset=0),get oninput(){return a(ae)},$$legacy:!0});var W=G(B,4),ue=he(()=>u());Oe(W,{get value(){return a(e).selectedFile.selectedLayer.yOffset},set value(A){z(e,a(e).selectedFile.selectedLayer.yOffset=A)},min:-1,max:1,step:.001,reset:()=>z(e,a(e).selectedFile.selectedLayer.yOffset=0),get oninput(){return a(ue)},$$legacy:!0});var Y=G(W,4),se=he(()=>u());Oe(Y,{get value(){return a(e).selectedFile.selectedLayer.scale},set value(A){z(e,a(e).selectedFile.selectedLayer.scale=A)},min:0,max:500,step:10,reset:d,get oninput(){return a(se)},$$legacy:!0}),$(L,I)}},{title:"Mask",icon:"fa-solid fa-mask",element:L=>{var I=Se(),R=ce(I);Ke(R,()=>a(e).historyIndex,N=>{var X=fd(),S=G(ce(X),2),P=he(()=>u());sd(S,{get options(){return a(e).selectedFile.colors},get value(){return a(e).selectedFile.selectedLayer.maskGroup},set value(ae){z(e,a(e).selectedFile.selectedLayer.maskGroup=ae)},get oninput(){return a(P)},$$legacy:!0});var y=G(S,4),B=he(()=>u());Ft(y,{get value(){return a(e).selectedFile.selectedLayer.fileMask},set value(ae){z(e,a(e).selectedFile.selectedLayer.fileMask=ae)},filter:ae=>!ae.Contains(a(e).selectedFile),get oninput(){return a(B)},$$legacy:!0}),$(N,X)}),$(L,I)}},{title:"Blending",icon:"fa-solid fa-object-group",element:L=>{var I=dd(),R=ce(I);Ke(R,()=>a(e).historyIndex,fe=>{var pe=cd(),ve=G(ce(pe),2),Re=he(()=>u());Oe(ve,{get value(){return a(e).selectedFile.selectedLayer.alpha},set value(Fe){z(e,a(e).selectedFile.selectedLayer.alpha=Fe)},min:0,max:100,step:.01,reset:s,get oninput(){return a(Re)},$$legacy:!0}),$(fe,pe)});var N=G(R,4),X=he(()=>u()),S=he(()=>a(e).selectedFile.selectedLayer.enableH||a(e).selectedFile.selectedLayer.enableS||a(e).selectedFile.selectedLayer.enableV);qa(N,{options:l,get value(){return a(e).selectedFile.selectedLayer.blendMode},set value(fe){z(e,a(e).selectedFile.selectedLayer.blendMode=fe)},get oninput(){return a(X)},get disabled(){return a(S)},$$legacy:!0});var P=G(N,4),y=re(P),B=he(()=>u());nt(y,{get value(){return a(e).selectedFile.selectedLayer.enableH},set value(fe){z(e,a(e).selectedFile.selectedLayer.enableH=fe)},get oninput(){return a(B)},children:(fe,pe)=>{var ve=ke("H");$(fe,ve)},$$slots:{default:!0},$$legacy:!0});var ae=G(y,2),W=he(()=>u());nt(ae,{get value(){return a(e).selectedFile.selectedLayer.enableS},set value(fe){z(e,a(e).selectedFile.selectedLayer.enableS=fe)},get oninput(){return a(W)},children:(fe,pe)=>{var ve=ke("S");$(fe,ve)},$$slots:{default:!0},$$legacy:!0});var ue=G(ae,2),Y=he(()=>u());nt(ue,{get value(){return a(e).selectedFile.selectedLayer.enableV},set value(fe){z(e,a(e).selectedFile.selectedLayer.enableV=fe)},get oninput(){return a(Y)},children:(fe,pe)=>{var ve=ke("V");$(fe,ve)},$$slots:{default:!0},$$legacy:!0});var se=G(P,4),A=re(se),O=he(()=>u());nt(A,{get value(){return a(e).selectedFile.selectedLayer.enableR},set value(fe){z(e,a(e).selectedFile.selectedLayer.enableR=fe)},get oninput(){return a(O)},children:(fe,pe)=>{var ve=ke("R");$(fe,ve)},$$slots:{default:!0},$$legacy:!0});var oe=G(A,2),K=he(()=>u());nt(oe,{get value(){return a(e).selectedFile.selectedLayer.enableG},set value(fe){z(e,a(e).selectedFile.selectedLayer.enableG=fe)},get oninput(){return a(K)},children:(fe,pe)=>{var ve=ke("G");$(fe,ve)},$$slots:{default:!0},$$legacy:!0});var Z=G(oe,2),we=he(()=>u());nt(Z,{get value(){return a(e).selectedFile.selectedLayer.enableB},set value(fe){z(e,a(e).selectedFile.selectedLayer.enableB=fe)},get oninput(){return a(we)},children:(fe,pe)=>{var ve=ke("B");$(fe,ve)},$$slots:{default:!0},$$legacy:!0}),$(L,I)}},{title:"Effects",icon:"fa-solid fa-bolt",element:L=>{var I=pd(),R=G(ce(I),2);Ke(R,()=>a(e).historyIndex,N=>{var X=vd(),S=ce(X),P=he(()=>u());Oe(S,{get value(){return a(e).selectedFile.selectedLayer.blurAmount},set value(A){z(e,a(e).selectedFile.selectedLayer.blurAmount=A)},min:0,max:100,step:.01,reset:o,get oninput(){return a(P)},$$legacy:!0});var y=G(S,4),B=he(()=>u());Ft(y,{get value(){return a(e).selectedFile.selectedLayer.blurMask},set value(A){z(e,a(e).selectedFile.selectedLayer.blurMask=A)},filter:A=>!A.Contains(a(e).selectedFile),get oninput(){return a(B)},$$legacy:!0});var ae=G(y,6),W=he(()=>u());nt(ae,{get value(){return a(e).selectedFile.selectedLayer.invert},set value(A){z(e,a(e).selectedFile.selectedLayer.invert=A)},get oninput(){return a(W)},children:(A,O)=>{var oe=ke("Invert");$(A,oe)},$$slots:{default:!0},$$legacy:!0});var ue=G(ae,4),Y=he(()=>u());nt(ue,{get value(){return a(e).selectedFile.selectedLayer.enableGradientMap},set value(A){z(e,a(e).selectedFile.selectedLayer.enableGradientMap=A)},get oninput(){return a(Y)},children:(A,O)=>{var oe=ke("Enable gradient map");$(A,oe)},$$slots:{default:!0},$$legacy:!0});var se=G(ue,2);_e(se,()=>a(e).selectedFile.selectedLayer.enableGradientMap,A=>{var O=he(()=>u());Ht(A,{get value(){return a(e).selectedFile.selectedLayer.gradientMapColors},set value(oe){z(e,a(e).selectedFile.selectedLayer.gradientMapColors=oe)},get oninput(){return a(O)},$$legacy:!0})}),$(N,X)}),$(L,I)}},{title:"Color Correction",icon:"fa-solid fa-palette",element:L=>{var I=Se(),R=ce(I);Ke(R,()=>a(e).historyIndex,N=>{var X=md(),S=G(ce(X),2),P=he(()=>u());Oe(S,{get value(){return a(e).selectedFile.selectedLayer.contrast},set value(oe){z(e,a(e).selectedFile.selectedLayer.contrast=oe)},min:0,max:10,step:.01,reset:g,get oninput(){return a(P)},$$legacy:!0});var y=G(S,4),B=he(()=>u());Oe(y,{get value(){return a(e).selectedFile.selectedLayer.brightness},set value(oe){z(e,a(e).selectedFile.selectedLayer.brightness=oe)},min:-1,max:1,step:.01,reset:p,get oninput(){return a(B)},$$legacy:!0});var ae=G(y,6),W=he(()=>a(e).selectedFile.selectedLayer.colorize?1:5),ue=he(()=>u());Oe(ae,{get value(){return a(e).selectedFile.selectedLayer.saturation},set value(oe){z(e,a(e).selectedFile.selectedLayer.saturation=oe)},min:0,get max(){return a(W)},step:.01,reset:c,get oninput(){return a(ue)},$$legacy:!0});var Y=G(ae,4),se=he(()=>u());Oe(Y,{get value(){return a(e).selectedFile.selectedLayer.hue},set value(oe){z(e,a(e).selectedFile.selectedLayer.hue=oe)},min:0,max:1,step:.001,reset:h,get oninput(){return a(se)},$$legacy:!0});var A=G(Y,4),O=he(()=>u());nt(A,{get value(){return a(e).selectedFile.selectedLayer.colorize},set value(oe){z(e,a(e).selectedFile.selectedLayer.colorize=oe)},get oninput(){return a(O)},children:(oe,K)=>{var Z=ke("Colorize");$(oe,Z)},$$slots:{default:!0},$$legacy:!0}),$(N,X)}),$(L,I)}}]})}),$(r,_),Te()}var _d=ie("<label>Name</label> <!>",1);function bd(r,t){Ae(t,!1);const e=Je(Ne.GetSingleton());Ze();var n=Se(),i=ce(n);_e(i,()=>a(e).selectedFile&&a(e).selectedFile instanceof De,s=>{var o=_d(),d=G(ce(o),2);Ps(d,{get value(){return a(e).selectedFile.name},set value(c){z(e,a(e).selectedFile.name=c)},$$legacy:!0}),$(s,o)}),$(r,n),Te()}var yd=(r,t,e)=>t.PickColor(e(),n=>e(n)),wd=ie('<div class="button-container"><button class="button full color-icon-container svelte-1qbpcv1"><div class="color-icon svelte-1qbpcv1"></div> </button></div>');function xd(r,t){Ae(t,!0);let e=Ee(t,"value",15);const n=Rt.GetSingleton();var i=wd(),s=re(i);s.__click=[yd,n,e];var o=re(s);const d=ye(()=>zt(...e())??""),c=ye(()=>(e()[3]/255*100).toFixed(2)??"");var h=G(o);be(()=>Ge(h,`#${a(d)} ${a(c)}`)),be(()=>$e(o,"style",`background-color: rgba(${e()[0]??""},${e()[1]??""},${e()[2]??""},${e()[3]/255});`)),$(r,i),Te()}He(["click"]);var kd=ie("<label>Color</label> <!> <label>Scale</label> <!> <label>Disturbance</label> <!> <label>Contrast</label> <!>",1),Sd=ie("<label>Color</label> <!> <label>Scale</label> <!> <label>Time</label> <!> <label>Octaves</label> <!> <label>Persistence</label> <!>",1),Cd=ie("<label>Color</label> <!>",1),Ed=ie("<label>Gradient</label> <!> <label>X</label> <!> <label>Y</label> <!> <label>Angle</label> <!> <label>Radious</label> <!> <!> <!> <!> <!> <!> <!>",1),Fd=ie("<label>Gradient</label> <!> <label>X</label> <!> <label>Y</label> <!> <label>Radious</label> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Ad=ie("<label>Gradient</label> <!>",1),Td=ie("<label>Name</label> <!> <label>Color</label> <label>Fill Type</label> <!> <!>",1);function Rd(r,t){Ae(t,!1);const e=Je(Ne.GetSingleton());function n(M){return()=>{a(e).updateScreen()}}const i=[new De("Basic"),{name:"Color",value:"color"},new De("Gradient"),{name:"Linear Gradient",value:"linearGradient"},{name:"Radial Gradient",value:"radialGradient"},new De("Noise"),{name:"Perlin Noise",value:"perlinNoise"},{name:"Voronoi Noise",value:"voronoiNoise"},{name:"Grain Noise",value:"grainNoise"}];function s(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.angle=-90),z(e,a(e).selectedFile.radios=1)}function o(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.angle=0),z(e,a(e).selectedFile.radios=1)}function d(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.angle=45),z(e,a(e).selectedFile.radios=1)}function c(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.angle=135),z(e,a(e).selectedFile.radios=1)}function h(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.angle=-135)}function g(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.angle=-45)}function p(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.radios=1)}function u(){z(e,a(e).selectedFile.x1=0),z(e,a(e).selectedFile.y1=0),z(e,a(e).selectedFile.radios=1)}function l(){z(e,a(e).selectedFile.x1=1),z(e,a(e).selectedFile.y1=0),z(e,a(e).selectedFile.radios=1)}function _(){z(e,a(e).selectedFile.x1=1),z(e,a(e).selectedFile.y1=1),z(e,a(e).selectedFile.radios=1)}function v(){z(e,a(e).selectedFile.x1=0),z(e,a(e).selectedFile.y1=1),z(e,a(e).selectedFile.radios=1)}function f(){z(e,a(e).selectedFile.x1=0),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.radios=1)}function b(){z(e,a(e).selectedFile.x1=1),z(e,a(e).selectedFile.y1=.5),z(e,a(e).selectedFile.radios=1)}function w(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=0),z(e,a(e).selectedFile.radios=1)}function x(){z(e,a(e).selectedFile.x1=.5),z(e,a(e).selectedFile.y1=1),z(e,a(e).selectedFile.radios=1)}Ze();var k=Se(),E=ce(k);_e(E,()=>a(e).selectedFile&&a(e).selectedFile instanceof Ue,M=>{var L=Td(),I=G(ce(L),2);Ps(I,{get value(){return a(e).selectedFile.name},set value(X){z(e,a(e).selectedFile.name=X)},$$legacy:!0});var R=G(I,6);qa(R,{options:i,get value(){return a(e).selectedFile.fillType},set value(X){z(e,a(e).selectedFile.fillType=X)},$$legacy:!0});var N=G(R,2);_e(N,()=>a(e).selectedFile.fillType.value=="voronoiNoise",X=>{var S=kd(),P=G(ce(S),2);Ht(P,{get value(){return a(e).selectedFile.gradient},set value(se){z(e,a(e).selectedFile.gradient=se)},$$legacy:!0});var y=G(P,4),B=he(()=>n());Oe(y,{get value(){return a(e).selectedFile.scale},set value(se){z(e,a(e).selectedFile.scale=se)},min:1,max:100,step:.01,reset:()=>z(e,a(e).selectedFile.scale=10),get oninput(){return a(B)},$$legacy:!0});var ae=G(y,4),W=he(()=>n());Oe(ae,{get value(){return a(e).selectedFile.disturbance},set value(se){z(e,a(e).selectedFile.disturbance=se)},min:0,max:1,step:.001,reset:()=>z(e,a(e).selectedFile.disturbance=.8),get oninput(){return a(W)},$$legacy:!0});var ue=G(ae,4),Y=he(()=>n());Oe(ue,{get value(){return a(e).selectedFile.contrast},set value(se){z(e,a(e).selectedFile.contrast=se)},min:1,max:2,step:.001,reset:()=>z(e,a(e).selectedFile.contrast=1.2),get oninput(){return a(Y)},$$legacy:!0}),$(X,S)},X=>{var S=Se(),P=ce(S);_e(P,()=>a(e).selectedFile.fillType.value=="perlinNoise",y=>{var B=Sd(),ae=G(ce(B),2);Ht(ae,{get value(){return a(e).selectedFile.gradient},set value(Z){z(e,a(e).selectedFile.gradient=Z)},$$legacy:!0});var W=G(ae,4),ue=he(()=>n());Oe(W,{get value(){return a(e).selectedFile.scale},set value(Z){z(e,a(e).selectedFile.scale=Z)},min:1,max:100,step:.01,reset:()=>z(e,a(e).selectedFile.scale=10),get oninput(){return a(ue)},$$legacy:!0});var Y=G(W,4),se=he(()=>n());Oe(Y,{get value(){return a(e).selectedFile.time},set value(Z){z(e,a(e).selectedFile.time=Z)},min:0,max:1,step:.001,reset:()=>z(e,a(e).selectedFile.time=0),get oninput(){return a(se)},$$legacy:!0});var A=G(Y,4),O=he(()=>n());Oe(A,{get value(){return a(e).selectedFile.octaves},set value(Z){z(e,a(e).selectedFile.octaves=Z)},min:1,max:100,step:1,reset:()=>z(e,a(e).selectedFile.octaves=6),get oninput(){return a(O)},$$legacy:!0});var oe=G(A,4),K=he(()=>n());Oe(oe,{get value(){return a(e).selectedFile.persistence},set value(Z){z(e,a(e).selectedFile.persistence=Z)},min:0,max:1,step:.01,reset:()=>z(e,a(e).selectedFile.persistence=.5),get oninput(){return a(K)},$$legacy:!0}),$(y,B)},y=>{var B=Se(),ae=ce(B);_e(ae,()=>a(e).selectedFile.fillType.value=="color",W=>{var ue=Cd(),Y=G(ce(ue),2);xd(Y,{get value(){return a(e).selectedFile.color},set value(se){z(e,a(e).selectedFile.color=se)},$$legacy:!0}),$(W,ue)},W=>{var ue=Se(),Y=ce(ue);_e(Y,()=>a(e).selectedFile.fillType.value=="linearGradient",se=>{var A=Ed(),O=G(ce(A),2);Ht(O,{get value(){return a(e).selectedFile.gradient},set value(F){z(e,a(e).selectedFile.gradient=F)},$$legacy:!0});var oe=G(O,4),K=he(()=>n());Oe(oe,{get value(){return a(e).selectedFile.x1},set value(F){z(e,a(e).selectedFile.x1=F)},min:-5,max:5,step:.01,reset:()=>z(e,a(e).selectedFile.x1=.5),get oninput(){return a(K)},$$legacy:!0});var Z=G(oe,4),we=he(()=>n());Oe(Z,{get value(){return a(e).selectedFile.y1},set value(F){z(e,a(e).selectedFile.y1=F)},min:-5,max:5,step:.01,reset:()=>z(e,a(e).selectedFile.y1=.5),get oninput(){return a(we)},$$legacy:!0});var fe=G(Z,4),pe=he(()=>n());Oe(fe,{get value(){return a(e).selectedFile.angle},set value(F){z(e,a(e).selectedFile.angle=F)},min:0,max:360,step:1,reset:()=>z(e,a(e).selectedFile.angle=-90),get oninput(){return a(pe)},$$legacy:!0});var ve=G(fe,4),Re=he(()=>n());Oe(ve,{get value(){return a(e).selectedFile.radios},set value(F){z(e,a(e).selectedFile.radios=F)},min:.001,max:10,step:.01,reset:()=>z(e,a(e).selectedFile.radios=1),get oninput(){return a(Re)},$$legacy:!0});var Fe=G(ve,2);Ve(Fe,{action:o,children:(F,C)=>{var D=ke("Horizontal");$(F,D)},$$slots:{default:!0}});var Xe=G(Fe,2);Ve(Xe,{action:s,children:(F,C)=>{var D=ke("Vertical");$(F,D)},$$slots:{default:!0}});var Me=G(Xe,2);Ve(Me,{action:d,children:(F,C)=>{var D=ke("Top Left");$(F,D)},$$slots:{default:!0}});var m=G(Me,2);Ve(m,{action:c,children:(F,C)=>{var D=ke("Top Right");$(F,D)},$$slots:{default:!0}});var J=G(m,2);Ve(J,{action:h,children:(F,C)=>{var D=ke("Bottom Right");$(F,D)},$$slots:{default:!0}});var j=G(J,2);Ve(j,{action:g,children:(F,C)=>{var D=ke("Bottom Left");$(F,D)},$$slots:{default:!0}}),$(se,A)},se=>{var A=Se(),O=ce(A);_e(O,()=>a(e).selectedFile.fillType.value=="radialGradient",oe=>{var K=Fd(),Z=G(ce(K),2);Ht(Z,{get value(){return a(e).selectedFile.gradient},set value(q){z(e,a(e).selectedFile.gradient=q)},$$legacy:!0});var we=G(Z,4),fe=he(()=>n());Oe(we,{get value(){return a(e).selectedFile.x1},set value(q){z(e,a(e).selectedFile.x1=q)},min:-5,max:5,step:.01,reset:()=>z(e,a(e).selectedFile.x1=.5),get oninput(){return a(fe)},$$legacy:!0});var pe=G(we,4),ve=he(()=>n());Oe(pe,{get value(){return a(e).selectedFile.y1},set value(q){z(e,a(e).selectedFile.y1=q)},min:-5,max:5,step:.01,reset:()=>z(e,a(e).selectedFile.y1=.5),get oninput(){return a(ve)},$$legacy:!0});var Re=G(pe,4),Fe=he(()=>n());Oe(Re,{get value(){return a(e).selectedFile.radios},set value(q){z(e,a(e).selectedFile.radios=q)},min:.001,max:10,step:.01,reset:()=>z(e,a(e).selectedFile.radios=1),get oninput(){return a(Fe)},$$legacy:!0});var Xe=G(Re,2);Ve(Xe,{action:p,children:(q,U)=>{var ne=ke("Center");$(q,ne)},$$slots:{default:!0}});var Me=G(Xe,2);Ve(Me,{action:u,children:(q,U)=>{var ne=ke("Top Left");$(q,ne)},$$slots:{default:!0}});var m=G(Me,2);Ve(m,{action:l,children:(q,U)=>{var ne=ke("Top Right");$(q,ne)},$$slots:{default:!0}});var J=G(m,2);Ve(J,{action:_,children:(q,U)=>{var ne=ke("Bottom Right");$(q,ne)},$$slots:{default:!0}});var j=G(J,2);Ve(j,{action:v,children:(q,U)=>{var ne=ke("Bottom Left");$(q,ne)},$$slots:{default:!0}});var F=G(j,2);Ve(F,{action:f,children:(q,U)=>{var ne=ke("Center Left");$(q,ne)},$$slots:{default:!0}});var C=G(F,2);Ve(C,{action:b,children:(q,U)=>{var ne=ke("Center Right");$(q,ne)},$$slots:{default:!0}});var D=G(C,2);Ve(D,{action:w,children:(q,U)=>{var ne=ke("Center Top");$(q,ne)},$$slots:{default:!0}});var te=G(D,2);Ve(te,{action:x,children:(q,U)=>{var ne=ke("Center Bottom");$(q,ne)},$$slots:{default:!0}}),$(oe,K)},oe=>{var K=Se(),Z=ce(K);_e(Z,()=>a(e).selectedFile.fillType.value=="grainNoise",we=>{var fe=Ad(),pe=G(ce(fe),2);Ht(pe,{get value(){return a(e).selectedFile.gradient},set value(ve){z(e,a(e).selectedFile.gradient=ve)},$$legacy:!0}),$(we,fe)},null,!0),$(oe,K)},!0),$(se,A)},!0),$(W,ue)},!0),$(y,B)},!0),$(X,S)}),$(M,L)}),$(r,k),Te()}function Id(r,t){Ae(t,!1);const e=c=>{gd(c,{})},n=c=>{nd(c,{})},i=c=>{bd(c,{})},s=c=>{Rd(c,{})},o=Ne.GetSingleton();Ze();var d=he(()=>{var c;return[{title:"Composition Properties",icon:"fa-solid fa-cubes",enabled:o.selectedFile!=null&&o.selectedFile instanceof Le,defaultOpen:!0,element:n},{title:"Layer Properties",icon:"fa-solid fa-layer-group",enabled:((c=o.selectedFile)==null?void 0:c.selectedLayer)!=null,defaultOpen:!0,element:e},{title:"Folder Properties",icon:"fa-solid fa-folder",enabled:o.selectedFile!=null&&o.selectedFile instanceof De,defaultOpen:!0,element:i},{title:"Pattern Properties",icon:"fa-solid fa-droplet",enabled:o.selectedFile!=null&&o.selectedFile instanceof Ue,defaultOpen:!0,element:s}]});qi(r,{get tabs(){return a(d)}}),Te()}var Dd=ie('<img class="thumb h-margin" alt="thumb">'),Pd=ie('<i class="fa-solid fa-layer-group h-margin" style="font-size: 3em;"></i>'),Ld=ie('<div class="color-option svelte-14j6rbj"></div>'),$d=ie('<div class="row"><div class="center flex1"><!> <!> <!></div></div>'),Od=(r,t,e)=>{t().visible=!t().visible,e.updateScreen()},Gd=ie('<i class="fa-solid fa-eye icon"></i>'),Md=ie('<i class="fa-solid fa-eye-slash icon"></i>'),Ud=(r,t,e)=>{t.selectedFile.CopyLayer(e())},zd=(r,t,e)=>t(e()),Bd=ie('<button class="button"><!></button> <button class="button" style="margin-left: auto;"><i class="fa-solid fa-copy icon"></i></button> <button class="button" style="margin-left: auto;"><i class="fa-solid fa-trash icon"></i></button>',1),Nd=ie('<div class="flex-1 column"><!></div>'),jd=ie('<div class="column flex-1"><!></div>');function Hd(r,t){Ae(t,!1);const e=Ne.GetSingleton(),n=Je(new Pt),i=kt.GetSingleton();function s(p){return p.menuSource=="file"}function o(p,u){if(u.menuSource=="file"){if(u.item.Contains(e.selectedFile))return;e.selectedFile.AddLayer(p,u.item),e.updateScreen()}}function d(p){e.updateScreen()}function c(p){i.Prompt("Are you sure you want to delete this layer?",()=>{const u=e.selectedFile,l=u.getSelectedLayerIndex()==p;a(n).removeLayer(p),l&&(u.layers.length==0?u.selectedLayer=null:u.selectedLayer=u.layers[0]),e.updateScreen()})}z(n,a(n).allowDropEvent=s),z(n,a(n).dropEvent=o),z(n,a(n).reorderEvent=d),z(n,a(n).selectEvent=p=>{}),Ze();var h=jd(),g=re(h);Ke(g,()=>e.selectedFile,p=>{var u=Se(),l=ce(u);_e(l,()=>e.selectedFile instanceof Le,_=>{var v=Nd();{const b=(x,k=Be,E=Be)=>{var M=$d(),L=re(M),I=re(L);_e(I,()=>k().thumbnail,S=>{var P=Dd();be(()=>$e(P,"src",k().thumbnail)),$(S,P)},S=>{var P=Pd();$(S,P)});var R=G(I),N=G(R);_e(N,()=>k().maskGroup,S=>{var P=Ld();const y=he(()=>`background-color: #${zt(...k().maskGroup)??""};`);be(()=>$e(P,"style",a(y))),$(S,P)});var X=G(N,2);_e(X,()=>k().file instanceof Le,S=>{var P=Se(),y=ce(P);_e(y,()=>k().name!=k().file.name,B=>{var ae=ke();be(()=>Ge(ae,`(${k().file.name??""})`)),$(B,ae)}),$(S,P)}),be(()=>Ge(R,` ${k().name??""} `)),$(x,M)},w=(x,k=Be,E=Be)=>{var M=Bd(),L=ce(M);L.__click=[Od,k,e];var I=re(L);_e(I,()=>k().visible,X=>{var S=Gd();$(X,S)},X=>{var S=Md();$(X,S)});var R=G(L,2);R.__click=[Ud,e,E];var N=G(R,2);N.__click=[zd,c,E],$(x,M)};var f=re(v);Ke(f,()=>e.selectedFile.layers,x=>{var k=he(()=>new Hi(e.selectedFile,"layers","selectedLayer","layer","vertical-list"));Wi(x,{get list(){return a(k)},get io(){return a(n)},rendering:new ji(b,w)})})}$(_,v)}),$(p,u)}),$(r,h),Te()}He(["click"]);function Xd(r,t){Ae(t,!1);const e=o=>{xu(o,{})},n=o=>{Hd(o,{})},i=Ne.GetSingleton();Ze();var s=he(()=>[{title:"File",icon:"fa-solid fa-file",defaultOpen:!0,element:e},{title:"Layer",icon:"fa-solid fa-layer-group",enabled:i.selectedFile!=null&&i.selectedFile instanceof Le,defaultOpen:!0,element:n}]);qi(r,{get tabs(){return a(s)}}),Te()}He(["click"]);var Wd=ie('<img class="thumb h-margin" alt="thumb">'),Vd=ie('<i class="fa-solid fa-layer-group h-margin" style="font-size: 3em;"></i>'),qd=ie('<div class="color-option svelte-14j6rbj"></div>'),Zd=ie('<div class="row"><div class="center flex1"><!> <!> <!></div></div>'),Yd=(r,t)=>{t().enabled=!t().enabled},Kd=ie('<i class="fa-solid fa-check icon"></i>'),Jd=ie('<i class="fa-solid fa-xmark icon"></i>'),Qd=(r,t,e,n)=>t.Prompt("Are you sure you want to remove this output",()=>e.RemoveOutput(n())),eh=(r,t,e)=>t.Prompt("Are you sure you want to reset this output",()=>e().Load()),th=(r,t)=>t().UpdatePreview(),rh=ie('<button class="button"><i class="fa-solid fa-pen-to-square icon"></i></button> <button class="button"><!></button> <button class="button"><i class="fa-solid fa-copy icon"></i></button> <button class="button"><i class="fa-solid fa-trash icon"></i></button> <button class="button"><i class="fa-solid fa-broom icon"></i></button> <button class="button"><i class="fa-solid fa-arrows-rotate icon"></i></button>',1),nh=ie('<div class="flex-1 column"><!></div>'),ih=ie('<div class="column flex-1"><!></div>');function sh(r,t){Ae(t,!1);const e=Ne.GetSingleton(),n=Je(new Pt),i=kt.GetSingleton();function s(p){return p.menuSource=="file"}function o(p,u){if(u.menuSource=="file"){if(u.item.Contains(e.selectedFile))return;e.selectedFile.AddLayer(p,u.item),e.updateScreen()}}function d(p){e.updateScreen()}z(n,a(n).allowDropEvent=s),z(n,a(n).dropEvent=o),z(n,a(n).reorderEvent=d),z(n,a(n).selectEvent=p=>{});const c=It.GetSingleton();Ze();var h=ih(),g=re(h);Ke(g,()=>c.outputs,p=>{var u=nh();{const _=(f,b=Be,w=Be)=>{var x=Zd(),k=re(x),E=re(k);_e(E,()=>b().thumbnail,R=>{var N=Wd();be(()=>$e(N,"src",b().thumbnail)),$(R,N)},R=>{var N=Vd();$(R,N)});var M=G(E),L=G(M);_e(L,()=>b().maskGroup,R=>{var N=qd();const X=he(()=>`background-color: #${zt(...b().maskGroup)??""};`);be(()=>$e(N,"style",a(X))),$(R,N)});var I=G(L,2);_e(I,()=>b().file instanceof Le,R=>{var N=Se(),X=ce(N);_e(X,()=>b().name!=b().file.name,S=>{var P=ke();be(()=>Ge(P,`(${b().file.name??""})`)),$(S,P)}),$(R,N)}),be(()=>Ge(M,` ${b().name??""} `)),$(f,x)},v=(f,b=Be,w=Be)=>{var x=rh(),k=ce(x),E=ye(()=>c.OpenContentModalEvent(b()));k.__click=function(...P){var y;(y=a(E))==null||y.apply(this,P)};var M=G(k,2);M.__click=[Yd,b];var L=re(M);_e(L,()=>b().enabled,P=>{var y=Kd();$(P,y)},P=>{var y=Jd();$(P,y)});var I=G(M,2),R=ye(()=>c.CopyEvent(b()));I.__click=function(...P){var y;(y=a(R))==null||y.apply(this,P)};var N=G(I,2);N.__click=[Qd,i,c,b];var X=G(N,2);X.__click=[eh,i,b];var S=G(X,2);S.__click=[th,b],$(f,x)};var l=re(u);Ke(l,()=>c.outputs,f=>{Wi(f,{list:new Hi(c,"outputs","selectedOutput","layer","vertical-list"),get io(){return a(n)},rendering:new ji(_,v)})})}$(p,u)}),$(r,h),Te()}He(["click"]);var ah=(r,t,e)=>t.Prompt("Are you sure you want to remove this output",()=>a(e).RemoveOutput(a(e).selectedOutput)),oh=ie('<i class="fa-solid fa-broom"></i> Clean and Update',1),lh=ie('<img class="h-margin preview svelte-1mc7qce" alt="thumb">'),uh=ie('<div class="item svelte-1mc7qce"><!></div>'),ch=ie('<div class="item svelte-1mc7qce"><button class="button full color-icon-container svelte-1mc7qce"><div class="color-icon svelte-1mc7qce"></div> </button></div>'),dh=ie('<div style="height: 100%; overflow-y:auto;"><div class="row"><div class="col w100" style="margin:10px"><div class="column margin-bottom-60"><label>Name</label> <label>Base Composition</label> <div class="full-width-margin svelte-1mc7qce"><!></div></div> <!> <button class="button full"><i class="fa-solid fa-copy"></i> Duplicate</button> <button class="button full"><i class="fa-solid fa-trash"></i> Remove</button> <!></div> <!></div> <label>Files</label> <div class="items-container svelte-1mc7qce"></div> <label>Colors</label> <div class="items-container svelte-1mc7qce"></div></div>'),hh=(r,t)=>t.uploadMedias(),fh=(r,t)=>a(t).Download(),vh=ie('<div style="display: flex;flex-direction:row;flex-wrap:wrap;"><!></div>'),ph=ie('<div class="row"><button class="button full"><i class="fa-solid fa-plus"></i> Add Output</button> <button class="button full"><i class="fa-solid fa-upload"></i> Upload Medias</button> <button class="button full"><i class="fa-solid fa-arrows-rotate"></i> Update All Previews</button> <button class="button full"><i class="fa-solid fa-camera"></i> Render</button></div> <div style="height: 100%; overflow-y:auto;"><!></div>',1),mh=ie("<!> <!>",1);function gh(r,t){Ae(t,!1);const e=Je(It.GetSingleton());Ne.GetSingleton();const n=kt.GetSingleton(),i=Pt.GetFileListSingleton();Ze();var s=mh(),o=ce(s);et(ur(o,{width:1400,height:800,children:(c,h)=>{var g=Se(),p=ce(g);_e(p,()=>a(e).selectedOutput,u=>{var l=dh(),_=re(l),v=re(_),f=re(v),b=G(re(f),4),w=re(b);Ft(w,{filter:X=>X instanceof Le,get value(){return a(e).selectedOutput.base},set value(X){z(e,a(e).selectedOutput.base=X)},oninput:()=>{var X;z(e,a(e).selectedOutput.name=(X=a(e).selectedOutput.base)==null?void 0:X.name),a(e).selectedOutput.Load()},$$legacy:!0});var x=G(f,2);nt(x,{get value(){return a(e).selectedOutput.enabled},set value(X){z(e,a(e).selectedOutput.enabled=X)},children:(X,S)=>{var P=ke("Enabled");$(X,P)},$$slots:{default:!0},$$legacy:!0});var k=G(x,2),E=ye(()=>a(e).CopyEvent(a(e).selectedOutput));k.__click=function(...X){var S;(S=a(E))==null||S.apply(this,X)};var M=G(k,2);M.__click=[ah,n,e];var L=G(M,2);Ve(L,{action:()=>n.Prompt("Are you sure you want to reset this output",()=>a(e).selectedOutput.Load()),children:(X,S)=>{var P=oh();$(X,P)},$$slots:{default:!0}});var I=G(v,2);_e(I,()=>a(e).selectedOutput.preview,X=>{var S=lh();be(()=>$e(S,"src",a(e).selectedOutput.preview)),$(X,S)});var R=G(_,4);gt(R,5,()=>a(e).selectedOutput.files,vs,(X,S)=>{var P=uh(),y=re(P);Ft(y,{filter:B=>!B.Contains(a(e).selectedOutput.base),get value(){return a(S).file},set value(B){a(S).file=B,Ua(()=>a(e).selectedOutput.files)},oninput:()=>a(e).selectedOutput.UpdatePreview(),$$legacy:!0}),$(X,P)});var N=G(R,4);gt(N,5,()=>a(e).selectedOutput.colors,vs,(X,S)=>{var P=ch(),y=re(P),B=ye(()=>a(e).PickColorEvent(a(e).selectedOutput,a(S)));y.__click=function(...se){var A;(A=a(B))==null||A.apply(this,se)};var ae=re(y);const W=he(()=>zt(...a(S).color)??""),ue=he(()=>(a(S).color[3]/255*100).toFixed(2)??"");var Y=G(ae);be(()=>Ge(Y,`${a(W)} ${a(ue)}`)),be(()=>$e(ae,"style",`background-color: rgba(${a(S).color[0]??""},${a(S).color[1]??""},${a(S).color[2]??""},${a(S).color[3]/255});`)),$(X,P)}),$(u,l)}),$(c,g)},$$slots:{default:!0},$$legacy:!0}),c=>z(e,a(e).contentModal=c),()=>{var c;return(c=a(e))==null?void 0:c.contentModal});var d=G(o,2);et(ur(d,{title:"Rendering",width:800,height:600,children:(c,h)=>{var g=ph(),p=ce(g),u=re(p),l=ye(()=>a(e).AddOutputEvent());u.__click=function(...k){var E;(E=a(l))==null||E.apply(this,k)};var _=G(u,2);_.__click=[hh,i];var v=G(_,2),f=ye(()=>a(e).UpdateAllPreviewEvent());v.__click=function(...k){var E;(E=a(f))==null||E.apply(this,k)};var b=G(v,2);b.__click=[fh,e];var w=G(p,2),x=re(w);Ke(x,()=>a(e).outputs,k=>{var E=vh(),M=re(E);sh(M,{}),$(k,E)}),$(c,g)},$$slots:{default:!0},$$legacy:!0}),c=>z(e,a(e).modal=c),()=>{var c;return(c=a(e))==null?void 0:c.modal}),$(r,s),Te()}He(["click"]);var _h=ie('<div class="top svelte-mbh65w"> </div> <div class="bottom svelte-mbh65w"><button class="button svelte-mbh65w">No</button> <button class="button svelte-mbh65w">Yes</button></div>',1);function bh(r,t){Ae(t,!1);const e=Je(kt.GetSingleton());Ze(),et(ur(r,{width:600,height:150,children:(n,i)=>{var s=_h(),o=ce(s),d=re(o),c=G(o,2),h=re(c),g=ye(()=>a(e).CancelEvent());h.__click=function(...l){var _;(_=a(g))==null||_.apply(this,l)};var p=G(h,2),u=ye(()=>a(e).ConfirmEvent());p.__click=function(...l){var _;(_=a(u))==null||_.apply(this,l)},be(()=>Ge(d,a(e).message)),$(n,s)},$$slots:{default:!0},$$legacy:!0}),n=>z(e,a(e).modal=n),()=>{var n;return(n=a(e))==null?void 0:n.modal}),Te()}He(["click"]);var yh=ie('<div class="top svelte-mbh65w"> </div> <div style="margin-top: 30px;"><!></div> <div class="bottom svelte-mbh65w"><button class="button svelte-mbh65w">Cancel</button> <button class="button svelte-mbh65w">Save</button></div>',1);function wh(r,t){Ae(t,!1);const e=Je(lr.GetSingleton());Ze(),et(ur(r,{width:600,height:200,children:(n,i)=>{var s=yh(),o=ce(s),d=re(o),c=G(o,2),h=re(c);Ps(h,{get value(){return a(e).fileName},set value(v){z(e,a(e).fileName=v)},$$legacy:!0});var g=G(c,2),p=re(g),u=ye(()=>a(e).CancelEvent());p.__click=function(...v){var f;(f=a(u))==null||f.apply(this,v)};var l=G(p,2),_=ye(()=>a(e).ConfirmEvent());l.__click=function(...v){var f;(f=a(_))==null||f.apply(this,v)},be(()=>Ge(d,a(e).message)),$(n,s)},$$slots:{default:!0},$$legacy:!0}),n=>z(e,a(e).modal=n),()=>{var n;return(n=a(e))==null?void 0:n.modal}),Te()}He(["click"]);var xh=ie('<li class="separator svelte-1e9qgjh"> </li>'),kh=ie('<li class="option svelte-1e9qgjh"> </li>'),Sh=ie('<div class="context-menu svelte-1e9qgjh"><ul class="svelte-1e9qgjh"></ul></div>');function Ch(r,t){Ae(t,!1);const e=Je(Ri.GetSingleton());Ze();var n=Sh(),i=re(n);gt(i,5,()=>a(e).options,s=>s,(s,o)=>{var d=Se(),c=ce(d);_e(c,()=>a(o)instanceof De,h=>{var g=xh(),p=re(g);be(()=>Ge(p,a(o).name)),$(h,g)},h=>{var g=kh(),p=ye(()=>a(e).PickEvent(a(o)));g.__click=function(...l){var _;(_=a(p))==null||_.apply(this,l)};var u=re(g);be(()=>Ge(u,a(o))),$(h,g)}),$(s,d)}),et(n,s=>z(e,a(e).element=s),()=>{var s;return(s=a(e))==null?void 0:s.element}),$(r,n),Te()}He(["click"]);var Eh=ie('<div class="grid-container svelte-1mbfrwv"><div class="header svelte-1mbfrwv"><div class="grid-item center svelte-1mbfrwv"><!></div></div> <div class="tab svelte-1mbfrwv"><div class="grid-item svelte-1mbfrwv" style="overflow: hidden;"><!></div></div> <div class="main svelte-1mbfrwv"><div class="grid-item checker-big svelte-1mbfrwv"><!></div></div> <div class="right svelte-1mbfrwv"><div class="grid-item svelte-1mbfrwv"><!></div></div> <div class="left svelte-1mbfrwv"><div class="grid-item column svelte-1mbfrwv"><!></div></div></div> <!> <!> <!> <!> <!>',1);function Fh(r,t){Ae(t,!1),Bi(async()=>{let I=document.querySelector(".grid-container");function R(){vl(I)}R(),window.addEventListener("resize",R),Zl(I,{thickness:"15px",minWidth:30,minHeight:30,fixedAreas:["header","tab"]})}),Ze();var e=Eh(),n=ce(e),i=re(n),s=re(i),o=re(s);Cc(o,{});var d=G(i,2),c=re(d),h=re(c);nc(h,{});var g=G(d,2),p=re(g),u=re(p);Ku(u,{});var l=G(g,2),_=re(l),v=re(_);Xd(v,{});var f=G(l,2),b=re(f),w=re(b);Id(w,{});var x=G(n,2);hc(x,{});var k=G(x,2);gh(k,{});var E=G(k,2);bh(E,{});var M=G(E,2);wh(M,{});var L=G(M,2);Ch(L,{}),$(r,e),Te()}nl(Fh,{target:document.getElementById("app")});
